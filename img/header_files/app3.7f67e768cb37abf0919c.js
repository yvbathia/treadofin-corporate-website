/*! Copyright (c) 2019 WhatsApp Inc. All Rights Reserved. */
webpackJsonp([128],{bbjjjbicfb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return"#"+(parseInt(e,10)>>>0).toString(16).slice(-6)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)};t.intColorToHex=s;var l=i("dcaifjegcg"),f=n(l),d=i("bhggeigghg"),h=n(d),p=i("ddcfhecgai"),g=n(p),y=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,l.prop)(),n.name=(0,l.prop)(),n.color=(0,l.prop)(),n.count=(0,l.prop)(),n.stale=(0,l.session)(!0),n.hexColor=(0,l.derived)(n._hexColor,["color"]),a=i,o(n,a)}return a(t,e),u(t,[{key:"initialize",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.labeltemColleciton=new g.default,this.triggerLabelUpdate(),this.listenTo(this,"change:name",this.triggerLabelUpdate),this.listenTo(this,"change:color",this.triggerLabelUpdate),this.listenTo(this,"change:count",this.triggerLabelUpdate)}},{key:"_hexColor",value:function(){if(this.color)return s(this.color)}},{key:"_find",value:function(e){return Promise.resolve({id:e})}},{key:"triggerLabelUpdate",value:function(){this.name&&h.default.Label.trigger("label_updated_"+this.id)}}]),t}(f.default);y.Collection="Label",y.Proxy="label",t.default=(0,l.defineModel)(y)},bdfbccfifg:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CACHE_POLICY_TYPE=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i("cccehdaiaf"),u=function(e){return e&&e.__esModule?e:{default:e}}(s),c=t.CACHE_POLICY_TYPE={LOAD:"LOAD",IMMEDIATE:"IMMEDIATE",NONE:"NONE"},l=function(e){function t(e,i){n(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._collection=e,o._id=i,o}return o(t,e),a(t,[{key:"enableCaching",value:function(){}},{key:"disableCaching",value:function(){}},{key:"collection",get:function(){return this._collection}},{key:"id",get:function(){return this._id}}]),t}(u.default);l.policy=c.NONE,t.default=l},bdhgicebce:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantCollection=t.MsgInfoParticipant=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("dhigahgdjb"),d=n(f),h=i("ccicaaeiaa"),p=n(h),g=i("fcedgihic"),y=n(g),v=i("ccgjijjbbj"),b=n(v),_=i("jccfhaecf"),m=n(_),O=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,c.prop)(),n.t=(0,c.prop)(),n.contact=(0,c.session)(),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.addChild("contact",d.default.gadd(this.id))}}]),t}(l.default);O.Collection="MsgInfoParticipant",O.Proxy="msgInfoParticipant",O.idClass=m.default;var E=t.MsgInfoParticipant=(0,c.defineModel)(O),P=t.ParticipantCollection=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(y.default);P.model=E,P.comparator=function(e,t){return(0,p.default)(e.contact,t.contact)};var T=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,c.prop)(),n.isPTT=(0,c.prop)(),n.playedRemaining=(0,c.prop)(0),n.readRemaining=(0,c.prop)(0),n.deliveryRemaining=(0,c.prop)(0),n.played=(0,c.collection)(P),n.read=(0,c.collection)(P),n.delivery=(0,c.collection)(P),n.settled=(0,c.derived)(n._settled,["isPTT","playedRemaining","readRemaining"]),a=i,o(n,a)}return a(t,e),s(t,[{key:"_settled",value:function(){return this.isPTT?!this.playedRemaining:!this.readRemaining}}]),t}(l.default);T.Collection="MsgInfo",T.Proxy="msgInfo",T.idClass=b.default,t.default=(0,c.defineModel)(T)},bdiiibjcij:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("cajijabhgb"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(c),f=i("eadfaddcj"),d=n(f),h=i("cbcbdjdah"),p=n(h),g=i("biecbbiiee"),y=n(g),v=i("cgcgbfbffj"),b=n(v),_=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.hasDocBefore=!0,a=i,o(n,a)}return a(t,e),s(t,[{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.stopListening(),this.reset()}},{key:"queryDocs",value:function(e,t){var i=this;if(t)return this.queryDocBefore?this.queryDocBefore:(this.queryDocBefore=y.default.queryMedia(t.id.remote,d.default.MEDIA_QUERY_LIMIT,"before",t.id,"document").then(function(e){return(!e||e.length<d.default.MEDIA_QUERY_LIMIT)&&(i.hasDocBefore=!1),i.add(e.filter(function(e){return e.isDoc}),{at:0}),{length:e.length}}).catch(l.WapDrop,l.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryDocBefore=null,i.trigger("query_doc_before")}),this.trigger("query_doc_before"),this.queryDocBefore);var n=e.msgs;if(0===this.length){if(!n||0===n.length)return this.hasDocBefore=!1,new Promise(function(e){e({eof:!0})});this.add(n.filter(function(e){return e.isDoc}),{at:0})}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasDocBefore=!1,new Promise(function(e){e({eof:!0})});if(this.length<=2*d.default.MEDIA_QUERY_LIMIT){var r=0===this.length?n.head():this.head();return this.queryDocs(e,r)}return new Promise(function(e){e({eof:!1})})}}]),t}(b.default);_.model=p.default,t.default=_},beahjdfigf:function(e,t,i){"use strict";function n(e,t){return(0,o.default)(e.contact,t.contact)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=i("ccicaaeiaa"),o=function(e){return e&&e.__esModule?e:{default:e}}(r)},bechdajic:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DAYS_OF_WEEK=["sun","mon","tue","wed","thu","fri","sat"],t.BUSINESS_HOUR_MODES={OPEN_24H:"open_24h",SPECIFIC_HOURS:"specific_hours",APPOINTMENT_ONLY:"appointment_only"}},bechejbabh:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("cajijabhgb"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(c),f=i("ccaaiecfib"),d=n(f),h=i("ddeghajfaj"),p=n(h),g=i("ceddibdhdb"),y=n(g),v=i("cgcgbfbffj"),b=n(v),_=i("chajfbfiga"),m=n(_),O=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.checksum=void 0,n.flushCountsTimer=new y.default(function(){n.hasPendingCounts()&&n.flushCounts()}),n.sortQuickReply=function(e,t){return e.totalCount===t.totalCount?e.id<t.id?-1:1:e.totalCount>t.totalCount?-1:1},n.onCountsFlushed=function(e){var t=e.id,i=e.count,r=n.get(t);r&&(r.count=i,r.pendingCount=0)},a=i,o(n,a)}return a(t,e),s(t,[{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),delete this.checksum}},{key:"filterShortcuts",value:function(e){return this.filter(function(t){return t.shortcut.toLowerCase().startsWith(e.toLowerCase())}).sort(this.sortQuickReply)}},{key:"sync",value:function(e){d.default.supportsFeature(d.default.F.QUICK_REPLIES_QUERY)&&(this.synced()&&this.checksum===e?this.hasPendingCounts()&&this.flushCounts():this.findQuery({}))}},{key:"periodicFlush",value:function(){d.default.supportsFeature(d.default.F.QUICK_REPLIES_QUERY)&&this.flushCountsTimer.debounceAndCap(2e3,5e3)}},{key:"updateChecksum",value:function(e){this.checksum=e}},{key:"synced",value:function(){return void 0!==this.checksum}},{key:"hasPendingCounts",value:function(){return this.some(function(e){return e.pendingCount>0})}},{key:"getAllPendingCounts",value:function(){var e={};return this.forEach(function(t){var i=t.id,n=t.pendingCount;n>0&&(e[i]=n)}),e}},{key:"flushCounts",value:function(){var e=this,t=this.getAllPendingCounts();m.default.flushQuickReplyCounts(t).then(function(i){i.checksum&&e.updateChecksum(i.checksum),i.data.filter(function(e){var i=e.id;return void 0!==t[i]}).forEach(e.onCountsFlushed)}).catch(l.WapDrop,function(){})}},{key:"_findQuery",value:function(){var e=this,t=this.getAllPendingCounts();return m.default.queryQuickReplies(t).then(function(i){return i.checksum&&e.updateChecksum(i.checksum),i.data.filter(function(e){var i=e.id;return void 0!==t[i]}).forEach(e.onCountsFlushed),i.data})}},{key:"handle",value:function(e){e.checksum&&this.updateChecksum(e.checksum);var t=[],i=[];e.quickReplies.forEach(function(e){"delete"===e.type?t.push(e):i.push(e)}),this.remove(t.map(function(e){return e.id})),this.add(i,{merge:!0})}}]),t}(b.default);O.model=p.default,t.default=new O},bfgbdiffgd:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){if("number"==typeof e&&e>0)return e-1}function u(e){if("number"==typeof e&&e>0)return 1024*e*1024}function c(e){if("number"==typeof e&&e>0)return 1024*e}function l(e){if("number"==typeof e&&e>0)return e}function f(e){if("number"==typeof e)return!!e}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),p=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},g=i("hbhijdici"),y=n(g),v=i("dcaifjegcg"),b=n(v),_=i("bjcgjfiffb"),m=i("ffgeceahe"),O=i("eadfaddcj"),E=n(O),P=i("bfbggcdbfb"),T=n(P),j=i("bebehddcbc"),C=n(j),S=i("chajfbfiga"),M=n(S),w=i("ccaaiecfib"),k=n(w),A={imageMaxKBytes:c,maxParticipants:s,media:u,maxFileSize:u,groupDescLength:l,restrictGroups:f,announceGroups:f,groupsV3:f,suspiciousLinks:f,googleMapsDoNotAuth:f,googleMapsKeyless:f,finalLiveLocation:f,statusRanking:f,stickers:f,frequentlyForwardedMessages:f,frequentlyForwardedGroupSetting:f},I=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.gifSearch=(0,v.prop)(E.default.SHOW_GIF_SEARCH),n.imageMaxEdge=(0,v.prop)(E.default.IMG_MAX_EDGE),n.imageMaxKBytes=(0,v.prop)(E.default.IMG_MAX_BYTES),n.maxParticipants=(0,v.prop)(E.default.MAX_GROUP_SIZE),n.maxSubject=(0,v.prop)(E.default.MAX_SUBJECT_LENGTH),n.media=(0,v.prop)(E.default.MAX_MEDIA_UPLOAD_SIZE),n.maxFileSize=(0,v.prop)(E.default.MAX_FILE_SIZE),n.notificationQuery=(0,v.prop)(E.default.USE_NOTIFICATION_QUERY),n.groupDescLength=(0,v.prop)(E.default.GROUP_DESCRIPTION_LENGTH),n.restrictGroups=(0,v.prop)(E.default.GROUPS_V3_RESTRICT_GROUPS),n.announceGroups=(0,v.prop)(E.default.GROUPS_V3_ANNOUNCE_GROUPS),n.groupsV3=(0,v.prop)(E.default.GROUPS_V3),n.fwdUiStartTs=(0,v.prop)(E.default.FWD_UI_START_TS),n.googleMapsDoNotAuth=(0,v.prop)(E.default.GOOGLE_MAPS_DO_NOT_AUTH),n.googleMapsKeyless=(0,v.prop)(E.default.GOOGLE_MAPS_KEYLESS),n.suspiciousLinks=(0,v.prop)(E.default.SUSPICIOUS_LINKS),n.finalLiveLocation=(0,v.prop)(E.default.FINAL_LIVE_LOCATION),n.statusRanking=(0,v.prop)(E.default.STATUS_RANKING),n.stickers=(0,v.prop)(E.default.STICKERS),n.multicastLimitGlobal=(0,v.prop)(E.default.MAX_FORWARD_COUNT_GLOBAL),n.frequentlyForwardedMessages=(0,v.prop)(E.default.FREQUENTLY_FORWARDED_MESSAGES),n.frequentlyForwardedThreshold=(0,v.prop)(E.default.FREQUENTLY_FORWARDED_THRESHOLD),n.frequentlyForwardedMax=(0,v.prop)(E.default.FREQUENTLY_FORWARDED_MAX),n.frequentlyForwardedGroupSetting=(0,v.prop)(E.default.FREQUENTLY_FORWARDED_GROUP_SETTING),n.wsOverride=(0,v.prop)(void 0),n.wsOverrideAttempts=(0,v.prop)(0),n.wsOverrideTimeout=(0,v.prop)(void 0),n.webRestoreFromCache=(0,v.prop)(E.default.WEB_RESTORE_FROM_CACHE),a=i,o(n,a)}return a(t,e),h(t,[{key:"delete",value:function(){p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.updateProps({})}},{key:"set",value:function(e,i,n){var r=this;if("string"==typeof e)"webRestoreFromCache"===e&&this.saveResumeProp(i),(0,m.setServerPropInElectron)(e,i);else{var o=e,a=i,s=a&&a.merge?y.default.omitBy(o,y.default.isUndefined):o;Object.entries(s).forEach(function(e){var t=d(e,2),i=t[0],n=t[1];return"webRestoreFromCache"===i&&r.saveResumeProp(n),(0,m.setServerPropInElectron)(i,n)})}return p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,e,i,n)}},{key:"updateProps",value:function(e){var t=this;T.default.Global.webcBucket=e.bucket||null,this.__props.forEach(function(i){var n=e[i];void 0===n?n=t.getDefault(i):A[i]&&void 0===(n=A[i](n))&&(n=t.getDefault(i)),t.set(i,n)});for(var i in k.default.F)void 0!==e[i]&&k.default.setFeature(i,e[i])}},{key:"handlePayload",value:function(e){"number"==typeof e.status&&e.status>=400||this.updateProps(e)}},{key:"handle",value:function(e){var t=e.shift();this.handlePayload(t)}},{key:"fetch",value:function(){return M.default.queryServerProps().then(this.handlePayload.bind(this))}},{key:"getWebRestoreFromCache",value:function(){return!k.default.supportsFeature(k.default.F.MODEL_STORAGE)&&this.webRestoreFromCache}},{key:"saveResumeProp",value:function(e){e!==_.INIT&&C.default.setWebRestoreFromCache(e)}},{key:"loadResumeProp",value:function(){var e=C.default.getWebRestoreFromCache();"boolean"==typeof e&&(this.webRestoreFromCache=e)}}]),t}(b.default);I.Proxy="serverProps";var L=(0,v.defineModel)(I);t.default=new L({id:"1"})},bgcdajbhif:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("hbhijdici"),l=n(c),f=i("cgcgbfbffj"),d=n(f),h=i("bjigbaghc"),p=n(h),g=i("eadfaddcj"),y=n(g),v=i("cajijabhgb"),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(v),_=i("bdiiahhjbe"),m=n(_),O=i("biecbbiiee"),E=n(O),P=i("jcfjeeiii"),T=n(P),j=i("chajfbfiga"),C=n(j),S=i("bjebjijbfc"),M=n(S),w=i("beeieigghj"),k=n(w),A=i("dcbdjheea"),I=i("bfgbdiffgd"),L=n(I),R=i("ccaaiecfib"),N=n(R),D=i("bfbggcdbfb"),F=n(D),G=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),delete this.checksum}},{key:"_find",value:function(e){return Promise.resolve({id:e})}},{key:"findQuery",value:function(e,i){var n=this;return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"findQuery",this).call(this,e,i).then(function(e){return Promise.all(e.map(function(e){if(e){var t=0;return e.msgs.forEach(function(i){t<e._msgs.length&&e._msgs[t].id.toString()===i.id.toString()?++t:i.delete()}),e._msgs.length>0?n.addStatusMessages(e.id,e._msgs):Promise.resolve()}})).then(function(){return e})})}},{key:"_findQuery",value:function(e){var t=this;return C.default.statusQuery().then(function(e){return t.checksum=e.checksum,Promise.map(e.statuses,function(e){e.totalCount!==e._msgs.length&&e.totalCount<=20&&m.default.warn("Received "+e._msgs.length+" status V3 messages when total count is "+e.totalCount+" for "+e.id)();var t=e.pic;return t?k.default.createFromData(t,"image/jpeg").then(function(t){return e.pic=t,e}):e})})}},{key:"loadMore",value:function(e,t,i){return C.default.statusQuery(e,t,i&&i.id,"after").then(function(e){return e.status>=400?(m.default.error("model:statusv3:findQuery error "+e.status)(),Promise.reject(e.status)):(e.forEach(function(e){e.invis=!0}),m.default.log("model:statusv3:loadMore:"+e.length)(),E.default.processMultipleMessages((0,A.createWid)(y.default.STATUS_WID),e,{add:"after",isHistory:!0}))})}},{key:"sync",value:function(e){var t=this,i=window.performance.now();return!e||this.checksum&&this.checksum!==e?this.findQuery({},{set:this.hasSynced()}).catch(b.WapDrop,function(){}).finally(function(){t.trigger("sync")}).tap(function(e){var n=window.performance.now(),r=Math.round(n-i);t.logMetrics({type:"sync",syncTime:r}),t.forEach(function(e){e.msgs.length>e.totalCount&&m.default.log("Total count: "+e.totalCount+", msgs length: "+e.msgs.length)()})}):Promise.resolve(void 0)}},{key:"logMetrics",value:function(e){var t=void 0;t="sync"===e.type?new F.default.WebcStatusSync({webcStatusSyncT:e.syncTime}):new F.default.WebcStatusSession({webcStatusSessionId:e.sessionId});var i=this.filter(function(e){return!e.contact.isMe}),n=i.filter(function(e){return!e.contact.statusMute}),r=n.filter(function(e){return e.hasUnread}),o=n.filter(function(e){return!e.hasUnread}),a=i.filter(function(e){return e.contact.statusMute}),s=l.default.sum(n.map(function(e){return e.unreadCount})),u=l.default.sum(n.map(function(e){return e.readCount})),c=l.default.sum(a.map(function(e){return e.totalCount}));t.webcStatusRecentItemCount=s,t.webcStatusRecentRowCount=r.length,t.webcStatusViewedItemCount=u,t.webcStatusViewedRowCount=o.length,t.webcStatusMutedItemCount=c,t.webcStatusMutedRowCount=a.length,t.commit()}},{key:"hasSynced",value:function(){return!!this.checksum}},{key:"handleUpdate",value:function(e,t,i){var n=e.id.fromMe?p.default.me:e.author;if(this.updateChecksum(t),this.hasSynced()){if(i)return!0;var r=this.get(n);if(r){var o=r.totalCount===r.msgs.length;if("revoke"===e.subtype){var a=l.default.take(r.msgs.toArray(),r.totalCount-r.unreadCount),s=l.default.map(a,function(e){return e.id.toString()}),u={totalCount:r.totalCount-1};l.default.find(s,function(t){return t===e.protocolMessageKey.toString()})||r.readKeys[e.protocolMessageKey.toString()]||(u.unreadCount=r.unreadCount-1),r.set(u)}else{var c={totalCount:r.totalCount+1};e.invis||(c.unreadCount=r.unreadCount+1),c.t=e.t,r.set(c)}return!o&&e.body&&k.default.createFromBase64Jpeg(e.body).then(function(e){r.pic=e}),o}return this.add({id:n,t:e.t,unreadCount:e.invis?0:1,totalCount:1}),!0}return!1}},{key:"handleScore",value:function(e,t){var i=this.get(e);i?i.score=t:m.default.log("models:statusV3:score:no_status:"+[e,t].join())()}},{key:"updateChecksum",value:function(e){e?this.hasSynced()&&(this.checksum=e):m.default.info("models:statusV3:no_checksum")()}},{key:"handle",value:function(e){var t=e.shift();if(Array.isArray(t))m.default.warn("models:statusV3:unexpected update")(t);else switch(t.type){case"read":this.updateChecksum(t.checksum);var i=this.get(t.chat);i?i.handleReadStatus(t.key):m.default.log("models:statusV3:read:no_status:"+[t.chat,t.key].join())(t);break;case"privacy":break;case"score":for(var n=0;n<t.scores.length;n++){var r=t.scores[n],o=r.jid,a=r.score;this.handleScore(o,a)}this.sort();break;default:m.default.warn("models:statusV3:unknown:"+t.type,t)()}}},{key:"addStatusMessages",value:function(e,t){return E.default.processMultipleMessages((0,A.createWid)(y.default.STATUS_WID),t,{add:"after",isHistory:!0})}},{key:"getUnexpired",value:function(e){var t=this.filter(function(e){return e.totalCount>0&&M.default.globalUnixTime()-e.t<=86400&&e.contact.isMyContact&&!e.contact.isMe});if(e){return l.default.filter(t,function(e){return e.unreadCount>0})}return l.default.filter(t,function(e){return 0===e.unreadCount})}},{key:"getMyStatus",value:function(){var e=this.filter(function(e){return e.contact.isMe});return l.default.isEmpty(e)?void 0:M.default.globalUnixTime()-e[0].t>86400?void 0:e[0]}}]),t}(d.default);G.model=T.default,G.comparator=function(e,t){return L.default.statusRanking&&N.default.supportsFeature(N.default.F.STATUS_RANKING)&&e.score!==t.score?t.score-e.score:t.t-e.t},t.default=new G},bgdcgdigif:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CALL_TYPES=t.CALL_UI_STATES=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i("dcaifjegcg"),u=function(e){return e&&e.__esModule?e:{default:e}}(s),c=t.CALL_UI_STATES={NONE:"NONE",OUTGOING_RING:"OUTGOING_RING",INCOMING_RING:"INCOMING_RING",OUTGOING_CALLING:"OUTGOING_CALLING",CONNECTING:"CONNECTING",RECONNECTING:"RECONNECTING",ACTIVE:"ACTIVE",ENDED:"ENDED",REJECTED:"REJECTED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",FAILED:"FAILED"},l=(t.CALL_TYPES={VOICE:"VOICE",VIDEO:"VIDEO"},function(e){function t(){var e,i,o,a;n(this,t);for(var u=arguments.length,l=Array(u),f=0;f<u;f++)l[f]=arguments[f];return i=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o.callId=(0,s.session)(),o.state=(0,s.session)(c.NONE),o.from=(0,s.session)(),o.to=(0,s.session)(),o.type=(0,s.session)(),o.muted=(0,s.session)(),o.peerMuted=(0,s.session)(),o.speaker=(0,s.session)(),o.outgoing=(0,s.session)(),o.startTime=(0,s.session)(),o.showFullscreenCallView=(0,s.session)(!1),o.showCallStatusBar=(0,s.session)(!1),o.externalInputAvailable=(0,s.session)(),o.interrupted=(0,s.session)(),o.peerBusy=(0,s.session)(),o.peerVideoState=(0,s.session)(),o.voipWindowId=(0,s.session)(),a=i,r(o,a)}return o(t,e),a(t,[{key:"onStateChange",value:function(){}},{key:"onAudioOutputChange",value:function(){}},{key:"overrideOutputRoute",value:function(e){return Promise.resolve()}}]),t}(u.default));l.Proxy="callUi",t.default=l},bgfcjjddjf:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("chghgadcbg"),c=n(u),l=i("cgcgbfbffj"),f=n(l),d=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.listenTo(e,"add",e.blockContact),e.listenTo(e,"remove",e.unblockContact),e}return a(t,e),s(t,[{key:"blockContact",value:function(e){e.contact().isContactBlocked=!0}},{key:"unblockContact",value:function(e){e.contact().isContactBlocked=!1}}]),t}(f.default);d.model=c.default,t.default=new d},bhggeigghg:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.default=n},biaifggagf:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("cgejjichfa"),c=i("dbdaeccafe"),l=i("hbhijdici"),f=n(l),d=i("daejhdfjb"),h=n(d),p=i("hgeacfdgi"),g=n(p),y=i("bdiiahhjbe"),v=n(y),b=i("cgcgbfbffj"),_=n(b),m=i("bhgjacgcdd"),O=n(m),E=i("ddcbacabaj"),P=n(E),T=i("ccaaiecfib"),j=n(T),C=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.pendingOffers={},n.pendingVoipCapChecks={},a=i,o(n,a)}return a(t,e),s(t,[{key:"handleQuery",value:function(e){return Promise.resolve()}},{key:"handle",value:function(e){var t=this,i=e.shift();if(i.data&&i.data[0]){var n=P.default.parseCallSignalingMsg(i);if(!n)return;var r={};j.default.supportsFeature(j.default.F.DESKTOP_VOIP_VOICE_CALL)&&(Array.isArray(i.data[0])&&(i.data=i.data[0]),(0,E.base64DecodeRecursively)(i.data),r={peer_jid:n.peer_jid,payload:i.data,peer_platform:n.peer_platform,peer_app_version:n.peer_version,epoch_msec:n.t?String(1e3*n.t):void 0,elapsed_msec:n.e?String(1e3*n.e):void 0,is_offline:i.data[1].offline});var o=n.call_id,a=void 0,s=null,l=null,d=null;switch(n.type){case c.TYPE.OFFER:if(a=u.CALL_STATES.INCOMING_RING,s=n.isVideoCall,l=n.isGroupCall,d=n.t,O.default.isInitialized()){this.pendingVoipCapChecks[o]=(0,m.checkVoipCapability)(f.default.assign({},n));var h=i.data[2].find(function(e){return"enc"===e[0]});this.pendingOffers[o]=Promise.sit("receivedKey",function(e){return P.default.receiveCallOfferKey(e,h),i}).endWithControls("receivedKey")}break;case c.TYPE.OFFER_RECEIPT:a=u.CALL_STATES.CONNECTING;break;case c.TYPE.PREACCEPT:a=u.CALL_STATES.OUTGOING_RING;break;case c.TYPE.ACCEPT_RECEIPT:case c.TYPE.ACCEPT:a=u.CALL_STATES.ACTIVE;break;case c.TYPE.REJECT:a=u.CALL_STATES.REJECTED,g.default.callId===o&&O.default.endCall(),this.cleanupPendingOffer(o);break;case c.TYPE.TERMINATE:a=u.CALL_STATES.ENDED,g.default.callId===o&&O.default.endCall(),this.cleanupPendingOffer(o)}this.pendingVoipCapChecks[o]?this.pendingVoipCapChecks[o].then(function(e){var u=void 0;u=!l&&(s?e&&j.default.supportsFeature(j.default.F.DESKTOP_VOIP_VIDEO_CALL):e),t.processIncomingCall(o,i.from,a,{isVideo:s,isGroupCall:l,canHandleLocally:u,offerTime:d}),u&&t.pendingOffers[o]&&j.default.supportsFeature(j.default.F.DESKTOP_VOIP_VOICE_CALL)?t.pendingOffers[o].then(function(){O.default.handleIncomingSignalingMessage(n,r)}):t.cleanupPendingOffer(o)}).finally(function(){delete t.pendingVoipCapChecks[o]}):this.pendingOffers[o]?(this.processIncomingCall(o,i.from,a),j.default.supportsFeature(j.default.F.DESKTOP_VOIP_VOICE_CALL)&&this.pendingOffers[o].then(function(){O.default.handleIncomingSignalingMessage(n,r)})):(this.processIncomingCall(o,i.from,a,{isVideo:s,isGroupCall:l,canHandleLocally:!1,offerTime:d}),O.default.isInitialized()&&j.default.supportsFeature(j.default.F.DESKTOP_VOIP_VOICE_CALL)&&O.default.handleIncomingSignalingMessage(n,r))}else{var p=void 0;switch(i.type){case"offer_key":var y=this.pendingOffers[i.id];y?y.control.receivedKey(i.key):v.default.warn("received offer_key: no pending offer")();break;case"accept":p=u.CALL_STATES.ACTIVE,this.cleanupPendingOffer(i.id);break;case"reject":p=u.CALL_STATES.REJECTED,this.cleanupPendingOffer(i.id);break;case"terminate":p=u.CALL_STATES.ENDED,this.cleanupPendingOffer(i.id)}this.processIncomingCall(i.id,void 0,p)}}},{key:"processIncomingCall",value:function(e,t,i,n){var r=n;if(i){var o={id:e};null!=t&&(o.peerJid=t),r&&(r=f.default.omitBy(r,function(e){return null==e}),f.default.merge(o,r)),this.add(o,{merge:!0});this.assertGet(e).setState(i)}}},{key:"cleanupPendingOffer",value:function(e){delete this.pendingOffers[e]}}]),t}(_.default);C.model=h.default,t.default=new C},biecbbiiee:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgCollection=void 0;var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("hbhijdici"),f=r(l),d=i("cajijabhgb"),h=n(d),p=i("ebggjhghhi"),g=n(p),y=i("cgcgbfbffj"),v=r(y),b=i("eadfaddcj"),_=r(b),m=i("bdiiahhjbe"),O=r(m),E=i("cbcbdjdah"),P=r(E),T=i("ccgjijjbbj"),j=r(T),C=i("cahfddcdga"),S=r(C),M=i("eacidghfgh"),w=r(M),k=i("bhggeigghg"),A=r(k),I=i("chajfbfiga"),L=r(I),R=i("jccfhaecf"),N=r(R),D=i("hjbbdjjdf"),F=i("dcbdjheea"),G=i("dfjijdgbhd"),U=i("bfababcidc"),x=t.MsgCollection=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.lastReceivedReceipt={},e.lastReceivedPaymentTransaction={},e.preAck={},e.pendingAdd={},e.ftsCache={},e.keysForResyncReceipts=void 0,e.listenTo(w.default,"change:stream",function(){w.default.stream===M.STREAM.DISCONNECTED&&(this.preAck={})}),e.listenTo(e,"remove",e.removeFromCollection),e}return s(t,e),u(t,[{key:"removeFromCollection",value:function(e){e.chat&&e.chat.removeFromCollection(e)}},{key:"_findQuery",value:function(e,t){var i=this,n=void 0;switch(e.direction){case"before":case"after":n=e.direction;break;default:n="before"}var r={add:n,isHistory:!0};return(0,U.msgFindQuery)(n,e,r,t,this.get(e)).then(function(t){if(t.status>=400)return O.default.error("model:Msg:findQuery error "+t.status)(),Promise.reject(t.status);var n=function(){var t=i.get(e),n=A.default.Chat.get(e.remote);return t?t.msgChunk:n?n.msgs:void 0};return t.forEach(function(e){e.invis=!0}),O.default.log("model:Msg:findQuery:got:"+t.length+":"+e.direction)(),i.processMultipleMessages(e.remote,t,r,n)})}},{key:"getStarred",value:function(e,t,i,n){var r=this,o={count:"number"!=typeof t||isNaN(t)?_.default.PAGE_SIZE:t,chat:e||void 0,remote:i&&i.remote,id:i&&i.id,fromMe:i&&i.fromMe,participant:i&&i.participant,media:n?"gif":void 0},a={add:"search"};return(0,U.msgFindQuery)("star",o,a).then(function(e){var t=e.status;return e.status>=400?(499===t?O.default.log("model:Msg:getStarred error 499 (unimplemented)")():O.default.error("model:Msg:getStarred error "+t)(),Promise.reject(t)):r.processMultipleMessages(void 0,e,a)})}},{key:"queryVCard",value:function(e){var t=this;return(0,U.queryVCard)(e).then(function(e){return 499===e.status?(O.default.log("model:Msg:queryVCard error 499 (unimplemented)")(),Promise.reject(new h.E499)):t.processMultipleMessages(void 0,e,{add:"search"})})}},{key:"incrementalStarredUpdate",value:function(e){return this.processMultipleMessages(void 0,e,{add:"search"})}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments[2],n=this,r=arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=e+"__"+(o.label||o.kind||"");if(1!==t||r)return this._search(e,t,i,r,o.label,o.kind);var s=this.ftsCache[a];if(s)return s;var u=this._search(e,t,i,r,o.label,o.kind);this.ftsCache[a]=u;var c=function(){n.ftsCache[a]=null};return f.default.delay(c,_.default.FTS_TTL),u.catch(c),u}},{key:"_search",value:function(e,t,i,n,r,o){var a=this,s={searchTerm:e,page:t&&(0,D.isNumber)(t)?t:1,count:i&&(0,D.isNumber)(i)?i:_.default.PAGE_SIZE,remote:n,label:r,kind:o},u={add:"search"};return(0,U.msgFindQuery)("search",s,u).then(function(e){if(404===e.status)return Promise.reject(new h.E404);if(e.status>=400)return O.default.error("model:Msg:search error "+e.status)(),Promise.reject(e.status);var t=Array.isArray(e)?e:e.messages,i=!!Array.isArray(e)||e.eof;return Promise.props({messages:a.processMultipleMessages(void 0,t,u),eof:i})})}},{key:"queryMedia",value:function(e,t,i,n,r){var o=this,a={remote:e,count:t&&(0,D.isNumber)(t)?t:_.default.PAGE_SIZE,id:n&&n.id,fromMe:n&&n.fromMe,participant:n&&n.participant,direction:i||"before",media:r},s={add:"search"};return(0,U.msgFindQuery)("media",a,s).then(function(e){return e.status>=400?(O.default.error("model:Msg:media error "+e.status)(),Promise.reject(e.status)):r?o.processMultipleMessages(void 0,e,{add:"search"}):Promise.props({docCount:e.docCount,linkCount:e.linkCount,mediaCount:e.mediaCount,messages:o.processMultipleMessages(void 0,e.messages,s)})})}},{key:"getContext",value:function(e,t,i){var n=this,r=this.get(e);if(r)return Promise.all([(0,U.msgFindQuery)("before",e,{add:"before",isHistory:!0},i),(0,U.msgFindQuery)("after",e,{add:"after",isHistory:!0},i)]).spread(function(i,o){return Array.isArray(i)&&Array.isArray(o)?(r.search=!1,Promise.all([n.processMultipleMessages(e.remote,i,{add:"before",isHistory:!0},t),n.processMultipleMessages(e.remote,o,{add:"after",isHistory:!0},t)])):(O.default.error("model:msg:getContext fetch error",i,o)(),Promise.reject(i.status||o.status))});var o={add:"after",isHistory:!0};return(0,U.msgFindQuery)("after",e,o,i).then(function(i){return Array.isArray(i)?N.default.isStatusV3(i[0].id.remote)?Promise.reject("statusV3, stop querying before the msg"):n.processMultipleMessages(e.remote,i,o,t):(O.default.error("model:msg:getContext:after fetch error",i)(),Promise.reject(i.status))}).then(function(t){var r=(0,S.default)(t[0]),o=r.id.clone();o.count=e.count+1;var a={add:"before",isHistory:!0};return Promise.all([(0,U.msgFindQuery)("before",o,a,i).then(function(t){if(!Array.isArray(t))return O.default.error("model:msg:getContext:before fetch error",t)(),Promise.reject(t.status);if(!t[t.length-1].id.equals(e))return O.default.error("model:msg:getContext:before ctx message mismatch",t)(),Promise.reject(405);var i=function(){return r.msgChunk};return n.processMultipleMessages(e.remote,t,a,i)}),Promise.resolve(t)])})}},{key:"_hasSynced",value:function(){return g.waitForBBEvent(this,_.default.COLLECTION_HAS_SYNCED)}},{key:"delete",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.lastReceivedReceipt={},this.lastReceivedPaymentTransaction={},this.preAck={}}},{key:"getKeysForResyncReceipts",value:function(){var e=[],t=f.default.assign({},this.lastReceivedReceipt,this.lastReceivedPaymentTransaction);for(var i in t){var n=(0,F.createWid)(i),r=A.default.Chat.get(n),o=void 0;if(r&&(o=r.getFirstMsgWithStatus()),o){var a=o.id;a.t=this.lastReceivedReceipt[n]||o.t||0,a.payT=this.lastReceivedPaymentTransaction[n],e.push(a)}else O.default.error("Msg:resyncReceipts wid in lastReceivedReceipt, but no msg: "+n.toString())()}return e}},{key:"setKeysForResyncReceipts",value:function(e){this.keysForResyncReceipts=e}},{key:"resetKeysForResyncReceipts",value:function(){this.keysForResyncReceipts=void 0}},{key:"resyncReceipts",value:function(){var e=this;O.default.log("Msg:resyncReceipts")();var t=this.keysForResyncReceipts||this.getKeysForResyncReceipts();return 0===t.length?Promise.resolve():L.default.resyncReceipts(t).then(function(t){if(Array.isArray(t)){O.default.log("Msg:resyncReceipts success")();(A.default.Chat.promises.initializeRestFromTabletCache?A.default.Chat.promises.initializeRestFromTabletCache:Promise.resolve()).then(function(){t.forEach(function(t){e.updateLastReceipt(t.id,t.t),e.updateLastTransactionTime(t.id,t.payT),t.acks.forEach(function(i){if(4===i.length){var n=new j.default({fromMe:i[1],remote:t.id,id:i[0],participant:i[2]}),r=e.get(n);r&&r.updateAck(i[3])}else O.default.error("Msg:resyncReceipts invalid response: "+JSON.stringify(i))()}),t.msgs.length>0&&e.processMultipleMessages(t.id,t.msgs,{update:!0,isHistory:!1}).catch(h.LogoutDrop,function(){})})})}else O.default.error("Msg:resyncReceipts error",t)()}).catch(h.LogoutDrop,h.EphemeralDrop,h.BrowserReplacedDrop,function(){}).catch(function(e){throw O.default.error("Msg:resyncReceipts dropped "+String(e)+" "+(e?e.stack:"no stack"))(),new Error("Msg:resyncReceipts dropped")}).finally(function(){e.resetKeysForResyncReceipts()})}},{key:"updateLastReceipt",value:function(e,t){var i=this.lastReceivedReceipt[e];t&&(!i||t>i)&&(this.lastReceivedReceipt[e]=t)}},{key:"updateLastTransactionTime",value:function(e,t){var i=this.lastReceivedPaymentTransaction[e];t&&(!i||t>i)&&(this.lastReceivedPaymentTransaction[e]=t)}},{key:"processMultipleMessages",value:function(e,t,i,n){var r=this,o=function(){return(0,G._processMultipleMessages)(e,t,i,n)};if(e){var a=void 0,s=this.pendingAdd[e];return a=s?s.then(o):o(),a.finally(function(){e&&r.pendingAdd[e]===a&&(r.pendingAdd[e]=null)}).catch(function(){}),this.pendingAdd[e]=a}return o()}}]),t}(v.default);x.model=P.default,t.default=new x},biedfadfag:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("diafggiefe"),l=n(c),f=i("cgcgbfbffj"),d=n(f),h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"toArray",value:function(){var e=this;return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"filter",this).call(this,function(t){return t.old&&e.remove(t),t})}}]),t}(d.default);h.model=l.default,t.default=h},bieicghjif:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("ddhijeejag"),l=n(c),f=i("dcaifjegcg"),d=n(f),h=i("dbdfbgehgj"),p=n(h),g=i("gbfffciea"),y=n(g),v=i("bjigbaghc"),b=n(v),_=i("cajijabhgb"),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(_),O=i("gabccaieg"),E=n(O),P=i("bdiiahhjbe"),T=n(P),j=i("chajfbfiga"),C=n(j),S=i("jccfhaecf"),M=n(S),w=i("ccihhdchab"),k=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,f.prop)(),n.duration=(0,f.prop)(),n.participants=(0,f.collection)(E.default),n.active=(0,f.session)(!1),n.keepAliveTimer=(0,f.session)(),n.stopPromise=(0,f.session)(),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){var e=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.listenTo(this.participants,"remove reset",function(){e.hasParticipants()||e.delete()});var i=p.default.get(this.id);i&&!i.liveLocation&&(i.liveLocation=this)}},{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.stopViewingMap(),this.participants.delete(),this.getCollection().remove(this.id);var e=p.default.get(this.id);e&&(e.liveLocation=void 0)}},{key:"hasParticipants",value:function(){return this.participants.length>0}},{key:"startViewingMap",value:function(){this.active||(this.active=!0,this._updateLiveLocations(),this._startKeepAlive())}},{key:"stopViewingMap",value:function(){this.active&&(this.active=!1,this._pauseLiveLocations(),this._stopKeepAlive())}},{key:"userHasLiveLocation",value:function(e){return!!this.participants.get(e)}},{key:"iHaveLiveLocation",value:function(){return this.userHasLiveLocation(b.default.me)}},{key:"stopMyLiveLocation",value:function(e){var t=this;if(!this.iHaveLiveLocation())return Promise.reject(new m.ActionError);if(this.stopPromise)return this.stopPromise;var i=this.stopPromise=C.default.disableLiveLocation(this.id),n=new w.ActionType(l10n.t("action_live_location_stopping")),r=e||(0,w.genId)(),o=i.then(function(e){return 200===e.status?new w.ActionType(l10n.t("action_live_location_stopped")):e.status>=400?new w.ActionType(l10n.t("action_live_location_stop_failed")):void 0}).catch(function(e){return T.default.error("models:liveLocation:disableLiveLocation dropped")(e),new w.ActionType(l10n.t("action_live_location_stop_failed"),l10n.t("action_try_again"),t.stopMyLiveLocation.bind(t,r))});return y.default.openToast(l.default.createElement(w.ActionToast,{id:r,initialAction:n,pendingAction:o})),i.then(function(e){if(200===e.status&&!e._duplicate){var i=t.participants.get(b.default.me);i&&i.disable()}}).finally(function(){t.stopPromise=null})}},{key:"_updateLiveLocations",value:function(){this.update().catch(function(){})}},{key:"_pauseLiveLocations",value:function(){C.default.unsubscribeLiveLocation(this.id).catch(m.WapDrop,function(){})}},{key:"_sendKeepAlive",value:function(){C.default.subscribeLiveLocation(this.id,!1).catch(m.WapDrop,function(){})}},{key:"_startKeepAlive",value:function(){if(!this.keepAliveTimer){var e=this.duration;e&&(this.keepAliveTimer=window.setInterval(this._sendKeepAlive.bind(this),1e3*e))}}},{key:"_stopKeepAlive",value:function(){this.keepAliveTimer&&(window.clearInterval(this.keepAliveTimer),this.keepAliveTimer=null)}}]),t}(d.default);k.Collection="LiveLocation",k.Proxy="liveLocation",k.idClass=M.default,t.default=(0,f.defineModel)(k)},biheibdage:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ATTACH_MEDIA_STATE=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("cajijabhgb"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(f),h=i("cieaaiahhf"),p=n(h),g=i("cgffhfegce"),y=i("bdiiahhjbe"),v=n(y),b=i("beeieigghj"),_=n(b),m=i("ddgbhifaji"),O=i("cbcbdjdah"),E={READY:"ready",PROCESSING:"processing",ERROR:"error"};t.ATTACH_MEDIA_STATE=E;var P=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,c.prop)(),n.file=(0,c.prop)(),n.uiProcessed=(0,c.prop)(),n.fileOrigin=(0,c.prop)(),n.state=(0,c.session)(),n.mediaPrep=(0,c.session)(),n.mimetype=(0,c.session)(),n.processPromise=(0,c.session)(),n.exception=(0,c.session)(),n.chat=(0,c.session)(),n.caption=(0,c.session)(),n.type=(0,c.session)(O.TYPE.UNKNOWN),n.preview=(0,c.session)(),n.fullPreview=(0,c.session)(),n.fullPreviewSize=(0,c.session)(),n.filename=(0,c.session)(),n.pdfPages=(0,c.session)(),n.isGif=(0,c.session)(),n.gifAttribution=(0,c.session)(),n.previewable=(0,c.derived)(n._previewable,["preview","fullPreview","type","filename","fullPreviewSize","mimetype"]),a=i,o(n,a)}return a(t,e),s(t,[{key:"_previewable",value:function(){if(!this.type||!this.mimetype||!this.fullPreview)return!1;switch(this.type){case O.TYPE.DOCUMENT:return!!this.filename;case O.TYPE.IMAGE:case O.TYPE.VIDEO:return!(!this.fullPreviewSize||!this.preview);case O.TYPE.AUDIO:case O.TYPE.PTT:case O.TYPE.UNKNOWN:return!0;default:throw new Error("Unsupported attach media type "+this.type)}}},{key:"initialize",value:function(){if(u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),!(this.file instanceof Promise))throw new Error("cannot process non-promise file");this.processFile(this.file)}},{key:"processFile",value:function(e){this.state=E.PROCESSING,this.processPromise=this._processFilePromiseHelper(e)}},{key:"_processFilePromiseHelper",value:function(e){var t=this;return e.then(function(e){t.set(e);var i={},n=e.file,r=e.isGif,o=e.gifAttribution;r?(i.asGif=r,i.gifAttribution=o):e.type===g.FILETYPE.DOCUMENT&&(i.asDocument=!0);var a=_.default.createFromData(n,n.type),s=(0,m.prepRawMedia)(a,i);return t.set({mediaPrep:s}),s.waitForPrep().then(function(e){var i=e.documentPreview,n=window.URL.createObjectURL(e.mediaBlob),r={file:e.mediaBlob,fullPreview:n,type:e.type,filename:e.filename,mimetype:e.mimetype,preview:e.preview,state:E.READY,isGif:e.isGif,fullPreviewSize:void 0,pdfPages:void 0};e.fullWidth&&e.fullHeight&&(r.fullPreviewSize={height:e.fullHeight,width:e.fullWidth}),e.type===O.TYPE.IMAGE&&(r.preview=n),e.type===O.TYPE.DOCUMENT&&i&&(r.fullPreview=i.url,r.preview=i.thumbUrl,r.fullPreviewSize={height:i.height,width:i.width},r.pdfPages=i.pdfPages),t.set(r),v.default.assert(t.previewable,"AttachMedia processFile","Invariant violated, processed file is not previewable")()})}).catch(d.InvalidMediaFileType,d.InvalidImageFileType,function(i){return t._processFilePromiseHelper(e.then(function(e){return e.type=g.FILETYPE.DOCUMENT,e}))}).catch(p.default,d.MediaFileFailedLoad,d.MediaFileEmpty,function(e){return t.set({exception:e,state:E.ERROR}),t}).catch(function(e){return t.set({exception:new d.InvalidMediaFileType,state:E.ERROR}),t})}},{key:"sendToChat",value:function(e,t){if(!this.mediaPrep)throw new Error("MediaPrep not available");if(this.state===E.ERROR)throw new Error(this.exception);if(!(this.state!==E.PROCESSING||this.previewable&&t.addEvenWhilePreparing))throw new Error("Media still processing");if(this.state===E.READY)return void this.mediaPrep.sendToChat(e,t);var i={mimetype:this.mimetype};switch(this.type){case O.TYPE.VIDEO:i.isGif=this.isGif,i.gifAttribution=this.gifAttribution;case O.TYPE.IMAGE:i.width=this.fullPreviewSize.width,i.height=this.fullPreviewSize.height,i.body=this.preview,t.placeholderProps=i;break;case O.TYPE.DOCUMENT:i.pageCount=this.pdfPages,i.filename=this.filename,i.body=this.preview,t.placeholderProps=i;break;case O.TYPE.AUDIO:case O.TYPE.PTT:}this.mediaPrep.sendToChat(e,t)}},{key:"getFileType",value:function(){if(!(this.file instanceof Blob||this.file instanceof File))throw new Error("expected file to be a Blob or File");return(0,g.typeFromMimetype)(this.file.type)}},{key:"delete",value:function(){this.fullPreview&&window.URL.revokeObjectURL(this.fullPreview),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this)}}]),t}(l.default);P.Proxy="attachMedia",t.default=(0,c.defineModel)(P)},bijffg:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("hbhijdici"),f=r(l),d=i("ddhijeejag"),h=n(d),p=i("cajijabhgb"),g=n(p),y=i("bbjjjbicfb"),v=r(y),b=i("cgcgbfbffj"),_=r(b),m=i("chajfbfiga"),O=r(m),E=i("bhggeigghg"),P=r(E),T=i("bdiiahhjbe"),j=r(T),C=i("bebehddcbc"),S=r(C),M=i("bjigbaghc"),w=r(M),k=i("bgabgddgch"),A=r(k),I=i("ebggjhghhi"),L=n(I),R=i("eacidghfgh"),N=r(R),D=i("gbfffciea"),F=r(D),G=i("ccihhdchab"),U=i("hciaejfjd"),x=i("bddhdheedf"),Y=i("bfbggcdbfb"),B=r(Y),V=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.checksum=void 0,e.listenTo(e,"remove",e.handleRemove),e}return s(t,e),u(t,[{key:"addNewLabel",value:function(e,t){(0,x.logLabelOperationEvent)(B.default.LABEL_OPERATIONS.ADD,1,B.default.LABEL_TARGETS.LABEL);var i=O.default.createLabel(e,t),n=new G.ActionType(l10n.t("action_adding_new_label",{labelName:e})),r=(0,G.genId)(),o=i.then(function(t){return 200===t.status?new G.ActionType(l10n.t("action_new_label_added",{labelName:e})):new G.ActionType(l10n.t("action_new_label_add_failed",{labelName:e}))}).catch(function(t){return j.default.error("addingNewLabel dropped")(t),new G.ActionType(l10n.t("action_new_label_add_failed",{labelName:e}))});return F.default.openToast(h.createElement(G.ActionToast,{id:r,initialAction:n,pendingAction:o})),i}},{key:"addOrRemoveLabels",value:function(e,t){var i=O.default.addOrRemoveLabels(e,t),n=new G.ActionType(l10n.t("action_add_remove_labels",{count:e.length,_plural:e.length})),r=(0,G.genId)(),o=i.then(function(t){return 200===t.status?new G.ActionType(l10n.t("action_add_remove_labels_sucess",{count:e.length,_plural:e.length})):new G.ActionType(l10n.t("action_add_remove_labels_failed"))}).catch(function(e){return j.default.error("addingNewLabel dropped")(e),new G.ActionType(l10n.t("action_add_remove_labels_failed"))});return F.default.openToast(h.createElement(G.ActionToast,{id:r,initialAction:n,pendingAction:o})),i}},{key:"deleteLabel",value:function(e){(0,x.logLabelOperationEvent)(B.default.LABEL_OPERATIONS.DELETE,1,B.default.LABEL_TARGETS.LABEL);var t=O.default.deleteLabel(e),i=this.assertGet(e),n=i.name,r=new G.ActionType(l10n.t("action_deleting_label",{labelName:n})),o=(0,G.genId)(),a=t.then(function(e){return 200===e.status?new G.ActionType(l10n.t("action_delete_label_sucess",{labelName:n})):new G.ActionType(l10n.t("action_delete_label_failed",{labelName:n}))}).catch(function(e){return j.default.error("addingNewLabel dropped")(e),new G.ActionType(l10n.t("action_delete_label_failed",{labelName:n}))});return F.default.openToast(h.createElement(G.ActionToast,{id:o,initialAction:r,pendingAction:a})),t}},{key:"updateLabel",value:function(e,t,i){(0,x.logLabelOperationEvent)(B.default.LABEL_OPERATIONS.EDIT,1,B.default.LABEL_TARGETS.LABEL);var n=O.default.editLabel(e,i,t),r=new G.ActionType(l10n.t("action_label_update_color")),o=(0,G.genId)(),a=n.then(function(e){return 200===e.status?new G.ActionType(l10n.t("action_label_update_color_succeeded")):new G.ActionType(l10n.t("action_label_update_color_failed"))}).catch(function(e){return j.default.error("addingNewLabel dropped")(e),new G.ActionType(l10n.t("action_label_update_color_failed"))});return F.default.openToast(h.createElement(G.ActionToast,{id:o,initialAction:r,pendingAction:a})),n}},{key:"getNewLabelColor",value:function(){return O.default.queryNextLabelColor().then(function(e){return e.labelColors[0].color}).catch(function(e){})}},{key:"getLabelColorPalette",value:function(){return this.labelColorPalette=this.labelColorPalette||S.default.getSmbLabelPalette(),this.labelColorPalette&&this.labelColorPalette.waVersion===w.default.phone.wa_version?Promise.resolve(this.labelColorPalette.colors):this._getColorPaletteLoop().then(function(e){var t=e.labelColors.map(function(e){return e.color});return S.default.setSmbLabelPalette({colors:t,waVersion:w.default.phone.wa_version}),t}).catch(function(){})}},{key:"_getColorPaletteLoop",value:function(){return Promise.loop(function(e,t,i){var n=Promise.delay(A.default.expBackoff(i,12e4,1e3,.1));return("CONNECTED"===N.default.stream?Promise.resolve():L.waitForBBEvent(N.default,"change:stream",function(){return"CONNECTED"===N.default.stream})).then(function(){return O.default.queryLabelPalette().then(function(t){e(t)})}).catch(function(e){return!(e instanceof Promise.CancellationError)},function(e){return i>3||404===e?(j.default.error("labels:loadLabelPalette:error "+String(e))(),404===e?Promise.reject(new g.E404):Promise.reject(new g.GaveUpRetry("Gave up loading label palette "+i+" tries"))):n})},0)}},{key:"handleRemove",value:function(e){e.labeltemColleciton.toArray().forEach(function(e){var t=e.parentId,i=e.parentType,n=e.labelId,r=P.default[i].get(t);r&&(r.labels=f.default.remove(r.labels,function(e){return e!==n}))})}},{key:"onResume",value:function(){var e=this;this.filter(function(e){return e.hasObservers()}).forEach(function(t){e.find(t.id).catch(g.WapDrop,function(){})})}},{key:"delete",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),delete this.checksum}},{key:"sync",value:function(e){if(!e||this.checksum!==e)return this.findQuery({})}},{key:"handle",value:function(e){if(e.checksum&&this.updateChecksum(e.checksum),e.labels&&e.labels[0]&&e.labels[0].labelUpdates){var t=void 0;return e.labels[0].labelUpdates.forEach(function(e){e.collection.forEach(function(i){"Msg"!==i&&"Chat"!==i||(t=!0);var n=e.id,r=P.default[i].get(e.id);r&&(r.labels&&r.labels.forEach(function(t){f.default.includes(e.labels,t)||(0,U.removeLabelFromCollection)(n,t,i)}),r.labels=e.labels)})}),void(t&&this.trigger("bulk_msg_chat_label_change"))}var i=[],n=[];e.labels.forEach(function(e){"delete"===e.type?i.push(e.label):n.push(e.label)}),this.remove(i.map(function(e){return e.id})),this.add(n,{merge:!0})}},{key:"_findQuery",value:function(){var e=this;return O.default.queryLabels().then(function(t){return t.checksum&&e.updateChecksum(t.checksum),t.labels})}},{key:"_find",value:function(e){return this._findQuery()}},{key:"updateChecksum",value:function(e){this.checksum=e}}]),t}(_.default);V.model=v.default,V.staleCollection=!0,V.resumeOnAvailable=!0,t.default=new V},bjcgjfiffb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(){return{default:arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,type:w.PROPS}}function c(){return{default:arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,type:w.SESSION}}function l(e,t){return{fn:e,deps:t,type:w.DERIVED}}function f(e){return{val:e,type:w.COLLECTION}}function d(e){var t=e.default;return t===M?{}:{default:t}}function h(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"__x_")+e}function p(e,t,i,n){if(!P.default.isObject(i))throw new Error("Invalid Prop/Session definition.");var r={sk:h(t),evt:"change:"+t,attr:n};void 0!==i.default&&(r.default=i.default),e._definition[t]=r;var o=P.default.isFunction(r.default);if(r.default&&!o){if(Array.isArray(r.default))throw new Error("Do not return mutable types as default values as they are shared. Type: Array provided.");if(P.default.isObject(r.default))throw new Error("Do not return mutable types as default values as they are shared. Type: $FlowFixMeObjectType provided.")}var a=r.sk;Object.defineProperty(e,t,{set:function(e){this.set(t,e)},get:function(){var e=this[a];return e!==C?e:o?this[a]=r.default():r.default}})}function g(e,t,i){var n=h(t),r=i.fn;e._definition[t]=e._derived[t]={sk:n,evt:"change:"+t,attr:S.DERIVED,fn:r,deps:i.deps},Object.defineProperty(e,t,{get:function(){var e=this[n];if(e!==C)return e;var t=r.call(this);return e!==t&&(this[n]=t),t},set:function(){throw new TypeError("'"+t+"' is a derived property, it can't be set directly.")}})}function y(e){var t=[];for(var i in e)t.push([i,e[i]]);return t}function v(e){for(var t={},i=Object.getPrototypeOf({}),n=e;(n=Object.getPrototypeOf(n))&&n!==i;)Object.getOwnPropertyNames(n).forEach(function(e){e in t||(t[e]=n[e])});return t}function b(e){var t=new e({},{_internalInitializationDoNotUse:!0}),i={name:e.name||"Unknown",props:{},session:{},derived:{},collections:{},isIdType:e.isIdType};e.Collection&&(i.Collection=e.Collection),e.idClass&&(i.idClass=e.idClass),e.idWhitelist&&(i.idWhitelist=e.idWhitelist);var n=new Set(["constructor"]),r=new Set(["collection","parent","__changes","__fired"]);y(t).forEach(function(t){var o=O(t,2),a=o[0],s=o[1];if(!r.has(a))switch(s.type){case w.PROPS:i.props[a]=d(s);break;case w.SESSION:i.session[a]=d(s);break;case w.DERIVED:i.derived[a]=P.default.omit(s,"type"),n.add(s.fn.name);break;case w.COLLECTION:i.collections[a]=s.val;break;default:throw new Error("Invalid defineModel Class type for "+e.name+":"+a+".")}});var o=v(t);return n.forEach(function(e){delete o[e]}),Object.assign(i,o),i}function _(e,t){return r({},t,function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),t}(e))[t]}function m(e,t){var i=t.name;delete t.name;var n=_(e,i),r=n.prototype,o=r.__props=[],a=r.__session=[],s=r.__derived=[],u=r._collections={},c=r._definition={},l=r._derived={},f=["props","session","derived","collections"];P.default.forOwn(t.props,function(e,t){o.push(t),p(r,t,e,S.PROP)}),P.default.forOwn(t.session,function(e,t){a.push(t),p(r,t,e,S.SESSION)}),P.default.forOwn(t.derived,function(e,t){s.push(t),g(r,t,e)}),P.default.forOwn(t.collections,function(e,t){u[t]=e}),P.default.assign(r,P.default.omit(t,f));var d=o.concat(a),h=d.length;Object.defineProperties(r,{attributes:{get:function(){for(var e={},t=0;t<h;++t)e[d[t]]=this[d[t]];return e}},isState:{get:function(){return!0},set:function(){throw new Error("attempt to set isState")}}});for(var y={},v=0;v<h;v++){var b=d[v];"default"in c[b]&&(y[b]=C)}if(P.default.isEmpty(y)||(r.__defaults=y),s.length){var m=[],O={},E={};P.default.forEach(l,function(e,t){E[t]=!0,P.default.forEach(e.deps,function(e){E[e]=!0,(O[e]||(O[e]=[])).push(t),m.push([t,e])})}),m.length&&(r._deps=O,r._topo=j.default.array(P.default.keys(E),m).reverse())}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.NO_DEFAULT_VALUE=t.Attr=t.INIT=void 0;var O=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.prop=u,t.session=c,t.derived=l,t.collection=f,t.convert=b,t.stateExtend=m;var E=i("hbhijdici"),P=n(E),T=i("baejaciba"),j=n(T),C=t.INIT={sentinel:"INIT DERIVED PROP"},S=t.Attr={PROP:"PROP",SESSION:"SESSION",DERIVED:"DERIVED"},M=t.NO_DEFAULT_VALUE=Symbol("NO_DEFAULT_VALUE"),w={PROPS:"Props",SESSION:"Session",DERIVED:"Derived",COLLECTION:"Collection"}},bjfecgfdgj:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("cajijabhgb"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(c),f=i("cgcgbfbffj"),d=n(f),h=i("djegeegcbf"),p=n(h),g=i("ccaaiecfib"),y=n(g),v=i("bdiiahhjbe"),b=n(v),_=i("dghggcieid"),m=n(_),O=i("chajfbfiga"),E=n(O),P=i("hbhijdici"),T=n(P),j=i("hjbbdjjdf"),C=100,S=36,M=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.dirty=!1,e._throttledSync=T.default.throttle(function(e){e.sync()},S,{leading:!1}),e.listenTo(e,"change:weight change:length",T.default.debounce(e._sortTrimScale,C)),e}return a(t,e),s(t,[{key:"_sortTrimScale",value:function(){var e=this.length;if(e){this.sort(),e>S&&this.remove(this.models.slice(S));var t=this.head(),i=this.last();t&&i&&t.weight<10&&i.weight>.01||this.forEach(function(t,i){t.weight=1+(e-i)/e*3})}}},{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.dirty=!1,this._throttledSync.cancel()}},{key:"sync",value:function(){var e=this;return this.findQuery({},{set:!0}).finally(function(){e.dirty=!1}).catch(l.WapDrop,j.isString,function(){})}},{key:"_findQuery",value:function(){return y.default.supportsFeature(y.default.F.RECENT_EMOJI_SYNC)?E.default.recentEmojiQuery(this.dirty?this.toArray():void 0).then(function(e){return Array.isArray(e)?(e.forEach(function(e){e.id=p.default.normalizeEmoji(e.id)}),Promise.resolve(e)):(b.default.error("models:recentEmoji:findQuery error",e)(),Promise.reject("recent emoji fetch error"))}):Promise.reject("gk recent emoji sync unsupported")}},{key:"throttledSync",value:function(){y.default.supportsFeature(y.default.F.RECENT_EMOJI_SYNC)&&(b.default.log("models:RecentEmoji:throttledSync dirty: "+String(this.dirty))(),this._throttledSync(this))}},{key:"increment",value:function(e){var t=p.default.skinToneEmojis[e]||e;this.get(t)||this.add({id:t,weight:0}),this.forEach(function(e){var i=e.weight;e.id===t?i+=1:i*=.9,e.weight=Math.round(1e3*i)/1e3}),this.dirty=!0,this.throttledSync()}}]),t}(d.default);M.cachePolicy={id:"recent_emoji_collection",policy:f.CACHE_POLICY.LOAD,delay:2e3},M.comparator=function(e,t){return e.weight>t.weight?-1:1},M.model=m.default,t.default=new M},bjgdagjjci:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return(0,T.isNumber)(e)&&e>=-90&&e<=90}function u(e){return(0,T.isNumber)(e)&&e>=-180&&e<=180}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},f=i("dcaifjegcg"),d=n(f),h=i("djheacfeif"),p=n(h),g=i("bjebjijbfc"),y=n(g),v=i("bjigbaghc"),b=n(v),_=i("dhigahgdjb"),m=n(_),O=i("jccfhaecf"),E=n(O),P=i("dfdhiegfdi"),T=i("hjbbdjjdf"),j=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,f.prop)(),n.msg=(0,f.prop)(),n.lat=(0,f.prop)(),n.lng=(0,f.prop)(),n.accuracy=(0,f.prop)(),n.speed=(0,f.prop)(),n.degrees=(0,f.prop)(),n.sequence=(0,f.prop)(),n.comment=(0,f.prop)(),n.expiration=(0,f.prop)(),n.lastUpdated=(0,f.prop)(),n.contact=(0,f.session)(),n.expireTimerId=(0,f.session)(),n.disabled=(0,f.session)(!1),n.isMe=(0,f.derived)(n._isMe,["id"]),n.valid=(0,f.derived)(n._valid,["lat","lng"]),a=i,o(n,a)}return a(t,e),c(t,[{key:"_isMe",value:function(){return this.id.equals(b.default.me)}},{key:"_valid",value:function(){return s(this.lat)&&u(this.lng)}},{key:"initialize",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.addChild("contact",m.default.gadd(this.id)),(0,P.addLiveLocation)(this.contact,this),this.listenTo(this,"change:expiration",this._setExpireTimer),this._setExpireTimer()}},{key:"delete",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this._disableMsg(),(0,P.removeLiveLocation)(this.contact,this),this._clearExpireTimer()}},{key:"remainingTime",value:function(){return this.expiration-y.default.globalUnixTime()}},{key:"elapsedTime",value:function(){return y.default.globalUnixTime()-this.lastUpdated}},{key:"disable",value:function(){this.disabled=!0}},{key:"_disableMsg",value:function(){var e=this.msg;e&&(e.shareDuration=y.default.globalUnixTime()-e.t-1)}},{key:"_setExpireTimer",value:function(){if(this.expiration)return this.remainingTime()<=0?void this._expire():void(this.expireTimerId=p.default.setGlobalTimeout(this._expire.bind(this),1e3*this.expiration,this.expireTimerId))}},{key:"_clearExpireTimer",value:function(){p.default.clearTimeout(this.expireTimerId),this.expireTimerId=null}},{key:"_expire",value:function(){this.disable()}}]),t}(d.default);j.Proxy="liveLocationParticipant",j.idClass=E.default,t.default=(0,f.defineModel)(j)},bjigbaghc:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){return S}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mcc,i=e.mnc;t&&"string"==typeof t&&(t=parseInt(t,10)),i&&"string"==typeof i&&(i=parseInt(i,10)),T.default.Global.set({mcc:t||null,mnc:i||null,webcPhoneDeviceManufacturer:e.device_manufacturer||null,webcPhoneDeviceModel:e.device_model||null,webcPhoneOsBuildNumber:e.os_build_number||null,webcPhoneOsVersion:e.os_version||null,webcPhoneAppVersion:e.wa_version||null})}Object.defineProperty(t,"__esModule",{value:!0}),t.PLATFORMS=void 0;var c=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();t.getPlatformTypeForLastSession=s;var f=i("hbhijdici"),d=n(f),h=i("dcaifjegcg"),p=n(h),g=i("eadfaddcj"),y=n(g),v=i("ccaaiecfib"),b=n(v),_=i("fffdgbfji"),m=n(_),O=i("bdiiahhjbe"),E=n(O),P=i("bfbggcdbfb"),T=n(P),j=i("bebehddcbc"),C=n(j),S=void 0,M=t.PLATFORMS={ANDROID:"android",BB:"bb",BBX:"bbx",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",S40:"s40",SMBA:"smba",SMBI:"smbi",SYMBIAN:"symbian",WP7:"wp7"},w=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,h.prop)(),n.ref=(0,h.prop)(),n.refTTL=(0,h.prop)(),n.refId=(0,h.prop)(),n.wid=(0,h.prop)(),n.connected=(0,h.prop)(),n.me=(0,h.prop)(),n.protoVersion=(0,h.prop)(),n.clientToken=(0,h.prop)(),n.serverToken=(0,h.prop)(),n.secret=(0,h.prop)(),n.isResponse=(0,h.prop)(),n.battery=(0,h.prop)(),n.plugged=(0,h.prop)(),n.lc=(0,h.prop)(),n.lg=(0,h.prop)(),n.locales=(0,h.prop)(),n.is24h=(0,h.prop)(),n.platform=(0,h.prop)(),n.phone=(0,h.prop)(),n.tos=(0,h.prop)(),n.smbTos=(0,h.prop)(0),n.pushname=(0,h.prop)(),n.blockStoreAdds=(0,h.session)(!1),n.refExpiry=(0,h.derived)(n._refExpiry,["ref","refTTL"]),n.locale=(0,h.derived)(n._locale,["lg","lc"]),n.localesList=(0,h.derived)(n._localesList,["locales","lg","lc"]),n.allLocales=(0,h.derived)(n._allLocales,["localesList"]),n.allLanguages=(0,h.derived)(n._allLanguages,["localesList"]),n.platformField=(0,h.derived)(n._platformField,["platform"]),n.tosShowCallNotification=(0,h.derived)(n._tosShowCallNotification,["tos"]),n.isSMB=(0,h.derived)(n._isSMB,["platform"]),a=i,o(n,a)}return a(t,e),l(t,[{key:"_refExpiry",value:function(){return Date.now()+this.refTTL}},{key:"_locale",value:function(){return this.formatLocale(this.lg,this.lc)}},{key:"_localesList",value:function(){return this.locales&&this.locales.length?this.locales.split(",").map(function(e){var t=e.split("-"),i=c(t,2),n=i[0],r=i[1];return n?[n,r]:null}).filter(function(e){return!!e}):this.lg?[[this.lg,this.lc]]:[]}},{key:"_allLocales",value:function(){var e=this;return d.default.uniq(this.localesList.map(function(t){var i=c(t,2),n=i[0],r=i[1];return e.formatLocale(n,r)}))}},{key:"_allLanguages",value:function(){return d.default.uniq(this.localesList.map(function(e){var t=c(e,2),i=t[0];t[1];return i}))}},{key:"_platformField",value:function(){return"wp7"===this.platform?T.default.PLATFORM_TYPE.WP:this.platform?T.default.PLATFORM_TYPE[this.platform.toUpperCase()]||T.default.PLATFORM_TYPE.UNKNOWN:T.default.PLATFORM_TYPE.UNKNOWN}},{key:"_tosShowCallNotification",value:function(){return this.tos<2}},{key:"_isSMB",value:function(){return this.platform===M.SMBA||this.platform===M.SMBI}},{key:"initialize",value:function(){var e=this;p.default.prototype.initialize.call(this),this.listenTo(this,"change:locale",function(e,t){m.default.setLocale(t,y.default.L10N_PRIORITY.PHONE)}),this.listenTo(this,"change:plugged",d.default.debounce(function(){T.default.Global.webcPhoneCharging=e.plugged},5e3,{leading:!0})),this.listenTo(this,"change:phone",function(){u(e.phone)}),this.listenTo(this,"change:me",this.updateVoipAvailability),this.listenTo(b.default,b.default.FEATURE_CHANGE_EVENT,this.updateVoipAvailability),this.listenTo(this,"change:platform",this.handlePlatformChange)}},{key:"delete",value:function(){C.default.setPushname(),C.default.setVersion(),this.clear()}},{key:"canSetMyPushname",value:function(){return!this.isSMB}},{key:"updateVoipAvailability",value:function(){var e=i("bhgjacgcdd").default;(b.default.supportsFeature(b.default.F.VOIP_INDIVIDUAL_OUTGOING)||b.default.supportsFeature(b.default.F.VOIP_INDIVIDUAL_INCOMING))&&(this.me?e.init():e.cleanup())}},{key:"handlePlatformChange",value:function(){E.default.log("Conn: platform change: "+this.platform)(),this.platform&&(S=C.default.getLastMobilePlatform(),C.default.setLastMobilePlatform(this.platform))}},{key:"formatLocale",value:function(e,t){return e?t?e.toLowerCase()+"-"+t.toUpperCase():e.toLowerCase():null}}]),t}(p.default);w.Proxy="conn";var k=(0,h.defineModel)(w);t.default=new k({id:"1"})},caedaejadb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("cajijabhgb"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(c),f=i("eadfaddcj"),d=n(f),h=i("cbcbdjdah"),p=n(h),g=i("biecbbiiee"),y=n(g),v=i("cgcgbfbffj"),b=n(v),_=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.hasLinkBefore=!0,a=i,o(n,a)}return a(t,e),s(t,[{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.stopListening(),this.reset()}},{key:"queryLinks",value:function(e,t){var i=this;if(t)return this.queryLinkBefore?this.queryLinkBefore:(this.queryLinkBefore=y.default.queryMedia(t.id.remote,d.default.MEDIA_QUERY_LIMIT,"before",t.id,"url").then(function(e){return(!e||e.length<d.default.MEDIA_QUERY_LIMIT)&&(i.hasLinkBefore=!1),i.add(e,{at:0}),i.createLinksAndAddMsgs(e),{length:e.length}}).catch(l.WapDrop,l.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryLinkBefore=null,i.trigger("query_link_before")}),this.trigger("query_link_before"),this.queryLinkBefore);var n=e.msgs.getModelsArray();if(0===this.length){if(!n||0===n.length)return this.hasLinkBefore=!1,new Promise(function(e){e({eof:!0})});this.add(n.filter(function(e){return e.getLinks().length>0}),{at:0}),this.createLinksAndAddMsgs(n)}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasLinkBefore=!1,new Promise(function(e){e({eof:!0})});if(this.length<=2*d.default.MEDIA_QUERY_LIMIT){var r=0===this.length?e.msgs.head():this.head();return this.queryLinks(e,r)}return new Promise(function(e){e({eof:!1})})}},{key:"createLinksAndAddMsgs",value:function(e){var t=this,i=[];Promise.loop(function(t,n,r){e.length===r&&t();var o=e[r];o.getLinks().length&&i.push(o)}).then(function(){t.add(i),t.trigger("query_link_before")})}}]),t}(b.default);_.model=p.default,_.comparator=function(e,t){return e.t-t.t},t.default=_},cbcbdjdah:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){return new be(e)}function c(e,t,i){var n={ack:0,id:new z.default({id:"product_inquiry",remote:t,fromMe:!0}),from:t,t:T.default.globalUnixTime(),type:h.MSG_TYPE.PRODUCT,title:e.name,description:e.description,businessOwnerJid:t.toString({legacy:!0}),productId:e.id.toString(),url:e.url,productImageCount:e.productImageCollection.length,body:i.preview&&i.preview._b64,currencyCode:e.currency,priceAmount1000:e.priceAmount1000},r=u(n);return r.mediaData.set(i),r}Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE=void 0;var l=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},h=i("eadfaddcj");Object.defineProperty(t,"TYPE",{enumerable:!0,get:function(){return h.MSG_TYPE}}),t.createProductInquiry=c;var p=i("hbhijdici"),g=r(p),y=i("ddgbhifaji"),v=n(y),b=i("dcaifjegcg"),_=r(b),m=i("daffbcegjj"),O=r(m),E=r(h),P=i("bjebjijbfc"),T=r(P),j=i("gbfffciea"),C=r(j),S=i("bjigbaghc"),M=r(S),w=i("bjgiedaj"),k=r(w),A=i("djegeegcbf"),I=r(A),L=i("ccaaiecfib"),R=r(L),N=i("dbcedfihd"),D=n(N),F=i("bdiiahhjbe"),G=r(F),U=i("bffjfbgbg"),x=r(U),Y=i("bfbggcdbfb"),B=r(Y),V=i("bfgbdiffgd"),q=r(V),W=i("bhggeigghg"),H=r(W),K=i("ccgjijjbbj"),z=r(K),Q=i("ccbagdhfbb"),J=n(Q),X=i("ebggjhghhi"),Z=n(X),$=i("jccfhaecf"),ee=r($),te=i("cfejjfjhca"),ie=r(te),ne=i("cgfjebhhej"),re=r(ne),oe=i("djbfhebjhe"),ae=r(oe),se=i("hciaejfjd"),ue=r(se),ce=i("cijheiibhg"),le=r(ce),fe=i("chhhffajfi"),de=i("bcjidabgad"),he=i("hjbbdjjdf"),pe=i("bdgehigfig"),ge=i("cefjgcjhgf"),ye=i("dffjhcaahi"),ve=function(e){function t(){var e,i,n,r;o(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,b.prop)(),n.body=(0,b.prop)(),n.type=(0,b.prop)(),n.subtype=(0,b.prop)(),n.t=(0,b.prop)(),n.notifyName=(0,b.prop)(),n.from=(0,b.prop)(),n.to=(0,b.prop)(),n.author=(0,b.prop)(),n.self=(0,b.prop)("in"),n.ack=(0,b.prop)(),n.invis=(0,b.prop)(),n.isNewMsg=(0,b.prop)(),n.star=(0,b.prop)(!1),n.recvFresh=(0,b.prop)(),n.caption=(0,b.prop)(),n.clientUrl=(0,b.prop)(),n.loc=(0,b.prop)(),n.lat=(0,b.prop)(),n.lng=(0,b.prop)(),n.isLive=(0,b.prop)(),n.accuracy=(0,b.prop)(),n.speed=(0,b.prop)(),n.degrees=(0,b.prop)(),n.comment=(0,b.prop)(),n.sequence=(0,b.prop)(),n.shareDuration=(0,b.prop)(),n.finalLat=(0,b.prop)(),n.finalLng=(0,b.prop)(),n.finalAccuracy=(0,b.prop)(),n.finalThumbnail=(0,b.prop)(),n.finalSpeed=(0,b.prop)(),n.finalDegrees=(0,b.prop)(),n.finalTimeOffset=(0,b.prop)(),n.directPath=(0,b.prop)(),n.mimetype=(0,b.prop)(),n.duration=(0,b.prop)(),n.filehash=(0,b.prop)(),n.uploadhash=(0,b.prop)(),n.size=(0,b.prop)(),n.filename=(0,b.prop)(),n.streamingSidecar=(0,b.prop)(),n.mediaKey=(0,b.prop)(),n.pageCount=(0,b.prop)(),n.isGif=(0,b.prop)(),n.gifAttribution=(0,b.prop)(),n.streamable=(0,b.prop)(),n.width=(0,b.prop)(),n.height=(0,b.prop)(),n.canonicalUrl=(0,b.prop)(),n.matchedText=(0,b.prop)(),n.thumbnail=(0,b.prop)(),n.richPreviewType=(0,b.prop)(),n.title=(0,b.prop)(),n.description=(0,b.prop)(),n.businessOwnerJid=(0,b.prop)(),n.productId=(0,b.prop)(),n.currencyCode=(0,b.prop)(),n.priceAmount1000=(0,b.prop)(),n.retailerId=(0,b.prop)(),n.url=(0,b.prop)(),n.productImageCount=(0,b.prop)(),n.pseudoReply=(0,b.prop)(),n.recipients=(0,b.prop)(),n.broadcast=(0,b.prop)(),n.quotedMsg=(0,b.prop)(),n.quotedStanzaID=(0,b.prop)(),n.quotedRemoteJid=(0,b.prop)(),n.quotedParticipant=(0,b.prop)(),n.mentionedJidList=(0,b.prop)(),n.multicast=(0,b.prop)(),n.urlText=(0,b.prop)(),n.urlNumber=(0,b.prop)(),n.clearMedia=(0,b.prop)(),n.vcardList=(0,b.prop)(),n.protocolMessageKey=(0,b.prop)(),n.templateParams=(0,b.prop)(),n.textColor=(0,b.prop)(),n.backgroundColor=(0,b.prop)(),n.font=(0,b.prop)(),n.isForwarded=(0,b.prop)(!1),n.forwardingScore=(0,b.prop)(),n.labels=(0,b.prop)(),n.currency=(0,b.prop)(),n.amount1000=(0,b.prop)(),n.receiverJid=(0,b.prop)(),n.paymentStatus=(0,b.prop)(),n.paymentNoteMsg=(0,b.prop)(),n.paymentTransactionTimestamp=(0,b.prop)(),n.paymentRequestMessageKey=(0,b.prop)(),n._currencyCodeIso4217=(0,b.prop)(),n._paymentRequestFrom=(0,b.prop)(),n._paymentExpiryTimestamp=(0,b.prop)(),n.promises=(0,b.session)(function(){return{}}),n.local=(0,b.session)(),n.search=(0,b.session)(),n.msgChunk=(0,b.session)(),n.phoneUploading=(0,b.session)(),n.startOfDay=(0,b.session)(),n.startOfDaySkew=(0,b.session)(),n._quotedMsgObj=(0,b.session)(),n.isQuotedMsgAvailable=(0,b.session)(!0),n.senderObj=(0,b.session)(),n.mediaData=(0,b.session)(),n.inviteCode=(0,b.prop)(),n.inviteCodeExp=(0,b.prop)(),n.inviteGrp=(0,b.prop)(),n.inviteGrpName=(0,b.prop)(),n.inviteGrpJpegThum=(0,b.prop)(),n._links=(0,b.session)(function(){return[]}),n.linksIndexParsed=(0,b.session)(0),n.chat=(0,b.derived)(n._chat),n.isFutureproof=(0,b.derived)(n._isFutureproof,["type","subtype"]),n.isGroupMsg=(0,b.derived)(n._isGroupMsg),n.isStatusV3=(0,b.derived)(n._isStatusV3),n.isPSA=(0,b.derived)(n._isPSA),n.isProductInquiry=(0,b.derived)(n._isProductInquiry),n.statusV3TextBg=(0,b.derived)(n._statusV3TextBg),n.isSentByMe=(0,b.derived)(n._isSentByMe),n.isSentByMeFromWeb=(0,b.derived)(n._isSentByMeFromWeb,["isUserCreatedType"]),n.isNotification=(0,b.derived)(n._isNotification,["type"]),n.isGroupNotification=(0,b.derived)(n._isGroupNotification,["type"]),n.isBroadcastNotification=(0,b.derived)(n._isBroadcastNotification,["type"]),n.isBizNotification=(0,b.derived)(n._isBizNotification,["type","subtype"]),n.isProduct=(0,b.derived)(n._isProduct,["type"]),n.isMedia=(0,b.derived)(n._isMedia,["type"]),n.isDoc=(0,b.derived)(n._isDoc,["type"]),n.isMMS=(0,b.derived)(n._isMMS,["type"]),n.isRevoked=(0,b.derived)(n._isRevoked,["type"]),n.numTimesForwarded=(0,b.derived)(n._numTimesForwarded,["isForwarded","forwardingScore"]),n.isFrequentlyForwarded=(0,b.derived)(n._isFrequentlyForwarded,["numTimesForwarded"]),n.eventType=(0,b.derived)(n._eventType,["type","invis","isNewMsg"]),n.sender=(0,b.derived)(n._sender),n.text=(0,b.derived)(n._text,["type","body","caption","comment","isLive","paymentNoteMsg"]),n.containsEmoji=(0,b.derived)(n._containsEmoji,["text"]),n.isFailed=(0,b.derived)(n._isFailed,["isSentByMe","ack"]),n.vcard=(0,b.derived)(n._vcard,["type","body"]),n.isUnsentMedia=(0,b.derived)(n._isUnsentMedia,["ack","isMMS","isSentByMe"]),n.dir=(0,b.derived)(n._dir,["type","text","subtype"]),n.rtl=(0,b.derived)(n._rtl,["type","text","subtype"]),n.linkPreview=(0,b.derived)(n._linkPreview,["matchedText","body","title","description"]),n.isGroupsV4InviteExpired=(0,b.derived)(n._isGroupsV4InviteExpired,["type","inviteCode","inviteCodeExp"]),n.isPersistent=(0,b.derived)(n._isPersistent),n.isUnreadType=(0,b.derived)(n._isUnreadType,["type"]),n.isUserCreatedType=(0,b.derived)(n._isUserCreatedType,["type"]),n.initialPageSize=(0,b.derived)(n._initialPageSize,["isFrequentlyForwarded"]),r=i,a(n,r)}return s(t,e),f(t,[{key:"_chat",value:function(){return H.default.Chat.get(this.id.remote)}},{key:"_isFutureproof",value:function(){return this.type===h.MSG_TYPE.UNKNOWN||this.type===h.MSG_TYPE.PAYMENT&&"futureproof"===this.subtype}},{key:"_isGroupMsg",value:function(){return ee.default.isGroup(this.from)||ee.default.isGroup(this.to)}},{key:"_isStatusV3",value:function(){return ee.default.isStatusV3(this.id.remote)}},{key:"_isPSA",value:function(){return ee.default.isPSA(this.id.remote)}},{key:"_isProductInquiry",value:function(){return this.pseudoReply||this.id&&this.id.id===E.default.PRODUCT_INQUIRY_TYPE}},{key:"_statusV3TextBg",value:function(){if(!this.isStatusV3)return null;var e=this.backgroundColor;return e?"rgba("+(e>>16&255)+", "+(e>>8&255)+", "+(255&e)+", "+(e>>24&255)+")":null}},{key:"_isSentByMe",value:function(){return"in"!==this.id.self&&!this.isNotification&&ee.default.equals(this.from,M.default.me)}},{key:"_isSentByMeFromWeb",value:function(){return this.id.fromMe&&this.local&&this.isUserCreatedType}},{key:"_isNotification",value:function(){switch(this.type){case h.MSG_TYPE.GROUP_NOTIFICATION:case h.MSG_TYPE.GP2:case h.MSG_TYPE.BROADCAST_NOTIFICATION:case h.MSG_TYPE.NOTIFICATION:case h.MSG_TYPE.NOTIFICATION_TEMPLATE:case h.MSG_TYPE.E2E_NOTIFICATION:case h.MSG_TYPE.CALL_LOG:return!0;default:return!1}}},{key:"_isGroupNotification",value:function(){switch(this.type){case h.MSG_TYPE.GROUP_NOTIFICATION:case h.MSG_TYPE.GP2:return!0;default:return!1}}},{key:"_isBroadcastNotification",value:function(){return this.type===h.MSG_TYPE.BROADCAST_NOTIFICATION}},{key:"_isBizNotification",value:function(){if(this.type===h.MSG_TYPE.NOTIFICATION_TEMPLATE)switch(this.subtype){case"verified_initial_unknown":case"verified_initial_low":case"verified_initial_high":case"verified_transition_any_to_none":case"verified_transition_any_to_high":case"verified_transition_high_to_low":case"verified_transition_high_to_unknown":case"verified_transition_unknown_to_low":case"verified_transition_low_to_unknown":case"verified_transition_none_to_low":case"verified_transition_none_to_unknown":case"biz_verified_transition_top_to_bottom":case"biz_verified_transition_bottom_to_top":case"biz_intro_top":case"biz_intro_bottom":case"biz_name_change":case"biz_move_to_consumer_app":case"biz_two_tier_migration_top":case"biz_two_tier_migration_bottom":return!0;default:return!1}return!1}},{key:"_isProduct",value:function(){return"product"===this.type}},{key:"_isMedia",value:function(){return["image","video","audio","product"].indexOf(this.type)>-1}},{key:"_isDoc",value:function(){return"document"===this.type}},{key:"_isMMS",value:function(){return J.typeIsMMS(this.type)}},{key:"_isRevoked",value:function(){return this.type===h.MSG_TYPE.REVOKED}},{key:"_numTimesForwarded",value:function(){return this.forwardingScore?this.forwardingScore||0:this.isForwarded?1:0}},{key:"_isFrequentlyForwarded",value:function(){return this.numTimesForwarded>=E.default.FREQUENTLY_FORWARDED_SENTINEL}},{key:"_eventType",value:function(){if(!this.isNewMsg)return"i";var e=this.eventTypeFromMsgType();return this.invis?"i"===e?"i":"n":e}},{key:"_sender",value:function(){return this.isSentByMe?this.from:this.isGroupMsg||this.isStatusV3?this.author:this.from}},{key:"_text",value:function(){switch(this.type){case h.MSG_TYPE.CHAT:return this.body;case h.MSG_TYPE.IMAGE:case h.MSG_TYPE.VIDEO:return this.caption;case h.MSG_TYPE.LOCATION:return this.isLive?this.comment:void 0;case h.MSG_TYPE.PAYMENT:var e=this.paymentNoteMsg;return e?e.body:void 0;case h.MSG_TYPE.GROUPS_V4_INVITE:return this.comment;case h.MSG_TYPE.PRODUCT:return this.getProductInfoText();default:return}}},{key:"_containsEmoji",value:function(){var e=this.text;return!!e&&I.default.containsEmoji(e)}},{key:"_isFailed",value:function(){return this.isSentByMe&&this.ack<0}},{key:"_vcard",value:function(){if(this.type===h.MSG_TYPE.VCARD)try{return re.default.parse(this.body)}catch(e){return}}},{key:"_isUnsentMedia",value:function(){return this.ack<1&&this.isMMS&&this.isSentByMe}},{key:"_dir",value:function(){return this.type===h.MSG_TYPE.VCARD?this.subtype?O.default.dir(this.subtype):void 0:this.text?O.default.dir(this.text):void 0}},{key:"_rtl",value:function(){return this.type===h.MSG_TYPE.VCARD?!!this.subtype&&"rtl"===O.default.dir(this.subtype):!!this.text&&"rtl"===O.default.dir(this.text)}},{key:"_linkPreview",value:function(){return(0,he.isString)(this.matchedText)&&(!g.default.isEmpty(this.title)||!g.default.isEmpty(this.description))&&this.body.indexOf(this.matchedText)>-1}},{key:"_isGroupsV4InviteExpired",value:function(){if(this.type!==E.default.MSG_TYPE.GROUPS_V4_INVITE)return!1;if(!this.inviteCode)return!0;var e=(new Date).getTime()/1e3;return parseInt(e,10)>=parseInt(this.inviteCodeExp,10)}},{key:"_isPersistent",value:function(){return this.type===h.MSG_TYPE.E2E_NOTIFICATION&&"encrypt"===this.subtype}},{key:"_isUnreadType",value:function(){return[h.MSG_TYPE.CHAT,h.MSG_TYPE.IMAGE,h.MSG_TYPE.VIDEO,h.MSG_TYPE.AUDIO,h.MSG_TYPE.PTT,h.MSG_TYPE.DOCUMENT,h.MSG_TYPE.VCARD,h.MSG_TYPE.LOCATION,h.MSG_TYPE.CIPHERTEXT,h.MSG_TYPE.OVERSIZED,h.MSG_TYPE.MULTI_VCARD,h.MSG_TYPE.REVOKED,h.MSG_TYPE.UNKNOWN,h.MSG_TYPE.STICKER,h.MSG_TYPE.PRODUCT,h.MSG_TYPE.GROUPS_V4_INVITE].indexOf(this.type)>=0}},{key:"_isUserCreatedType",value:function(){return[h.MSG_TYPE.PROTOCOL,h.MSG_TYPE.CHAT,h.MSG_TYPE.LOCATION,h.MSG_TYPE.VCARD,h.MSG_TYPE.MULTI_VCARD,h.MSG_TYPE.IMAGE,h.MSG_TYPE.VIDEO,h.MSG_TYPE.AUDIO,h.MSG_TYPE.PTT,h.MSG_TYPE.DOCUMENT,h.MSG_TYPE.STICKER,h.MSG_TYPE.PRODUCT,h.MSG_TYPE.GROUPS_V4_INVITE].indexOf(this.type)>=0}},{key:"_initialPageSize",value:function(){return this.isFrequentlyForwarded?E.default.FREQUENTLY_FORWARDED_INITIAL_PAGE_SIZE:E.default.INITIAL_PAGE_SIZE}},{key:"initialize",value:function(){var e=this;if(d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.sender)this.addChild("senderObj",H.default.Contact.gadd(this.sender));else switch(this.type){case h.MSG_TYPE.NOTIFICATION:case h.MSG_TYPE.NOTIFICATION_TEMPLATE:case h.MSG_TYPE.GROUP_NOTIFICATION:case h.MSG_TYPE.GP2:case h.MSG_TYPE.BROADCAST_NOTIFICATION:case h.MSG_TYPE.E2E_NOTIFICATION:case h.MSG_TYPE.CALL_LOG:case h.MSG_TYPE.PROTOCOL:break;default:G.default.log("msg:msg with no sender id:"+this.id.toString()+", from:"+this.from.toString()+", author:"+(this.author&&this.author.toString())+", type:"+this.type)()}g.default.forEach(this.mentionedJidList,function(e){return H.default.Contact.gadd(e)});var i=void 0,n=this.getCollection();(i=n.preAck[this.id])&&(G.default.log("Msg:initialize updating msg with out of order ack",i)(),this.updateAck(i.ack),delete n.preAck[this.id]),this.type===h.MSG_TYPE.CIPHERTEXT&&this.listenToOnce(this,"change:type",this.onCiphertextDecrypted),this._mediaObject=void 0,J.typeIsMMS(this.type)&&(this._createMediaDataChild(),v.registerMsg(this)),this.isSentByMeFromWeb&&(this.promises.sendPromise=Promise.sit("settled").finally(function(){e.promises.sendPromise=null}).endWithControls("settled")),this.isLive&&H.default.LiveLocation.processMsg(this,!1),M.default.isSMB&&(this.addLabelsToCollection(),this.listenTo(this,"change:labels",this.addLabelsToCollection)),q.default.getWebRestoreFromCache()&&this.listenTo(this,"change:ack",this.onAckChange)}},{key:"getLinks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.initialPageSize+1,t=this.text;if(!t)return this._links;if(this.linksIndexParsed>=e)return this._links;var i=(0,fe.firstNCodepoints)(t,e),n=D.findLinks(i,!1,this.sender);if(t.length>e&&n.length>0){var r=n[n.length-1];r.index+(0,fe.numCodepoints)(r.url)===e&&(n=D.findLinks(t,!1,this.sender))}return this.linksIndexParsed=e,this._links=n}},{key:"getGalleryLinks",value:function(){return g.default.uniqBy(this.getLinks(),"href").filter(function(e){return e.isHttp})}},{key:"getSuspiciousLinks",value:function(){return this.getLinks().filter(function(e){return e.suspiciousCharacters&&e.suspiciousCharacters.size})}},{key:"addLabelsToCollection",value:function(){(0,ue.default)(this.id.toString(),this.labels,"Msg")}},{key:"_createMediaDataChild",value:function(){this.addChild("mediaData",new x.default)}},{key:"hasSymbol",value:function(){return["image","video","audio","ptt","location","vcard","multi_vcard","document","ciphertext","oversized","unknown","call_log","revoked","sticker","payment","groups_v4_invite","product"].indexOf(this.type)>-1}},{key:"mayFail",value:function(){return this.isSentByMe&&this.ack<1}},{key:"isUnsentPhoneMsg",value:function(){return!this.local&&this.isSentByMe&&this.ack<1}},{key:"canReply",value:function(){return this.chat.canSend&&!this.mayFail()&&!this.isNotification&&this.type!==h.MSG_TYPE.UNKNOWN&&this.type!==h.MSG_TYPE.CIPHERTEXT&&this.type!==h.MSG_TYPE.OVERSIZED&&this.type!==h.MSG_TYPE.REVOKED&&R.default.supportsFeature(R.default.F.REPLIES_OUT)}},{key:"canPrivateReply",value:function(){return!this.mayFail()&&!this.isNotification&&this.type!==h.MSG_TYPE.UNKNOWN&&this.type!==h.MSG_TYPE.CIPHERTEXT&&this.type!==h.MSG_TYPE.OVERSIZED&&this.type!==h.MSG_TYPE.REVOKED&&R.default.supportsFeature(R.default.F.REPLIES_OUT)&&!this.isSentByMe&&this.isGroupMsg&&R.default.supportsFeature(R.default.F.PRIVATE_REPLY)}},{key:"canPrivateReplyInRestrictedGrp",value:function(){return!!this.chat.isAnnounceGrpRestrict&&!this.chat.isReadOnly&&R.default.supportsFeature(R.default.F.PRIVATE_REPLY)&&R.default.supportsFeature(R.default.F.REPLIES_OUT)&&!this.mayFail()&&!this.isSentByMe&&!this.isNotification&&this.type!==h.MSG_TYPE.UNKNOWN&&this.type!==h.MSG_TYPE.CIPHERTEXT&&this.type!==h.MSG_TYPE.OVERSIZED&&this.type!==h.MSG_TYPE.REVOKED}},{key:"canForward",value:function(){if(this.type===h.MSG_TYPE.CIPHERTEXT)return!1;if(this.type===h.MSG_TYPE.OVERSIZED)return!1;if(this.type===h.MSG_TYPE.REVOKED)return!1;if(this.type===h.MSG_TYPE.UNKNOWN)return!1;if(this.type===h.MSG_TYPE.PAYMENT)return!1;if(this.type===h.MSG_TYPE.GROUPS_V4_INVITE)return!1;if(this.type===h.MSG_TYPE.LOCATION&&this.isLive)return!1;if(this.ack<1&&this.isSentByMe)return!1;if(this.isMMS){var e=this.mediaData;if(!v.canSendType(e.type))return!1;if(e.mediaStage===x.default.STAGE.ERROR_MISSING)return!1;if(e.mediaStage===x.default.STAGE.ERROR_UNSUPPORTED)return!1;if(this.isUnsentMedia)return!1}return!0}},{key:"canQuickForward",value:function(){return this.canForward()&&!this.isFrequentlyForwarded&&0===this.getSuspiciousLinks().length&&this.type!==E.default.MSG_TYPE.PTT&&this.type!==E.default.MSG_TYPE.STICKER&&(this.isMMS||this.linkPreview||this.type===E.default.MSG_TYPE.LOCATION)}},{key:"canStar",value:function(){return!(this.isNotification||this.isFutureproof||this.type===h.MSG_TYPE.REVOKED||this.ack<1&&this.isSentByMe)}},{key:"isGroupLeave",value:function(){return"gp2"===this.type&&("leave"===this.subtype||"remove"===this.subtype)&&ee.default.equals(g.default.head(this.recipients),M.default.me)}},{key:"isTrusted",value:function(){return!!ee.default.equals(this.sender,M.default.me)||(!(!this.senderObj||!this.senderObj.isMyContact)||(this.isGroupMsg?this.chat.isTrusted():this.chat.notSpam))}},{key:"getWAids",value:function(){return this.type!==h.MSG_TYPE.VCARD?null:re.default.vcardWAids(this.vcard)}},{key:"getVCardThumbnailWAid",value:function(){if(this.type!==h.MSG_TYPE.VCARD)return null;var e=this.getWAids();if(e){var t=re.default.thumbnailWAid(e);return t||(e.length?e[0]:void 0)}}},{key:"getLocObject",value:function(){var e=this.loc;if(e){var t=e.split("\n"),i=l(t,2),n=i[0],r=i[1];return{name:n,addr:void 0===r?null:r}}return null}},{key:"resumeRemoteUpload",value:function(){var e=this;return this.isUnsentPhoneMsg()&&!this.phoneUploading&&((0,pe.sendMsgRecord)(this).then(function(t){"success"!==t&&(e.phoneUploading=!1)}),this.phoneUploading=!0),this.downloadMedia(!0)}},{key:"forceDownloadMedia",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.downloadMedia(!0,e)}},{key:"forceRMR",value:function(){return Promise.reject(new Error("unimplemented forceRMR"))}},{key:"isForcingRMR",value:function(){return!1}},{key:"cancelDownload",value:function(){v.cancelDownloadMsg(this)}},{key:"resumeUpload",value:function(){G.default.assert(this.mediaData.mediaStage===x.default.STAGE.NEED_UPLOAD,"resume-non-need-upload","resumeUpload called while state was "+this.mediaData.mediaStage)(),v.resumeUploadMsg(this)}},{key:"cancelUpload",value:function(){v.cancelUploadMsg(this)}},{key:"logInitialRender",value:function(){var e=this;if(this.isMMS&&this.mediaData&&!this.isStatusV3&&!this._renderEvent){var t=this._renderEvent=new B.default.WebcMediaRender({messageMediaType:this.getWamMediaType(),webcChatType:this.chat.getWebcChatType(),webcChatPosition:this.chat.initialIndex,webcBrowserNetworkType:(0,de.getEffectiveNetworkType)(),webcMessageT:this.t});this.msgChunk===this.chat.msgs&&(t.webcMessageIndex=this.msgChunk.length-this.msgChunk.indexOf(this)-1);var i=function i(){switch(e.mediaData.mediaStage){case x.default.STAGE.INIT:case x.default.STAGE.PREPARING:case x.default.STAGE.FETCHING:case x.default.STAGE.DECRYPTING:case x.default.STAGE.REMOTE_UPLOADING:case x.default.STAGE.REUPLOADING:case x.default.STAGE.UPLOADING:case x.default.STAGE.SENDING:return;case x.default.STAGE.RESOLVED:t.webcMediaStage=B.default.WEBC_MEDIA_STAGE_TYPE.RESOLVED;break;case x.default.STAGE.NEED_POKE:t.webcMediaStage=B.default.WEBC_MEDIA_STAGE_TYPE.NEEDS_RMR;break;default:t.webcMediaStage=B.default.WEBC_MEDIA_STAGE_TYPE.OTHER}e._logStorageEstimate(t).finally(function(){t.commit(),e.stopListening(e.mediaData,"change:mediaStage",i)})};this.listenToAndRun(this.mediaData,"change:mediaStage",i)}}},{key:"downloadMedia",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isRevoked)return Promise.resolve();if(G.default.assert(this.isMMS,"media-fault","downloadMedia called on non-mms msg")(),this.isUnsentPhoneMsg()){var n=this.promises.waitForPhoneUpload;return n||(n=this.promises.waitForPhoneUpload=Z.waitForBBEvent(this.mediaData,"change:mediaStage change:filehash",function(){return!!e.mediaData.filehash&&!e.isUnsentPhoneMsg()}).then(function(){e.promises.waitForPhoneUpload=null})),n.then(function(){return e.downloadMedia(t,i)})}var r=v.downloadMsg(this,t);if(i){var o=performance.now(),a=new B.default.WebcMediaRmr({messageMediaType:this.getWamMediaType(),webcChatType:this.chat.getWebcChatType(),webcChatPosition:this.chat.initialIndex,webcBrowserNetworkType:(0,de.getEffectiveNetworkType)(),webcMessageT:this.t,webcMediaSize:this.size});this.msgChunk===this.chat.msgs&&(a.webcMessageIndex=this.msgChunk.length-this.msgChunk.indexOf(this)-1),r.then(function(){return a.webcMediaRmrT=Math.ceil(performance.now()-o),e._logStorageEstimate(a)}).catch(function(){a.webcMediaRmrT=Math.ceil(performance.now()-o),a.webcMediaRmrError=!0}).finally(function(){return a.commit()})}return r}},{key:"applyUpdate",value:function(e){var t=this;return e.type&&this.type!==e.type&&J.typeIsMMS(e.type)?(this.type!==h.MSG_TYPE.CIPHERTEXT&&G.default.assert(!1,"invalid-type-update","updated "+this.id.toString()+" from "+this.type+" to "+String(e.type))(),this._createMediaDataChild(),v.registerMsgEarly(this,e),v.prepareMsg(this).then(function(){return(0,ye.updateLocal)(t.id,e)}).then(function(){t.set(e)}).catch(function(e){G.default.assert(!1,"preregister-error","error = "+String(e))(e)})):(0,ye.updateLocal)(this.id,e).then(function(){if(t.set(e),t.isLive&&H.default.LiveLocation.processMsg(t,!0),t.paymentTransactionTimestamp){t.getCollection().updateLastTransactionTime(t.id.remote,t.paymentTransactionTimestamp)}}).catch(function(e){G.default.assert(!1,"msg:applyUpdate: failed to update locally")(e)})}},{key:"waitForPrep",value:function(){return J.typeIsMMS(this.type)?v.prepareMsg(this):Promise.resolve()}},{key:"delete",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),H.default.AllStarredMsgs.remove(this),this.isLive&&H.default.LiveLocation.removeMsg(this),this.getCollection().remove(this.id),this.msgChunk&&this.msgChunk.remove(this.id),J.typeIsMMS(this.type)&&v.deregisterMsg(this);var e=H.default.Chat.get(this.id.remote);if(e&&(e.unreadMsgAnchor===this&&(e.unreadMsgAnchor=void 0),e.lastReceivedKey===this.id)){var i=void 0,n=e.getLastReceivedMsg();n&&(i=n.id),(0,ge.setLastReceivedKey)(e.id,i)}}},{key:"quotedMsgObj",value:function(){if(!this.quotedMsg)return null;if(this._quotedMsgObj){var e=this.getCollection();return J.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,e)}var t=!this.quotedParticipant||ee.default.equals(this.quotedParticipant,M.default.me),i=t?"out":"in",n=this.quotedRemoteJid?this.quotedRemoteJid:this.id.remote,r={id:this.quotedStanzaID,from:t?M.default.me:n,to:t?n:M.default.me,self:i,author:this.quotedParticipant,remote:n};if(!(ee.default.isGroup(r.from)||ee.default.isGroup(r.to))&&!ee.default.isStatusV3(n)||ee.default.equals(M.default.me,this.quotedParticipant)||(r.participant=this.quotedParticipant),g.default.assign(r,this.quotedMsg),!r)return r;this._quotedMsgObj=J.createQuotedMsg(r);var o=this.getCollection();return J.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,o)}},{key:"getQuotedMsgAdminGroupJid",value:function(){return!this.quotedMsg&&this.quotedRemoteJid}},{key:"msgContextInfo",value:function(e){var t=g.default.omit(this.toJSON(),["id","t","notifyName","from","to","author","self","ack","invis","isNewMsg","star","recvFresh","recipients","broadcast","quotedMsg","quotedStanzaID","quotedRemoteJid","quotedParticipant","senderObj","multicast"]),i=void 0;return e&&!this.id.remote.equals(e)&&(i=this.id.remote),{quotedMsg:t,quotedParticipant:this.sender,quotedStanzaID:this.id.id,quotedRemoteJid:i}}},{key:"displayName",value:function(e,t){if(!this.sender)return"";if(this.sender.equals(M.default.me))return l10n.t("web_you");var i=this.senderObj,n=e?i.shortName:void 0;if(n)return n;if(i.name)return i.name;var r=t&&this.notifyName?" ~"+this.notifyName:"";return l10n.isRTL()?l10n.embedLTR((0,ae.default)(this.sender))+r:(0,ae.default)(this.sender)+r}},{key:"isQuoted",value:function(e){var t=this.quotedMsgObj();return!!t&&t.sender.equals(e)}},{key:"isMentioned",value:function(e){return g.default.findIndex(this.mentionedJidList,function(t){return t.equals(e)})>-1}},{key:"mentionMap",value:function(){if(!R.default.supportsFeature(R.default.F.MENTIONS_IN))return null;if(!g.default.size(this.mentionedJidList))return null;var e={};return g.default.forEach(this.mentionedJidList,function(t){e["@"+(ee.default.user(t)||"")]=H.default.Contact.gadd(t)}),e}},{key:"updateAck",value:function(e){var t=this.ack;(0,he.isNumber)(e)&&(void 0===t||e>t)?this.ack=e:-1===e&&0===this.ack&&(this.ack=-1,this.phoneUploading=!1)}},{key:"avParams",value:function(){return v.mediaMetadata(this)}},{key:"resend",value:function(){return this.isFailed?(this.ack=0,this.isMMS?this.resumeRemoteUpload():(0,pe.sendMsgRecord)(this)):Promise.resolve()}},{key:"onCiphertextDecrypted",value:function(){if(!this.isStatusV3){var e=this.chat,t=e.msgs.length,i=e.msgs.indexOf(this);-1!==i&&t-i<=10&&C.default.alertNewMsg(this)}}},{key:"onAckChange",value:function(){this.chat&&q.default.getWebRestoreFromCache()&&this.chat.trigger("change:msg:ack")}},{key:"eventTypeFromMsgType",value:function(){var e=this.type,t=this.subtype,i=void 0,n=void 0;return e===h.MSG_TYPE.GP2||e===h.MSG_TYPE.GROUP_NOTIFICATION?"subject"===t?i="n":"add"===t||"invite"===t?(n=g.default.head(this.recipients),i=ee.default.equals(n,M.default.me)?"s":"i"):"remove"===t?(n=g.default.head(this.recipients),i=ee.default.equals(n,M.default.me)?"n":"i"):i="create"===t?"n":"i":i=e===h.MSG_TYPE.BROADCAST_NOTIFICATION||e===h.MSG_TYPE.NOTIFICATION||e===h.MSG_TYPE.E2E_NOTIFICATION?"create"===t?"n":"i":e===h.MSG_TYPE.GROUPS_V4_INVITE&&this.from===M.default.me?"i":e===h.MSG_TYPE.CALL_LOG?"n":this.broadcast||e===h.MSG_TYPE.REVOKED?"i":this.isPSA?2===this.ack?"d":"a":e===h.MSG_TYPE.CIPHERTEXT||e===h.MSG_TYPE.OVERSIZED?"a":e===h.MSG_TYPE.NOTIFICATION_TEMPLATE?"i":"d",i}},{key:"canRevoke",value:function(){return R.default.supportsFeature(R.default.F.REVOKE)&&this.id.fromMe&&this.isUserCreatedType&&(!ee.default.isBroadcast(this.id.remote)||"iphone"===M.default.platform)&&!this.broadcast&&Math.trunc(+new Date/1e3)-this.t<=E.default.REVOKE_WINDOW&&!this.isUnsentPhoneMsg()&&!this.isUnsentMedia}},{key:"revoke",value:function(e){var t=this;J.typeIsMMS(this.type)&&v.deregisterMsg(this),this.chat&&this.chat.removeFromCollection(this);var i=this.getCollection(),n=this.id;this.msgChunk.replaceId(n,e),i.replaceId(n,e);var r={id:e,type:h.MSG_TYPE.REVOKED,body:void 0,caption:void 0,clientUrl:void 0,loc:void 0,lat:void 0,lng:void 0,isLive:void 0,accuracy:void 0,speed:void 0,degrees:void 0,comment:void 0,sequence:void 0,shareDuration:void 0,finalLat:void 0,finalLng:void 0,finalAccuracy:void 0,finalThumbnail:void 0,finalSpeed:void 0,finalDegrees:void 0,finalTimeOffset:void 0,title:void 0,description:void 0,canonicalUrl:void 0,matchedText:void 0,thumbnail:void 0,richPreviewType:void 0,quotedMsg:void 0,quotedStanzaID:void 0,quotedRemoteJid:void 0,quotedParticipant:void 0,mediaData:void 0,mentionedJidList:void 0,vcardList:void 0,star:!1};return(0,ye.updateLocal)(this.id,r).then(function(){if(t.set(r),t.trigger("change:msgKey",{newKey:e,oldKey:n}),t.chat&&t.chat.updateMediasCountOnMsg(t,!0),t.chat&&n.equals(t.chat.lastReceivedKey)&&(t.chat.lastReceivedKey=e),t.isLive&&H.default.LiveLocation.removeMsg(t),ee.default.isBroadcast(n.remote)){var o=J.getBroadcastFanoutKeys(n),a=J.getBroadcastFanoutKeys(e);if(!o||!a||o.length!==a.length)return void G.default.log("cannot fanout revoke: "+String(o)+" "+String(a))(o,a);g.default.zip(o,a).forEach(function(e){var t=i.get(e[0]);t&&t.revoke(e[1])})}})}},{key:"getWamMessageType",value:function(){return this.isStatusV3?B.default.MESSAGE_TYPE.STATUS:this.isGroupMsg?B.default.MESSAGE_TYPE.GROUP:ee.default.isBroadcast(this.id.remote)?B.default.MESSAGE_TYPE.BROADCAST:B.default.MESSAGE_TYPE.INDIVIDUAL}},{key:"getWamMediaType",value:function(){switch(this.type){case h.MSG_TYPE.IMAGE:return B.default.MEDIA_TYPE.PHOTO;case h.MSG_TYPE.VIDEO:return this.mediaData.isGif?B.default.MEDIA_TYPE.GIF:B.default.MEDIA_TYPE.VIDEO;case h.MSG_TYPE.AUDIO:return B.default.MEDIA_TYPE.AUDIO;case h.MSG_TYPE.PTT:return B.default.MEDIA_TYPE.PTT;case h.MSG_TYPE.DOCUMENT:return B.default.MEDIA_TYPE.DOCUMENT;case h.MSG_TYPE.UNKNOWN:return B.default.MEDIA_TYPE.FUTURE;case h.MSG_TYPE.LOCATION:return this.isLive?B.default.MEDIA_TYPE.LIVE_LOCATION:B.default.MEDIA_TYPE.LOCATION;case h.MSG_TYPE.VCARD:return B.default.MEDIA_TYPE.CONTACT;case h.MSG_TYPE.MULTI_VCARD:return B.default.MEDIA_TYPE.CONTACT_ARRAY;case h.MSG_TYPE.CHAT:return this.linkPreview?B.default.MEDIA_TYPE.URL:B.default.MEDIA_TYPE.NONE;case h.MSG_TYPE.STICKER:return B.default.MEDIA_TYPE.STICKER;case h.MSG_TYPE.PRODUCT:return B.default.MEDIA_TYPE.PRODUCT_IMAGE;default:return B.default.MEDIA_TYPE.NONE}}},{key:"sendRevoke",value:function(e){var t=this;if(!R.default.supportsFeature(R.default.F.REVOKE))return Promise.reject("revoke feature unsupported");if(!this.id.fromMe)return Promise.reject("revoking received message");var i=new z.default({id:(0,ie.default)(),remote:this.id.remote,fromMe:!0}),n={id:i,to:this.id.remote,t:this.t,type:h.MSG_TYPE.PROTOCOL,subtype:"revoke",protocolMessageKey:this.id,clearMedia:!!e,local:!0};return(0,pe.sendMsgRecord)(u(n)).then(function(e){if("success"===e){var n=Math.trunc(Date.now()/1e3-t.t);return new B.default.SendRevokeMessage({messageType:t.getWamMessageType(),messageMediaType:t.getWamMediaType(),revokeSendDelay:n}).commit(),t.revoke(i).then(function(){return"success"})}return Promise.reject("dropped")})}},{key:"showForwarded",value:function(){var e=q.default.fwdUiStartTs;return this.numTimesForwarded>0&&e>0&&e<this.t&&!this.isRevoked}},{key:"getForwardingScoreWhenForwarded",value:function(){if(!q.default.frequentlyForwardedMessages)return this.numTimesForwarded;var e=this.numTimesForwarded+(this.id.fromMe?0:1);return e>=q.default.frequentlyForwardedThreshold?E.default.FREQUENTLY_FORWARDED_SENTINEL:e}},{key:"getProductInfoText",value:function(){var e=this.title,t=this.description,i=this.currencyCode,n=this.priceAmount1000;e="*"+e+"*";var r=i&&n?k.default.format(i,n):null;return e=e.length>E.default.MAX_REPLY_PRODUCT_TITLE_LENGTH?(0,fe.firstNCodepoints)(e,E.default.MAX_REPLY_PRODUCT_TITLE_LENGTH)+"...":e,t=t.length>E.default.MAX_REPLY_PRODUCT_DESC_LENGTH?(0,fe.firstNCodepoints)(t,E.default.MAX_REPLY_PRODUCT_DESC_LENGTH)+"...":t,e+"\n"+(r||t)}},{key:"_logStorageEstimate",value:function(e){return(0,le.default)().then(function(t){t&&(e.webcBrowserStorageQuotaBytes=t.quota,e.webcBrowserStorageQuotaUsedBytes=t.usage)})}}]),t}(_.default);ve.Collection="Msg",ve.Proxy="msg",ve.idClass=z.default;var be=(0,b.defineModel)(ve);t.default=be},cbeabehaca:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i("hbhijdici"),s=n(a),u=i("cahfddcdga"),c=n(u),l=i("bdiiahhjbe"),f=n(l),d=i("jccfhaecf"),h=n(d),p=function(){function e(){r(this,e),this._map={},this.length=0}return o(e,[{key:"put",value:function(t){var i=e.getSidelistHash(t);if(i&&!this._map[i]){if(this._map[i]){var n=this._map[i];n instanceof h.default?this._map[i]=[n,t.id]:n instanceof Array&&n.push(t.id)}else this._map[i]=t.id;this.length++}}},{key:"remove",value:function(t){var i=e.getSidelistHash(t);if(i&&this._map[i]){var n=(0,c.default)(this._map[i]);n instanceof h.default?delete this._map[i]:n instanceof Array&&s.default.remove(n,function(e){return e.equals(t.id)}),this.length++}}},{key:"get",value:function(e){var t=this._map[e];return t instanceof h.default?[t]:t}},{key:"clear",value:function(){this._map={},this.length=0}}],[{key:"getSidelistHash",value:function(e){return e.isUser?"string"==typeof e.userhash&&e.userhash.slice?e.userhash.slice(0,4):(f.default.error("Store:Contact can't call slice on contact.userhash")(e.userhash),null):null}}]),e}();t.default=p},ccbagdhfbb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return M[e]||!1}function o(e,t){switch(t){case"text":return e.type===y.default.MSG_TYPE.CHAT&&"url"!==e.subtype;case"image":return e.type===y.default.MSG_TYPE.IMAGE;case"video":return e.type===y.default.MSG_TYPE.VIDEO&&!e.isGif;case"gif":return e.type===y.default.MSG_TYPE.VIDEO&&e.isGif;case"audio":return e.type===y.default.MSG_TYPE.AUDIO;case"ptt":return e.type===y.default.MSG_TYPE.PTT;case"document":return e.type===y.default.MSG_TYPE.DOCUMENT;case"location":return e.type===y.default.MSG_TYPE.LOCATION;case"vcard":return e.type===y.default.MSG_TYPE.VCARD||e.type===y.default.MSG_TYPE.MULTI_VCARD;case"url":return e.type===y.default.MSG_TYPE.CHAT&&"url"===e.subtype;case"sticker":return e.type===y.default.MSG_TYPE.STICKER;case void 0:default:return!1}}function a(e){if(!e)return null;var t=new E.default({from:e.from,to:e.to,id:e.id,participant:e.participant,selfDir:e.self});return e.id=t,new T.default.Msg.constructor.model(e)}function s(e,t){if(!e)return e;var i=t.get(e.id);return i&&!i.isRevoked?i:e}function u(e){var t=void 0,i=void 0,n=void 0;if(e instanceof T.default.Msg.constructor.model)i=e,n=e.id;else{if(!(e instanceof E.default))return void m.default.error("model:msgs:broadcastFanout: unknown msgOrKey: "+String(e))(e);n=e}if(!C.default.isStatusV3(n.remote)){if(i&&i.recipients&&0!==i.recipients.length)t=i.recipients;else{var r=T.default.GroupMetadata.get(n.remote);r?t=p.default.map(f(r.participants),"id"):m.default.log("model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: "+n.remote.toString())()}return t?t.map(function(e){return new E.default({fromMe:n.fromMe,remote:e,id:n.id})}):void 0}}function c(e){var t=void 0;if(!e.invis){var i=u(e);i&&(t=i.map(function(e){return e.remote}),i.forEach(function(t){if(!T.default.Msg.some(p.default.matches({id:t}))){var i=f(e);i.to=t.remote,i.id=t,i.broadcast=!0;var n=T.default.Msg.add(i,{merge:!0});T.default.Chat.find(t.remote).then(function(e){l(n,e,!0)})}}))}return t}function l(e,t,n,r,o,a){var s=r||t.msgs;if(0!==e.length){var u=s===t.msgs;if(a)if(u){m.default.info("models:msg:store:resetMostRecentMsgs .msgs === cmc !")();var c=p.default.findLast(e,function(e){return!!e});c&&(0,S.setLastReceivedKey)(t.id,c.id).then(function(){t.lastReceivedKey=c.id,s.add(e)})}else{u=!0;var l=p.default.findLast(e,function(e){return!!e}),f=Promise.resolve();l&&(f=(0,S.setLastReceivedKey)(t.id,l.id).then(function(){t.lastReceivedKey=l.id,s.add(e)})),f.then(function(){var e=i("dbfjecijha").default,n=new e;n.replace(t.msgs),t.msgChunks.push(n),t.replaceMsgsCollection(s),t.msgs.trigger("change:last",t.msgs.last())})}else if(n){var h=Promise.resolve();if(u){var g=p.default.findLast(e,function(e){return!!e});g&&(h=(0,S.setLastReceivedKey)(t.id,g.id).then(function(){t.lastReceivedKey=g.id}))}h.then(function(){s.add(e)})}else s.add(e,{at:0,silent:p.default.every(e,d)});if(n&&u||!T.default.Msg.lastReceivedReceipt[t.id])for(var y=e.length,v=y-1;v>=0;v--){var b=e[v],_=b.id;if(_.fromMe&&!b.isNotification){T.default.Msg.updateLastReceipt(_.remote,b.t);break}}if(n&&u||!T.default.Msg.lastReceivedPaymentTransaction[t.id])for(var O=e.length,E=O-1;E>=0;E--){var P=e[E],j=P.id;P.paymentTransactionTimestamp&&T.default.Msg.updateLastTransactionTime(j.remote,P.paymentTransactionTimestamp)}var C=o;C&&!t.unreadMsgAnchor&&(t.disableUnreadAnchor?t.disableUnreadAnchor=!1:t.unreadMsgAnchor=p.default.find(e,function(e){return e.id.toString()===C.toString()}))}}function f(e){return null!=e&&"object"==typeof e?JSON.parse(JSON.stringify(e),b.default):e}function d(e){return"i"===e.eventType}Object.defineProperty(t,"__esModule",{value:!0}),t.typeIsMMS=r,t.msgMatchesType=o,t.createQuotedMsg=a,t.getOriginalQuotedMsgIfPossible=s,t.getBroadcastFanoutKeys=u,t.broadcastFanout=c,t.addRecordsToChat=l;var h=i("hbhijdici"),p=n(h),g=i("eadfaddcj"),y=n(g),v=i("eecdaegci"),b=n(v),_=i("bdiiahhjbe"),m=n(_),O=i("ccgjijjbbj"),E=n(O),P=i("bhggeigghg"),T=n(P),j=i("jccfhaecf"),C=n(j),S=i("cefjgcjhgf"),M={image:!0,video:!0,audio:!0,ptt:!0,sticker:!0,document:!0,product:!0}},ccbihadedf:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("dbbaabdabi"),c=n(u),l=i("bjebjijbfc"),f=n(l),d=i("cgcgbfbffj"),h=n(d),p=i("cjbafegbjg"),g=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"initializeFromCache",value:function(e){if(e){var t=f.default.globalUnixTime()-u.ConversionTupleExpiry,i=e.filter(function(e){return e.timestamp-t>0}).map(function(e){var t=(0,p.parseConversionData)(e.conversionData);return t?e.conversionData=t:delete e.conversionData,e});this.add(i),this.saveToCache()}}}]),t}(h.default);g.model=c.default,g.cachePolicy={id:"conversion_tuple",policy:d.CACHE_POLICY.LOAD,delay:1e3},e.exports=new g},ccdbdjihjh:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=i("dcaifjegcg"),s=function(e){return e&&e.__esModule?e:{default:e}}(a),u=function(e){function t(){var e,i,o,s;n(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.id=(0,a.prop)(),o.callId=(0,a.prop)(),o.isIncoming=(0,a.prop)(!1),o.isRinging=(0,a.prop)(!1),o.isInterrupted=(0,a.prop)(!1),o.isMuted=(0,a.prop)(!1),o.isTrafficStopped=(0,a.prop)(!1),o.isInvitingToGroupCall=(0,a.prop)(!1),o.isVideoStopped=(0,a.prop)(!1),o.isVideoPaused=(0,a.prop)(!1),o.isVideoDecodePaused=(0,a.prop)(!1),o.isVideoDecodeStarted=(0,a.prop)(!1),o.isOfferingVideoUpgrade=(0,a.prop)(!1),s=i,r(o,s)}return o(t,e),t}(s.default);u.Proxy="callParticipant",t.default=(0,a.defineModel)(u)},ccehadbeci:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("hbhijdici"),l=n(c),f=i("dcaifjegcg"),d=n(f),h=i("dbfjecijha"),p=n(h),g=i("bdiiahhjbe"),y=n(g),v=i("hciaejfjd"),b=n(v),_=i("bjigbaghc"),m=n(_),O=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,f.prop)(),n.pendingMsgs=(0,f.prop)(),n.labels=(0,f.prop)(),n.msgChunks=(0,f.session)(function(){return[]}),n.lastReceivedKey=(0,f.session)(),n.unreadMsgAnchor=(0,f.session)(),n.disableUnreadAnchor=(0,f.session)(),n.msgsLength=(0,f.session)(),n.msgsChanged=(0,f.session)(0),n.msgs=(0,f.collection)(p.default),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){var e=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.listenTo(this.msgs,"change:last",function(){e.msgsChanged++}),this.listenTo(this.msgs,"add remove bulk_add",function(){e.msgsChanged++,e.msgsLength=e.msgs.length}),m.default.isSMB&&(this.addLabelsToCollection(),this.listenTo(this,"change:labels",this.addLabelsToCollection))}},{key:"addLabelsToCollection",value:function(){(0,b.default)(this.id.toString(),this.labels,"Chat")}},{key:"onEmptyMRM",value:function(){throw new Error("onEmptyMRM not implemented")}},{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.getAllCMCs().forEach(function(e){e.forEach(function(e){e.delete()}),e.delete()})}},{key:"removeMsg",value:function(e){var t=e.msgChunk;if(t){t.indexOf(e)<0||(y.default.log("models:Chat:removeMsg "+e.get("id"))(),t.remove(e),0===t.length&&(t===this.msgs?this.onEmptyMRM():this.removeMsgsCollection(t)))}}},{key:"getAllCMCs",value:function(){return this.msgChunks.concat([this.msgs])}},{key:"getAllMsgs",value:function(){return l.default.flatten(this.getAllCMCs().map(function(e){return e.getModelsArray()}))}},{key:"replaceMsgsCollection",value:function(e){y.default.info("model:Chat:replaceMsgsCollection:"+this.id.toString())();var t={msg:e.last()};this.msgs.replace(e),this.notifyMsgCollectionMerge(e,this.msgs,this.msgs,t),this.msgChunks=l.default.without(this.msgChunks,e),e.delete()}},{key:"removeMsgsCollection",value:function(e){this.msgChunks=l.default.without(this.msgChunks,e),e.delete()}},{key:"notifyMsgCollectionMerge",value:function(e,t,i,n){this.trigger("change:cmc:merge",e,t,i,n)}}]),t}(d.default);t.default=O},ccfcjccjbg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("hbhijdici"),l=n(c),f=i("hciaejfjd"),d=n(f),h=i("bgfcjjddjf"),p=n(h),g=i("dcaifjegcg"),y=n(g),v=i("bjigbaghc"),b=n(v),_=i("ccicaaeiaa"),m=i("eadfaddcj"),O=n(m),E=i("ccaaiecfib"),P=n(E),T=i("fffdgbfji"),j=n(T),C=i("bdiiahhjbe"),S=n(C),M=i("edjgaiicj"),w=n(M),k=i("dhefcajhhb"),A=n(k),I=i("eaghgadcdf"),L=n(I),R=i("gbbacfeci"),N=n(R),D=i("bhggeigghg"),F=n(D),G=i("jccfhaecf"),U=n(G),x=i("djbfhebjhe"),Y=n(x),B=i("dfbbghiidh"),V=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,g.prop)(),n.name=(0,g.prop)(),n.shortName=(0,g.prop)(),n.pushname=(0,g.prop)(),n.type=(0,g.prop)("in"),n.verifiedName=(0,g.prop)(),n.isBusiness=(0,g.prop)(),n.isEnterprise=(0,g.prop)(),n.verifiedLevel=(0,g.prop)(),n.statusMute=(0,g.prop)(),n.sectionHeader=(0,g.prop)(),n.labels=(0,g.prop)(),n.isContactBlocked=(0,g.session)(!1),n.verificationString=(0,g.session)(),n.verificationBinary=(0,g.session)(),n.pendingAction=(0,g.session)(),n._notifyName=(0,g.session)(null),n.promises=(0,g.session)(function(){return{}}),n.status=(0,g.session)(),n.profilePicThumb=(0,g.session)(),n.businessProfile=(0,g.session)(),n.commonGroups=(0,g.session)(),n.liveLocations=(0,g.session)(),n.businessCatalog=(0,g.session)(),n.notifyName=(0,g.derived)(n._notifyNameFunction,["_notifyName","pushname","isBusiness","verifiedLevel","verifiedName"]),n.mentionName=(0,g.derived)(n._mentionName,["isMyContact","isBusiness","verifiedLevel","name","notifyName"]),n.displayName=(0,g.derived)(n._displayName,["id","mentionName","isMe"]),n.userid=(0,g.derived)(n._userid),n.userhash=(0,g.derived)(n._userhash),n.searchName=(0,g.derived)(n._searchName,["name","id"]),n.searchVerifiedName=(0,g.derived)(n._searchVerifiedName,["verifiedLevel","verifiedName"]),n.header=(0,g.derived)(n._header,["name"]),n.isMe=(0,g.derived)(n._isMe),n.isUser=(0,g.derived)(n._isUser),n.isGroup=(0,g.derived)(n._isGroup),n.isBroadcast=(0,g.derived)(n._isBroadcast),n.isPSA=(0,g.derived)(n._isPSA),n.formattedShortNameWithNonBreakingSpaces=(0,g.derived)(n._formattedShortNameWithNonBreakingSpaces,["shortName","formattedName","id"]),n.formattedShortName=(0,g.derived)(n._formattedShortName,["shortName","formattedName","id"]),n.formattedName=(0,g.derived)(n._formattedName,["name","id"]),n.formattedUser=(0,g.derived)(n._formattedUser,["name","id"]),n.isWAContact=(0,g.derived)(n._isWAContact,["type"]),n.isMyContact=(0,g.derived)(n._isMyContact,["name"]),n.showBusinessCheckmark=(0,g.derived)(n._showBusinessCheckmark,["isBusiness","verifiedLevel","name","verifiedName"]),n.showBusinessVname=(0,g.derived)(n._showBusinessVname,["isBusiness","verifiedLevel","name","verifiedName"]),a=i,o(n,a)}return a(t,e),s(t,[{key:"_notifyNameFunction",value:function(){return this.isBusiness&&this.verifiedLevel!==O.default.VERIFIED_LEVEL.HIGH?this.verifiedName:P.default.supportsFeature(P.default.F.CONTACT_HAS_PUSHNAME)?this.pushname:this._notifyName?this._notifyName.name:void 0}},{key:"_mentionName",value:function(){return!this.isMyContact&&this.isBusiness&&this.verifiedLevel!==O.default.VERIFIED_LEVEL.HIGH?null:this.name||this.notifyName}},{key:"_displayName",value:function(){return this.isMe?b.default.pushname:this.mentionName||(0,Y.default)(this.id)}},{key:"_userid",value:function(){return this.isUser?U.default.user(this.id):null}},{key:"_userhash",value:function(){return this.isUser?(0,w.default)((this.id.user||"")+"WA_ADD_NOTIF"):null}},{key:"_searchName",value:function(){return U.default.isPSA(this.id)?j.default.accentFold(j.default.t("whatsapp_psa_contact_name")):this.name?j.default.accentFold(this.name):null}},{key:"_searchVerifiedName",value:function(){return this.verifiedLevel!==O.default.VERIFIED_LEVEL.HIGH?null:this.verifiedName?j.default.accentFold(this.verifiedName):null}},{key:"_header",value:function(){if(this.name){var e=this.name.toLowerCase(),t=L.default.alpha.exec(e);if(t&&0===t.index||t&&L.default.noDigits.test(e.slice(t.index))){var i=t[0],n=j.default.removeAccents(i);return(0,_.getCollator)().compare(n,i)?i:n}return"#"}}},{key:"_isMe",value:function(){return this.id.equals(b.default.me)}},{key:"_isUser",value:function(){return U.default.isUser(this.id)}},{key:"_isGroup",value:function(){return U.default.isGroup(this.id)}},{key:"_isBroadcast",value:function(){return U.default.isBroadcast(this.id)}},{key:"_isPSA",value:function(){return U.default.isPSA(this.id)}},{key:"_formattedShortNameWithNonBreakingSpaces",value:function(){return this.id?this.isMe?j.default.t("web_you"):this.shortName||this.formattedName&&this.formattedName.replace(/\s/g," "):""}},{key:"_formattedShortName",value:function(){return this.id?this.isMe?j.default.t("web_you"):this.shortName||this.formattedName:""}},{key:"_formattedName",value:function(){if(!this.id)return"";if(this.isMe)return j.default.t("web_you");if(U.default.isPSA(this.id))return j.default.t("whatsapp_psa_contact_name");var e=void 0;return!this.name&&this.isUser&&(e=(0,Y.default)(this.id)),this.name||e}},{key:"_formattedUser",value:function(){return this.getFormattedUser()}},{key:"_isWAContact",value:function(){return this.isUser&&"in"===this.type}},{key:"_isMyContact",value:function(){return!!(this.isUser&&this.name&&this.name.length)}},{key:"_showBusinessCheckmark",value:function(){return this.isBusiness&&this.verifiedLevel===O.default.VERIFIED_LEVEL.HIGH&&this.name===this.verifiedName}},{key:"_showBusinessVname",value:function(){return this.isBusiness&&this.verifiedLevel===O.default.VERIFIED_LEVEL.HIGH&&this.name!==this.verifiedName}},{key:"initialize",value:function(){var e=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.id&&(this.isMe&&this.addChild("status",N.default.gadd(this.id)),this.isMe&&this.addChild("profilePicThumb",A.default.gadd(this.id)),this.isBusiness&&this.addChild("businessProfile",F.default.BusinessProfile.gadd(this.id)),this.listenTo(this,"change:isBusiness",function(){return(0,B.onIsBusinessChange)(e)}),this.isContactBlocked=!!p.default.get(this.id),this.pendingAction=0,b.default.isSMB&&(this.addLabelsToCollection(),this.listenTo(this,"change:labels",this.addLabelsToCollection)))}},{key:"getStatus",value:function(){return U.default.user(this.id)||S.default.info("contact:getStatus for non-user "+this.id.toString())(),this.status=N.default.gadd(this.id)}},{key:"addLabelsToCollection",value:function(){(0,d.default)(this.id.toString(),this.labels,"Contact")}},{key:"getProfilePicThumb",value:function(){return this.profilePicThumb=A.default.gadd(this.id)}},{key:"addPendingAction",value:function(e){var t=this;if(e.isPending()){var i=function(){t.decPending()};e.then(i,i),this.pendingAction++}return e}},{key:"decPending",value:function(){this.pendingAction>0?this.pendingAction--:(S.default.log("contact:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)}},{key:"isBlocked",value:function(){return!!p.default.get(this.id)}},{key:"searchMatch",value:function(e,t,i){return P.default.supportsFeature(P.default.F.LABELS_DISPLAY)&&i?!(e&&this.searchName&&this.searchName.indexOf(e)<0)&&l.default.includes(this.labels,i):!!e&&(!!(this.searchName&&this.searchName.indexOf(e)>-1)||(!!(this.userid&&this.userid.indexOf(e)>-1)||(!!(t&&this.userid&&this.userid.indexOf(t)>-1)||(!!(this.searchVerifiedName&&this.searchVerifiedName.indexOf(e)>-1)||!!(this.pushname&&j.default.accentFold(this.pushname).indexOf(e)>-1)))))}},{key:"getFormattedUser",value:function(){return this.id?U.default.isPSA(this.id)?j.default.t("whatsapp_psa_contact_name"):this.name?this.name:j.default.isRTL()?j.default.embedLTR((0,Y.default)(this.id)):(0,Y.default)(this.id):""}},{key:"set",value:function(e,i,n){var r=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,e,i,n);if("string"!=typeof e&&i&&i.merge&&r){if(r.isPSA)return r;!e.name&&r.name&&(r.unset("name"),r.unset("shortName")),!e.verifiedName&&r.verifiedName&&r.unset("verifiedName")}return r}}]),t}(y.default);V.Collection="Contact",V.Proxy="contact",V.idClass=U.default,t.default=(0,g.defineModel)(V)},ccicaaeiaa:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var i=e.id.toString(),n=t.id.toString();if(i===d.default.me.toString())return 1;if(n===d.default.me.toString())return-1;var r=e.name,o=t.name;if(!r&&o)return 1;if(r&&!o)return-1;if(r&&o&&e.header&&t.header){var a=h.compare(e.header,t.header);return 0===a?h.compare(r,o):a}return i&&n?i.localeCompare(n):-1}function o(){return h}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.default.L10N.DEFAULT;if(window.Intl&&window.Intl.Collator){var t=window.Intl.Collator([e],{sensitivity:"base"});h={compare:function(e,i){try{return t.compare(e,i)}catch(e){return 0}}}}else h={compare:function(e,t){return e.localeCompare(t)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,t.getCollator=o;var s=i("eadfaddcj"),u=n(s),c=i("gbfffciea"),l=n(c),f=i("bjigbaghc"),d=n(f),h=void 0;a(),l.default.on("set_locale",a)},ccijeahddj:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(){Object.assign(a.default,u.default)}Object.defineProperty(t,"__esModule",{value:!0}),t.loadCollections=r;var o=i("bhggeigghg"),a=n(o),s=i("cjedbbhjhh"),u=n(s)},cdaedfafjc:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.index,i=e.page;return new m({id:""+v+t,index:t,page:i})}Object.defineProperty(t,"__esModule",{value:!0}),t.StickerPack=void 0;var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("dcaifjegcg"),f=n(l),d=i("cgejbjhjej"),h=n(d),p=i("daichdjff"),g=i("bffjfbgbg"),y=n(g),v="placeholder:",b="image/png",_=t.StickerPack=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,l.prop)(),n.index=(0,l.prop)(),n.name=(0,l.prop)(),n.page=(0,l.prop)(),n.url=(0,l.prop)(),n.mimetype=(0,l.prop)(b),n.mediaData=(0,l.session)(),n._mediaObject=(0,l.prop)(),n.directPath=(0,l.prop)(),n.filehash=(0,l.prop)(),n.mediaKey=(0,l.prop)(),n.size=(0,l.prop)(),n.type=(0,l.prop)(p.OUTWARD_TYPES.STICKER_PACK),n.uploadhash=(0,l.prop)(),n.clientUrl=(0,l.derived)(n._clientUrl,["url","isFirstParty"]),n.stickers=(0,l.derived)(n._getStickersCollection,["id"]),n.isPlaceholder=(0,l.derived)(n._isPlaceholder,["id"]),n.isFirstParty=(0,l.derived)(n._isFirstParty,["url","mediaKey"]),a=i,o(n,a)}return a(t,e),u(t,[{key:"_clientUrl",value:function(){return this.isFirstParty?"":this.url}},{key:"_isPlaceholder",value:function(){return t.isPlaceholderId(this.id)}},{key:"_isFirstParty",value:function(){return Boolean(this.url)&&!this.mediaKey}},{key:"_getStickersCollection",value:function(){return this._stickers=this._stickers||new h.default(this.id.split("#")[0]),this._stickers}},{key:"initialize",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.isPlaceholder||this.isFirstParty||(this.addChild("mediaData",new y.default({renderableUrl:""})),i("ddgbhifaji").registerStickerPackIcon(this))}},{key:"downloadMedia",value:function(){this.isPlaceholder||this.isFirstParty||i("ddgbhifaji").downloadStickerOrStickerPackIcon(this)}}]),t}(f.default);_.Proxy="stickerPack",_.createPlaceholder=s,_.isPlaceholderId=function(e){return new RegExp("^"+v).test(e)};var m=(0,l.defineModel)(_);t.default=m,m.createPlaceholder=s,m.isPlaceholderId=_.isPlaceholderId},cdbfiiicdg:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=i("bdfbccfifg"),s=function(e){return e&&e.__esModule?e:{default:e}}(a),u=function(e){function t(e,i){return n(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i.id))}return o(t,e),t}(s.default);u.policy=a.CACHE_POLICY_TYPE.NONE,t.default=u},cdcijfdgje:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("eadfaddcj"),l=n(c),f=i("bjebjijbfc"),d=n(f),h=i("dhigahgdjb"),p=n(h),g=i("cajijabhgb"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(g),v=i("bieicghjif"),b=n(v),_=i("bdiiahhjbe"),m=n(_),O=i("cgcgbfbffj"),E=n(O),P=i("jccfhaecf"),T=n(P),j=i("chajfbfiga"),C=n(j),S=i("hjbbdjjdf"),M=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"_find",value:function(e){var t=this;return T.default.isUser(e)||T.default.isGroup(e)?C.default.subscribeLiveLocation(e,!0).then(function(i){if(i.status&&i.status>=400)return 499===i.status?m.default.log("liveLocation:subscribe query not implemented on the phone")():m.default.error("model:LiveLocation:_find error "+i.status)(),Promise.reject(i.status);var n=(0,S.isNumber)(i.duration)?i.duration:void 0,r=i.participants?i.participants.map(function(e){return s({},t._extractLocationFields(e),{id:e.id,expiration:0===e.expiration?1/0:e.expiration})}):[];return{id:e,duration:n,participants:r}}):Promise.reject(new Error("invalid wid for live location: "+e))}},{key:"getActive",value:function(e){var t=this;return T.default.isUser(e)||T.default.isGroup(e)?C.default.queryActiveLiveLocation(e).then(function(i){if(i.status&&i.status>=400)return 499===i.status?m.default.log("liveLocation:participant query not implemented on the phone")():m.default.error("model:LiveLocation:getActive error "+i.status)(),Promise.reject(i.status);if(i.participants&&i.participants.length){var n=i.participants.map(function(e){return{id:e.id,expiration:0===e.expiration?1/0:e.expiration}});t.add({id:e,participants:n},{merge:!0})}}).catch(y.WapDrop,function(){}):Promise.reject(new Error("invalid wid for live location: "+e))}},{key:"onResume",value:function(){this.filter(function(e){return e.active&&e.hasParticipants()}).forEach(function(e){e.update()})}},{key:"handle",value:function(e){var t=this;Array.isArray(e)?e.forEach(function(e){switch(e.type){case"update":var i=t._extractLocationFields(e),n=p.default.get(e.jid);n&&n.liveLocations&&n.liveLocations.forEach(function(e){return e.set(i)});break;case"disable":var r=t.get(e.chat);if(r){var o=r.participants,a=o.get(e.jid);a&&(e.seq>a.sequence||-1===e.seq)&&a.disable()}break;default:m.default.error("models:liveLocation:handle unknown type: "+e.type)(e)}}):m.default.error("models:liveLocation:handle unrecognized payload")(e)}},{key:"processMsg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m.default.assert(e.type===l.default.MSG_TYPE.LOCATION&&e.isLive,"collection:liveLocation trying to process non live-location msg")();var i=e.id.remote,n=e.lat,r=e.lng,o=e.accuracy,a=e.speed,s=e.degrees,u=e.sequence,c=e.comment,f=e.shareDuration,h=e.t;if(h&&f){var p=h+f;if(!(p<=d.default.globalUnixTime())){var g={id:e.sender,lat:n,lng:r,accuracy:o,speed:a,degrees:s,sequence:u,comment:c,expiration:p,lastUpdated:h,msg:e};-1===u&&delete g.sequence;var y=this.get(i);if(y){var v=y.participants.get(g.id);if(t)return void(v&&v.lastUpdated<=g.lastUpdated&&v.set(g));if(v&&y.participants.removeParticipant(v),y.hasParticipants())return void y.participants.add(g)}this.add({id:i,participants:[g]})}}}},{key:"removeMsg",value:function(e){m.default.assert(e.type===l.default.MSG_TYPE.LOCATION&&e.isLive,"collection:liveLocation trying to remove non live-location msg")();var t=e.id.remote,i=e.sender,n=this.get(t);n&&n.participants.remove(i)}},{key:"_extractLocationFields",value:function(e){return void 0===e.lat||void 0===e.lng?{}:{lastUpdated:d.default.globalUnixTime()-e.elapsed,lat:e.lat,lng:e.lng,accuracy:e.accuracy,speed:e.speed,degrees:e.degrees,comment:e.comment}}}]),t}(E.default);M.model=b.default,M.staleCollection=!0,M.resumeOnAvailable=!0,t.default=new M},ceidcegjgi:function(e,t,i){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function r(e,t){var i={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i}Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyStates=void 0;var o=i("bdiiahhjbe"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=t.ProxyStates={};t.default=function(e,t,i){function o(e){this._ProxyState$state=e}var u=t.props,c=t.session,l=t.collections,f=t.derived,d=r(t,["props","session","collections","derived"]),h={};[u,c,l,f].forEach(function(e){e&&Object.keys(e).forEach(function(e){h[e]={get:function(){return a.default.assert(!1,"Invalid ProxyState Access",'Cannot read proxy property "'+e+'" created in <'+this._ProxyState$ComponentName+"/>. Make sure it is whitelisted in your list of concerns.")(),this._ProxyState$state[e]},set:function(t){a.default.assert(!1,"Invalid ProxyState Write",'Cannot write proxy property "'+e+'" created in <'+this._ProxyState$ComponentName+"/>. Make sure it is whitelisted in your list of concerns.")(),this._ProxyState$state[e]=t}}})}),h.mirrorMask={value:i},h.isProxyOf={value:function(e){return this._ProxyState$state===e}},["set","get"].concat(n(Object.keys(d))).forEach(function(e){h[e]={value:function(){var t=this._ProxyState$state;return t[e].apply(t,arguments)}}}),o.prototype=Object.create(null,h),o.prototype.constructor=o,s[e]=o}},cgcgbfbffj:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CACHE_POLICY=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},c=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},f=i("hbhijdici"),d=r(f),h=i("dfhjacfbjg"),p=n(h),g=i("bjigbaghc"),y=r(g),v=i("cajijabhgb"),b=n(v),_=i("bdiiahhjbe"),m=r(_),O=i("eacidghfgh"),E=r(O),P=i("dcdiaahjj"),T=r(P),j=i("fcedgihic"),C=r(j),S=i("bebehddcbc"),M=r(S),w=i("hjbbdjjdf"),k=i("bhggeigghg"),A=r(k),I=i("dbjfahieed"),L={QUERY:"QUERY",FIND:"FIND",UPDATE:"UPDATE"};t.CACHE_POLICY=I.CACHE_POLICY_TYPE;var R=(new Object).toString(),N={id:"none",policy:I.CACHE_POLICY_TYPE.NONE},D=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._inflight={},e._cachePolicy=(0,I.createCachePolicy)(e,e.constructor.cachePolicy||N),e._staleCollection=e.constructor.staleCollection||!1,e._resumeOnAvailable=e.constructor.resumeOnAvailable||!1,(!0===e._staleCollection||d.default.isFunction(e.onResume))&&(e.listenTo(E.default,"change:stream",e._handleStreamChange),e.listenTo(E.default,"didResume",e._onResume),e._resumeOnAvailable&&e.listenTo(T.default,"change:available",function(){T.default.available&&e._needsUpdate&&e._onResume()})),e._cachePolicy.enableCaching(),e._cachePolicy.constructor.policy===I.CACHE_POLICY_TYPE.LOAD&&e.listenTo(y.default,"change:me",e._updateFromCache),e}return s(t,e),c(t,[{key:"initializeFromCache",value:function(e){this.add(e)}},{key:"saveToCache",value:function(){if(y.default.me){var e=this._cachePolicy.id;m.default.log("baseCollection:saveToCache save: "+String(e))(),M.default.setCollection(e,this.toJSON(),this._cachePolicy.constructor.policy===I.CACHE_POLICY_TYPE.IMMEDIATE)}}},{key:"add",value:function(e,i){var n=this;if(e){if(y.default.blockStoreAdds)throw new b.LogoutDrop("adding to store when blocking store adds");var r=Array.isArray(e)?e:[e];if(d.default.every(r,function(e){return e&&e.isState})){var o=d.default.reject(r,function(e){return n.get(e.id)});return o.length&&l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,o,i),r}}return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e,i)}},{key:"findQuery",value:function(e,t){return this._query(L.QUERY,e,t)}},{key:"find",value:function(e,t){return e?this._query(L.FIND,e,t):(p.upload(m.default.trace("Called find without an id")),Promise.reject("called find without an id"))}},{key:"update",value:function(e,t){return e?this._query(L.UPDATE,e,t):(p.upload(m.default.trace("Called update without an id")),Promise.reject("called update without an id"))}},{key:"handle",value:function(e){var t=this._handle(e.shift());if(this._staleCollection){var i=Array.isArray(t)?t:[t];d.default.each(d.default.compact(i),function(e){e.stale=!1})}this.add(t,{merge:!0})}},{key:"gadd",value:function(e,t){if(this._model.prototype.isIdType(e)){var i=this.get(e);if(i)return i;var n={id:e};return this.add(n,t)[0]}if(e&&e.id){var r=t||{};return r.merge=!0,this.add(e,r)[0]}var o=d.default.findKey(A.default,this)||"unknown";throw new Error(o+".gadd called without an id attr (id)")}},{key:"gaddUp",value:function(e){var t=void 0,i=this._staleCollection;if(this._model.prototype.isIdType(e)){var n={stale:i,id:e};t=this.get(e)||this.add(n,{merge:!0})[0]}else e&&e.id&&(this.get(e.id)&&(i=!1),e=u({stale:i},e),t=this.add(e,{merge:!0})[0]);if(t)return t.stale&&this.find(t.id).catch(b.WapDrop,function(){}),t;var r=d.default.findKey(A.default,this)||"unknown";throw new Error(r+".gadd called without an id attr (id)")}},{key:"delete",value:function(){this._inflight={},this.reset()}},{key:"isStateStale",value:function(e){var t=this.get(e);return!!t&&t.stale}},{key:"_handleResume",value:function(){switch(E.default.stream){case O.STREAM.DISCONNECTED:if(!this._staleCollection)return;this.forEach(function(e){e&&(e.stale=!0)});break;case O.STREAM.RESUMING:case O.STREAM.SYNCING:case O.STREAM.CONNECTED:}}},{key:"_onResume",value:function(){d.default.isFunction(this.onResume)&&(this._resumeOnAvailable&&!T.default.available?this._needsUpdate=!0:(this.onResume(),this._needsUpdate=!1))}},{key:"_query",value:function(e,t,i){var n=this,r=(0,w.isString)(t)?t:t.toString();r===R&&(r=d.default.uniqueId("collection_query_"));var o=e===L.QUERY?void 0:this.get(t),a="force-"+r;if((this._inflight[a]&&e===L.FIND||e===L.UPDATE)&&(r=a),this._inflight[r])return e===L.FIND&&o&&!o.stale?Promise.resolve(o):this._inflight[r];if(!o||o&&o.stale||e===L.UPDATE){var s=this._inflight[r]=this._serverQuery(e,t,i).finally(function(){delete n._inflight[r]});return s.catch(b.WapDrop,function(e){m.default.warn(e.toString())()}).catch(function(){}),s.catch(w.isString,function(e){m.default.log("baseCollection:query query promise rejected: "+String(e))()})}return Promise.resolve(o)}},{key:"_serverQuery",value:function(e,t,i){var n=this,r=void 0;if(e===L.UPDATE)r=this._update(t);else if(e===L.FIND)r=this._find(t);else{var o=i&&i.logOnSend;r=this._findQuery(t,o)}return r.then(function(e){if(n._staleCollection){var t=Array.isArray(e)?e:[e];d.default.each(d.default.compact(t),function(e){void 0===e.stale&&(e.stale=!1)})}var r=void 0;if(r=i&&i.set?n.set(e):n.add(e,{merge:!0}),Array.isArray(e))return r;if(r[0])return r[0];throw new b.ModelCreateError(n._model.prototype.Collection,e)})}},{key:"_update",value:function(e){return this._find(e)}},{key:"_handleStreamChange",value:function(){this._handleResume(),this._cachePolicy.constructor.policy===I.CACHE_POLICY_TYPE.LOAD&&this._updateFromCache()}},{key:"_updateFromCache",value:function(){var e=this._cachePolicy.id;this._cachePolicy.disableCaching(),y.default.me&&(m.default.log("baseCollection:initFromCache load: "+String(e))(),this.initializeFromCache(M.default.getCollection(e)),this._cachePolicy.enableCaching())}}]),t}(C.default);t.default=D},cgejbjhjej:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FETCH_STATE=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("dhjffabgfb");Object.defineProperty(t,"FETCH_STATE",{enumerable:!0,get:function(){return c.FETCH_STATE}});var l=i("chajfbfiga"),f=n(l),d=i("hbhijdici"),h=n(d),p=function(e){function t(e){var i;r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n._parseStickersRes=function(e){if(200!==e.status||!e.data)throw new Error("sticker pack stickers query error");return e.data.map(function(e,t){return s({},h.default.pick(e,["directPath","mimetype","mediaKey","filehash","width","height"]),{index:t,id:e.filehash,clientUrl:e.url,uploadhash:e.encFilehash})})},n.stickerPackId=e;var a=t._cache[n.stickerPackId];if(a)return i=a,o(n,i);var u=void 0,c=n;return Object.defineProperty(n,"fetchState",{get:function(){return u},set:function(e){u!==e&&(u=e,c.trigger("change:fetchState",e))}}),n}return a(t,e),u(t,[{key:"fetch",value:function(e){var t=this;return e&&this.fetchState!==c.FETCH_STATE.PENDING&&delete this._fetchPromise,this._fetchPromise?this._fetchPromise:(this.fetchState=c.FETCH_STATE.PENDING,i("cdaedfafjc").default.isPlaceholderId(this.stickerPackId)?(this._fetchPromise=new Promise(function(){}),this._fetchPromise):(this._fetchPromise=f.default.queryStickersInStickerPack(this.stickerPackId).then(this._parseStickersRes).then(function(e){var i=Math.max(t.length||e.length);t._resetRange(0,i,e),t.fetchState=c.FETCH_STATE.SUCCESS}).catch(function(e){t.fetchState=c.FETCH_STATE.ERROR}),this._fetchPromise))}},{key:"_resetRange",value:function(e,t,i){var n=this;this._forEachInRange(e,t,function(t,r){var o=i[r-e];t?o?t.id===o.id?t.set(o):(n.remove(t),n.add(o)):n.remove(t):o&&n.add(o)})}},{key:"_forEachInRange",value:function(e,t,i){for(var n=e;n<t;n++){i(this.at(n),n)}}}]),t}(c.StickerCollection);p._cache={},p.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0},t.default=p},cgfdiahhcd:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("bdfbccfifg"),c=n(u),l=i("hbhijdici"),f=n(l),d=function(e){function t(e,i){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i.id));return n._trigger=i.trigger||"all",n._delay=i.delay,n._saveToCache=f.default.debounce(n.saveToCache,n._delay),n}return a(t,e),s(t,[{key:"saveToCache",value:function(){this.collection.saveToCache()}},{key:"enableCaching",value:function(){this.listenTo(this.collection,this._trigger,this._saveToCache)}},{key:"disableCaching",value:function(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}]),t}(c.default);d.policy=u.CACHE_POLICY_TYPE.LOAD,t.default=d},cgfidiajgj:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sticker=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("ddgbhifaji"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(f),h=i("bffjfbgbg"),p=n(h),g=i("daichdjff"),y=i("hbhijdici"),v=n(y),b=v.default.once(function(){return new m({id:"placeholder",isPlaceholder:!0})}),_=t.Sticker=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,c.prop)(),n.mediaData=(0,c.session)(),n._mediaObject=(0,c.prop)(),n.clientUrl=(0,c.prop)(),n.directPath=(0,c.prop)(),n.filehash=(0,c.prop)(),n.height=(0,c.prop)(),n.index=(0,c.prop)(),n.mediaKey=(0,c.prop)(),n.mimetype=(0,c.prop)(),n.size=(0,c.prop)(),n.type=(0,c.prop)(g.OUTWARD_TYPES.STICKER),n.uploadhash=(0,c.prop)(),n.width=(0,c.prop)(),n.isPlaceholder=(0,c.prop)(),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.addChild("mediaData",new p.default),this.isPlaceholder||d.registerSticker(this)}},{key:"downloadMedia",value:function(){return d.downloadStickerOrStickerPackIcon(this)}},{key:"sendToChat",value:function(e){i("jdigiabic").default.enqueue([this]),this.mediaData.mediaBlob.retain();var t={quotedMsg:e.composeQuotedMsg};return e.composeQuotedMsg=null,(0,f.prepSticker)(this).sendToChat(e,t)}}]),t}(l.default);_.Proxy="sticker",_.getPlaceholder=b;var m=(0,c.defineModel)(_);m.getPlaceholder=b,t.default=m},chbjajaddg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("cgcgbfbffj"),c=n(u),l=i("cbcbdjdah"),f=n(l),d=i("ccaaiecfib"),h=n(d),p=i("cajijabhgb"),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(p),y=i("biecbbiiee"),v=n(y),b=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.syncPromise=null,n.isSynced=!1,a=i,o(n,a)}return a(t,e),s(t,[{key:"onResume",value:function(){this.isSynced=!1,this.sync(this.parent)}},{key:"sync",value:function(e){var t=this;return h.default.supportsFeature(h.default.F.INDEX_RECEIVED_VCARD)?this.isSynced?Promise.resolve():this.syncPromise?this.syncPromise:(this.syncPromise=v.default.queryVCard(e.id).then(function(e){return t.add(e)}).catch(g.E499,function(){}).catch(function(){}).finally(function(){t.isSynced=!0,t.syncPromise=null}),this.syncPromise):(this.isSynced=!0,Promise.resolve())}}]),t}(c.default);b.model=f.default,b.resumeOnAvailable=!0,t.default=b},chghgadcbg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("dcaifjegcg"),c=n(u),l=i("bhggeigghg"),f=n(l),d=i("jccfhaecf"),h=n(d),p=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.id=(0,u.prop)(),a=i,o(n,a)}return a(t,e),s(t,[{key:"contact",value:function(){return f.default.Contact.gadd(this.id)}}]),t}(c.default);p.Collection="Blocklist",p.Proxy="blocklist",p.idClass=h.default,t.default=(0,u.defineModel)(p)},cjabddhidj:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("ebjaejiaba"),c=n(u),l=i("dfjfgdhbjj"),f=n(l),d=i("dbdfbgehgj"),h=n(d),p=i("bjigbaghc"),g=n(p),y=i("eacidghfgh"),v=n(y),b=i("bhggeigghg"),_=n(b),m=i("cgcgbfbffj"),O=n(m),E=function(e){function t(e,i){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.stale=!1,n.add(e,{silent:!0}),n.contact=i,n.listenTo(_.default.GroupMetadata,"group_participant_change_"+g.default.me.toString(),n.updateCommonGroups),n.listenTo(_.default.GroupMetadata,"group_participant_change_"+n.contact.toString(),n.updateCommonGroups),n.listenTo(v.default,"change:stream",function(){v.default.stream===y.STREAM.DISCONNECTED&&(n.stale=!0)}),n}return a(t,e),s(t,[{key:"updateCommonGroups",value:function(e){var t=_.default.GroupMetadata.assertGet(e),i=t.participants,n=g.default.me;this.get(e)?i.get(this.contact)&&i.get(n)||this.remove(e):i.get(this.contact)&&i.get(n)&&this.add(h.default.assertGet(e))}}]),t}(O.default);E.model=c.default,E.comparator=f.default,t.default=E},cjcghajbag:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){return e.index-t.index}Object.defineProperty(t,"__esModule",{value:!0}),t.PRODUCT_REVIEW_STATUS=void 0;var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("idbcfjbae"),f=n(l),d=i("cgcgbfbffj"),h=n(d),p=t.PRODUCT_REVIEW_STATUS={NO_REVIEW:"",PENDING:"PENDING",REJECTED:"REJECTED",APPROVED:"APPROVED",OUTDATED:"OUTDATED"},g=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"getProductModels",value:function(){var e=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toArray",this).call(this);if(c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"length",this)<1)return e;var i=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"head",this).call(this);return i&&i.catalogWid?c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"filter",this).call(this,function(e){return e.reviewStatus===p.APPROVED&&!e.old}):e}},{key:"add",value:function(e,i){var n=i?c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e,i):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e);return this.sort(),n}}]),t}(h.default);g.model=f.default,g.comparator=s,t.default=g},cjedbbhjhh:function(e,t,i){"use strict";e.exports={AllStarredMsgs:i("djfhiceeje").default,Blocklist:i("bgfcjjddjf").default,BusinessProfile:i("ejiicdbii").default,Call:i("biaifggagf").default,Catalog:i("ejegihaeh").default,Product:i("cjcghajbag").default,Chat:i("dbdfbgehgj").default,ChatPreference:i("ebcagbhefg"),Cmd:i("dhggbbghfb"),Conn:i("bjigbaghc").default,Contact:i("dhigahgdjb").default,ConversionTuple:i("ccbihadedf"),EmojiVariant:i("dfbhcehadj").default,GroupMetadata:i("djaadchjch"),Label:i("bijffg").default,LiveLocation:i("cdcijfdgje").default,Msg:i("biecbbiiee").default,MsgInfo:i("eigdejjai").default,Mute:i("dagdiahdfi").default,Presence:i("ebbjbbjjg").default,ProfilePicThumb:i("dhefcajhhb").default,QuickReply:i("bechejbabh").default,RecentEmoji:i("bjfecgfdgj").default,RecentSticker:i("jdigiabic").default,ServerProps:i("bfgbdiffgd").default,StarredGifMsgs:i("dfgeejdaib"),Status:i("gbbacfeci").default,StatusV3:i("bgcdajbhif").default,Sticker:i("dhjffabgfb").default,StickerPack:i("fagbfehid").default,Stream:i("dcdiaahjj").default,Wap:i("chajfbfiga").default,Wid:i("ecadbdfdef")}},dacfecidja:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("cgcgbfbffj"),l=n(c),f=i("dbdfbgehgj"),d=n(f),h=i("cbcbdjdah"),p=n(h),g=i("cajijabhgb"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(g),v=i("bfbggcdbfb"),b=n(v),_=i("biecbbiiee"),m=n(_),O=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.hasMoreMsgs=!0,e.resultPage=0,e.searchPromise=null,e.searchTerm=null,e.searchLabel=null,e.updateFtsAfterMsgLabelUpdate=function(){if(e.currentLabelSearch){var t=e.filter(function(t){return!t.labels||!t.labels.includes(e.currentLabelSearch)});e.remove(t,{silent:!0})}},e.listenTo(m.default,"remove_msgs",function(t){e.remove(t,{silent:!0}).filter(function(e){return!!e}).length&&e.trigger("bulk_remove")}),e.listenTo(d.default,"remove",function(t){var i=[];e.forEach(function(e){e.chat===t&&i.push(e)}),e.remove(i,{silent:!0}).filter(function(e){return!!e}).length&&e.trigger("bulk_remove")}),e}return a(t,e),s(t,[{key:"delete",value:function(e){e&&this.stopListening(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this)}},{key:"resetSearch",value:function(){this.hasMoreMsgs=!0,this.resultPage=0,this.searchTerm=null,this.searchPromise&&this.searchPromise.cancel()}},{key:"search",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e+"__"+(n.label||n.kind||"");this.currentLabelSearch=n.label;var o=!1;this.searchTerm!==r?(this.searchTerm&&0===e.indexOf(this.searchTerm)?o=!0:(this.searchTerm=r,this.delete()),this.resultPage=0,this.hasMoreMsgs=!0):o=!0;var a=new b.default.UiAction({uiActionType:b.default.UI_ACTION_TYPE.IMAGE_OPEN,uiActionPreloaded:o});if(this.searchPromise){if(this.searchTerm===r)return this.searchPromise;this.searchPromise.cancel()}var s=void 0;return s=t?t.fts(e,++this.resultPage,100):m.default.search(e,++this.resultPage,100,void 0,n),this.searchPromise=s.cancellable().then(function(e){e.eof&&(i.hasMoreMsgs=!1),i.searchTerm!==r&&i.delete(),i.searchTerm=r,e.messages&&i.add(e.messages.filter(function(e){return!e.isRevoked})),a.markUiActionT(),a.commit()}).catch(y.WapDrop,Promise.CancellationError,function(){}).finally(function(){i.searchPromise=null,i.trigger("searchPromise_update")}),this.trigger("searchPromise_update"),this.searchPromise}}]),t}(l.default);O.model=p.default,t.default=O},daejhdfjb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){return t in L[e||"EMPTY"]}Object.defineProperty(t,"__esModule",{value:!0});var c,l,f,d,h,p,g,y=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),v=i("dcaifjegcg"),b=n(v),_=i("dghjhchjic"),m=n(_),O=i("gbfffciea"),E=n(O),P=i("bjigbaghc"),T=n(P),j=i("cgejjichfa"),C=i("hgeacfdgi"),S=n(C),M=i("ccaaiecfib"),w=n(M),k=i("bhgjacgcdd"),A=n(k),I=function(e){function t(){var e,i,n,r;o(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,v.prop)(),n.peerJid=(0,v.prop)(),n.offerTime=(0,v.prop)(),n.startTime=(0,v.prop)(),n.isVideo=(0,v.prop)(!1),n.isGroupCall=(0,v.prop)(!1),n.canHandleLocally=(0,v.prop)(!1),n.outgoing=(0,v.prop)(!1),n.webClientShouldHandle=(0,v.prop)(!1),n.participants=(0,v.collection)(m.default),n._state=(0,v.prop)(),r=i,a(n,r)}return s(t,e),y(t,[{key:"getState",value:function(){return this._state}},{key:"setState",value:function(e){var t=e;u(this._state,t)&&(this.webClientShouldHandle||t===j.CALL_STATES.INCOMING_RING||(t=j.CALL_STATES.HANDLED_REMOTELY,S.default.callId===this.id&&A.default.callEndByHandledRemotely()),this._state!==j.CALL_STATES.CONNECTION_LOST&&t===j.CALL_STATES.ACTIVE&&(this.startTime=Date.now()),this._state=t,this.handleNotification(),this.potentiallyUpdateCallUi())}},{key:"handleNotification",value:function(){var e=this.getState();T.default.tosShowCallNotification&&this.peerJid&&(e===j.CALL_STATES.INCOMING_RING?E.default.alertCall(this.peerJid,this.id,this.isVideo,this.canHandleLocally):E.default.cancelCall(this.peerJid))}},{key:"potentiallyUpdateCallUi",value:function(){S.default.callId===this.id?this.setCallUiProps():!S.default.callId&&this.getState()===j.CALL_STATES.INCOMING_RING&&w.default.supportsFeature(w.default.F.VOIP_INDIVIDUAL_INCOMING)&&this.canHandleLocally&&(S.default.callId=this.id,this.setCallUiProps())}},{key:"setCallUiProps",value:function(){S.default.type=this.isVideo?C.CALL_TYPES.VIDEO:C.CALL_TYPES.VOICE,S.default.state=this.getUiState(),S.default.to=this.outgoing?this.peerJid:T.default.me,S.default.from=this.outgoing?T.default.me:this.peerJid,S.default.startTime=this.startTime,S.default.outgoing=this.outgoing,S.default.state===C.CALL_UI_STATES.ENDED&&(S.default.peerBusy=!1)}},{key:"getUiState",value:function(){switch(this.getState()){case j.CALL_STATES.INCOMING_RING:return C.CALL_UI_STATES.INCOMING_RING;case j.CALL_STATES.OUTGOING_RING:return C.CALL_UI_STATES.OUTGOING_RING;case j.CALL_STATES.OUTGOING_CALLING:return C.CALL_UI_STATES.OUTGOING_CALLING;case j.CALL_STATES.CONNECTING:return C.CALL_UI_STATES.CONNECTING;case j.CALL_STATES.CONNECTION_LOST:return C.CALL_UI_STATES.RECONNECTING;case j.CALL_STATES.ACTIVE:return C.CALL_UI_STATES.ACTIVE;case j.CALL_STATES.HANDLED_REMOTELY:return C.CALL_UI_STATES.NONE;case j.CALL_STATES.ENDED:return C.CALL_UI_STATES.ENDED;case j.CALL_STATES.REJECTED:return C.CALL_UI_STATES.REJECTED;case j.CALL_STATES.REMOTE_CALL_IN_PROGRESS:return C.CALL_UI_STATES.REMOTE_CALL_IN_PROGRESS;case j.CALL_STATES.FAILED:return C.CALL_UI_STATES.FAILED;default:return C.CALL_UI_STATES.NONE}}}]),t}(b.default);I.Collection="Call",I.Proxy="call",t.default=(0,v.defineModel)(I);var L={EMPTY:(c={},r(c,j.CALL_STATES.INCOMING_RING,!0),r(c,j.CALL_STATES.OUTGOING_CALLING,!0),r(c,j.CALL_STATES.CONNECTING,!0),r(c,j.CALL_STATES.REJECTED,!0),r(c,j.CALL_STATES.HANDLED_REMOTELY,!0),r(c,j.CALL_STATES.ENDED,!0),r(c,j.CALL_STATES.FAILED,!0),c),INCOMING_RING:(l={},r(l,j.CALL_STATES.HANDLED_REMOTELY,!0),r(l,j.CALL_STATES.CONNECTING,!0),r(l,j.CALL_STATES.ACTIVE,!0),r(l,j.CALL_STATES.REJECTED,!0),r(l,j.CALL_STATES.ENDED,!0),r(l,j.CALL_STATES.REMOTE_CALL_IN_PROGRESS,!0),r(l,j.CALL_STATES.FAILED,!0),l),OUTGOING_CALLING:(f={},r(f,j.CALL_STATES.OUTGOING_RING,!0),r(f,j.CALL_STATES.CONNECTING,!0),r(f,j.CALL_STATES.ENDED,!0),r(f,j.CALL_STATES.FAILED,!0),f),OUTGOING_RING:(d={},r(d,j.CALL_STATES.ACTIVE,!0),r(d,j.CALL_STATES.REJECTED,!0),r(d,j.CALL_STATES.ENDED,!0),r(d,j.CALL_STATES.FAILED,!0),d),CONNECTING:(h={},r(h,j.CALL_STATES.OUTGOING_RING,!0),r(h,j.CALL_STATES.ACTIVE,!0),r(h,j.CALL_STATES.ENDED,!0),r(h,j.CALL_STATES.REMOTE_CALL_IN_PROGRESS,!0),r(h,j.CALL_STATES.FAILED,!0),h),CONNECTION_LOST:(p={},r(p,j.CALL_STATES.ACTIVE,!0),r(p,j.CALL_STATES.ENDED,!0),r(p,j.CALL_STATES.FAILED,!0),p),ACTIVE:(g={},r(g,j.CALL_STATES.ENDED,!0),r(g,j.CALL_STATES.FAILED,!0),r(g,j.CALL_STATES.CONNECTION_LOST,!0),g),HANDLED_REMOTELY:{},ENDED:{},REJECTED:{},REMOTE_CALL_IN_PROGRESS:{},FAILED:{}}},dagdiahdfi:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("cgcgbfbffj"),c=n(u),l=i("bjigbaghc"),f=n(l),d=i("bdiiahhjbe"),h=n(d),p=i("bhggeigghg"),g=n(p),y=i("dhadcigcaf"),v=n(y),b=i("bebehddcbc"),_=n(b),m=!0,O=!0,E=!0,P=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"initializeFromCache",value:function(e){this.add(e),this.setGlobalNotifications(_.default.getGlobalNotifications()),this.setGlobalSounds(_.default.getGlobalSounds()),this.setGlobalPreviews(_.default.getGlobalPreviews())}},{key:"saveToCache",value:function(){if(f.default.me){var e=this.constructor.cachePolicy.id;h.default.log("models:mute:cache-save: "+String(e))(),_.default.setCollection(e,[this.globalMute().toJSON()])}}},{key:"globalMute",value:function(){var e=this.get(y.GLOBAL_MUTE);return e||this.add({id:y.GLOBAL_MUTE})[0]}},{key:"getGlobalSounds",value:function(){return m}},{key:"setGlobalSounds",value:function(e){m=e,_.default.setGlobalSounds(e)}},{key:"getGlobalNotifications",value:function(){return O}},{key:"setGlobalNotifications",value:function(e){O=e,_.default.setGlobalNotifications(e)}},{key:"getGlobalPreviews",value:function(){return E}},{key:"setGlobalPreviews",value:function(e){E=e,_.default.setGlobalPreviews(e)}},{key:"handle",value:function(e){e.forEach(function(e){var t=g.default.Chat.get(e.id);t&&"mute"===e.type&&t.mute.setMute(e.muteExpiration)})}}]),t}(c.default);P.model=v.default,P.cachePolicy={id:"mute",policy:u.CACHE_POLICY.LOAD,delay:1e3},t.default=new P},dbbaabdabi:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ConversionTupleExpiry=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("bjebjijbfc"),d=n(f),h=i("djheacfeif"),p=n(h),g=i("bdiiahhjbe"),y=n(g),v=i("dbajccegac"),b=n(v),_=i("jccfhaecf"),m=n(_),O=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,c.prop)(),n.conversionData=(0,c.prop)(),n.conversionSource=(0,c.prop)(),n.timestamp=(0,c.prop)(function(){return d.default.globalUnixTime()}),n.alarmId=(0,c.session)(),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.listenTo(this,"change:timestamp",this._setExpiryTimer),this._setExpiryTimer()}},{key:"_setExpiryTimer",value:function(){var e=this,t=this.timestamp+604800;if(t<0)return y.default.error("Invalid conversionTuple timer")(),void this.delete();this.alarmId=p.default.setLocalTimeout(function(){e.delete()},1e3*t,this.alarmId)}},{key:"_clearAlarm",value:function(){this.alarmId&&(p.default.clearTimeout(this.alarmId),this.alarmId=void 0)}},{key:"elapsedSeconds",value:function(){return d.default.globalUnixTime()-this.timestamp}},{key:"formatTuple",value:function(){var e={conversionDelaySeconds:this.elapsedSeconds()};return this.conversionData&&(e.conversionData=this.conversionData),this.conversionSource&&(e.conversionSource=this.conversionSource),e}},{key:"toJSON",value:function(){var e=this.serialize(),t=e.conversionData;if(t instanceof ArrayBuffer){var i=new b.default(t);e.conversionData=i.readString(t.byteLength)}return e}},{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this._clearAlarm()}}]),t}(l.default);O.Collection="ConversionTuple",O.Proxy="conversionTuple",O.idClass=m.default,t.default=(0,c.defineModel)(O),t.ConversionTupleExpiry=604800},dbdfbgehgj:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("hbhijdici"),f=r(l),d=i("cajijabhgb"),h=n(d),p=i("ebggjhghhi"),g=n(p),y=i("cgcgbfbffj"),v=r(y),b=i("ebjaejiaba"),_=r(b),m=i("dfjfgdhbjj"),O=r(m),E=i("bjigbaghc"),P=r(E),T=i("eadfaddcj"),j=r(T),C=i("bihjahgcja"),S=r(C),M=i("bijffg"),w=r(M),k=i("bdiiahhjbe"),A=r(k),I=i("ccgjijjbbj"),L=r(I),R=i("bechejbabh"),N=r(R),D=i("jdigiabic"),F=r(D),G=i("eacidghfgh"),U=r(G),x=i("fagbfehid"),Y=r(x),B=i("bhggeigghg"),V=r(B),q=i("bebehddcbc"),W=r(q),H=i("jccfhaecf"),K=r(H),z=i("bgabieacgg"),Q=i("dgacffdjd"),J=i("cjjjhbdicf"),X=i("dfdebdgdei"),Z=i("ebffbebefe"),$=i("dcjbdhhjge"),ee=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.notSpam={},e.promises={sendUnstarAll:null,initializeRestFromTabletCache:null},e.keysForResyncMsgs=void 0,e._sortEnabled=!1,e.enableSortListener(),e.listenTo(U.default,"change:stream",function(){U.default.stream===G.STREAM.RESUMING&&e.forEach(function(e){e.pendingMsgs=!1})}),e.listenToOnce(e,"sort",f.default.debounce(e.setIndexes,100)),e}return s(t,e),u(t,[{key:"enableSortListener",value:function(e){this._sortEnabled||(this.listenTo(this,"change:t change:pin change:isVisible",this.sort),e&&this.sort(),this._sortEnabled=!0)}},{key:"disableSortListener",value:function(){this._sortEnabled&&(this.stopListening(null,null,this.sort),this._sortEnabled=!1)}},{key:"setIndexes",value:function(){this.forEach(function(e,t){e.initialIndex=t})}},{key:"active",value:function(){var e=f.default.head(this.filter(function(e){return e.active}));return e||void 0}},{key:"_find",value:function(e){return Promise.resolve({id:e,createdLocally:!0})}},{key:"_findQuery",value:function(e){var t=this,i={};return(0,z.find)(!!e.retry,i).then(function(e){return"preempted"===e?Promise.reject("chats preempted"):(P.default.platform===E.PLATFORMS.IPHONE&&(f.default.isEmpty(e)?V.default.Msg.trigger(j.default.COLLECTION_HAS_SYNCED):setTimeout(function(){V.default.Msg.trigger(j.default.COLLECTION_HAS_SYNCED)},2500)),t.trigger(j.default.COLLECTION_HAS_SYNCED,i),Promise.resolve(e))})}},{key:"sync",value:function(){return this.findQuery({}).catch(h.WapDrop,function(){}),Promise.all([g.waitForBBEvent(this,j.default.COLLECTION_HAS_SYNCED),V.default.Msg._hasSynced()])}},{key:"getKeysForResyncMsgs",value:function(){return this.filter(function(e){return e.isVisible}).map(function(e){var t=e.getAckedPhoneProps(),i=e.lastReceivedKey;return i&&(t.id=i.id,t.fromMe=i.fromMe.toString(),t.participant=i.participant),t})}},{key:"setKeysForResyncMsgs",value:function(e){this.keysForResyncMsgs=e}},{key:"resetKeysForResyncMsgs",value:function(){this.keysForResyncMsgs=void 0}},{key:"resyncMessages",value:function(){var e=this;A.default.log("ChatStore:resyncMessages")();var t=this.keysForResyncMsgs||this.getKeysForResyncMsgs();return(0,J.resyncMessages)(t).then(function(t){return t.status>=400?(A.default.error("ChatStore:resyncMessages resume error "+t.status)(),Promise.reject(new Error("ChatStore:resyncMessages resume error "+t.status))):(A.default.log("ChatStore:resyncMessages resume success")(),(e.keysForResyncMsgs&&e.promises.initializeRestFromTabletCache?e.promises.initializeRestFromTabletCache:Promise.resolve()).then(function(){t.checksum&&(0,Q.resyncContacts)(t.checksum),t.statusChecksum&&V.default.StatusV3.sync(t.statusChecksum),t.quickRepliesChecksum&&N.default.sync(t.quickRepliesChecksum),t.labelsChecksum&&w.default.sync(t.labelsChecksum),t.stickerPackChecksum&&Y.default.sync(t.stickerPackChecksum),null!=t.recentStickersChecksum&&F.default.sync(t.recentStickersChecksum),e.disableSortListener(),t.data.forEach(function(t){if(t.disableUnreadAnchor=!1,t.firstUnreadKey=void 0,t.keys&&1===t.keys.length){var i=t.keys[0];t.firstUnreadKey=new L.default({id:i[0],fromMe:i[1],participant:i[2],remote:t.id})}if("delete"!==t.type&&!K.default.isPSA(t.id)){var n=V.default.Contact.get(t.id);if(n){if(t.name){var r={name:t.name};(0,$.updateLocal)(n.id,r).then(function(){n.set(r)})}}else V.default.Contact.add({id:t.id,name:t.name})}var o=e.get(t.id);if(!o)return void e.add(t);if("clear"===t.type){o.resetMediaMsgs();var a=[];o.msgs.forEach(function(e){return a.push(e)}),o.msgChunks.length&&o.msgChunks.forEach(function(e){e.forEach(function(e){return a.push(e)})}),o.set({t:t.t,unreadCount:t.unreadCount,createdLocally:!1,archive:t.archive,isReadOnly:t.isReadOnly,modifyTag:t.modifyTag,msgs:[],notSpam:t.notSpam,unreadMsgAnchor:void 0,disableUnreadAnchor:t.disableUnreadAnchor,pendingMsgs:t.pendingMsgs,pin:t.pin,changeNumberOldJid:t.changeNumberOldJid,changeNumberNewJid:t.changeNumberNewJid,muteExpiration:t.muteExpiration}),f.default.each(a,function(e){e.delete()}),A.default.log("model:chat:resume: cleared chat for "+t.id)()}else"delete"===t.type?(o.delete(),A.default.log("model:chat:resume: deleted chat for "+t.id)()):o.set(t,{merge:!0})})}).finally(function(){e.enableSortListener(!0)}))}).catch(h.WapDrop,function(e){return A.default.error("ChatStore:resyncMessages resume dropped")(),Promise.reject(e)}).finally(function(){e.resetKeysForResyncMsgs()})}},{key:"unstarAllMessages",value:function(e,t){return(0,Z.unstarAllMessages)(e,t)}},{key:"forwardMessagesToChats",value:function(e,t){var n=i("dgjddffcfg"),r=Promise.map(e,function(e){return Promise.props({message:e,canForward:e.canForward()})});return Promise.map(t,function(e){var t=void 0;return t=e.isUser&&e.contact.isBlocked()?(0,X.unblockContact)(e.contact):Promise.resolve(!0),Promise.all([r,t]).spread(function(t,i){var n=f.default.map(f.default.filter(t,{canForward:!0}),"message"),r=f.default.map(f.default.filter(t,{canForward:!1}),"message");return Promise.props({chat:e,undelivered:e.forwardMessages(n,!0),canForward:n,cannotForward:r})})}).then(function(e){var t=f.default.compact(e.map(function(e){var t=e.chat,i=e.undelivered,r=e.canForward,o=e.cannotForward,a=null;return(i.length||o.length)&&(a=n.formatForwardError({chat:t,undelivered:i,canForward:r,cannotForward:o})),a?{chat:t,reason:a}:null}));if(t.length)throw new S.default(t);return!0})}},{key:"saveToCache",value:function(){if(P.default.me){var e=t.cachePolicy.id;A.default.log("ChatCollection:saveToCache save: "+String(e))();var i=this.map(function(e,t){var i=e.toJSON(),n=t<20?Math.min(e.unreadCount+20,50):Math.min(Math.max(3,e.unreadCount),20);return i.msgs=e.msgs?e.msgs.slice(-n).map(function(e){return f.default.pickBy(e.toJSON(),function(e){return void 0!==e})}):[],i});W.default.setCollection(e,i,!0)}}},{key:"onResume",value:function(){var e=this.active();e&&e.presence.subscribe()}},{key:"delete",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.listenToOnce(this,"sort",f.default.debounce(this.setIndexes,100))}}]),t}(v.default);ee.model=_.default,ee.comparator=O.default,ee.cachePolicy={id:"chat",policy:y.CACHE_POLICY.IMMEDIATE,trigger:"add sort remove reset change:id change:t change:unreadCount change:archive change:isReadOnly change:isAnnounceGrpRestrict change:modifyTag change:muteExpiration change:name change:notSpam change:pin change:changeNumberOldJid change:changeNumberNewJid change:lastReceivedKey change:msg:ack msgs:loadEarlier"},t.default=new ee},dbefiahjgi:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return new P({deviceSentMessage:new P.DeviceSentMessage({destinationJid:t.toString({legacy:!0}),message:e})})}function o(e,t){var i=a(e),n=void 0;if(i.quotedMsg){var r=i.quotedMsg.mentionedJidList,o=Array.isArray(r)&&r.length>0?{mentionedJid:r.map(c)}:void 0;o&&(o=new T(o)),n={stanzaId:i.quotedStanzaID,remoteJid:c(i.quotedRemoteJid),participant:c(i.quotedParticipant),quotedMessage:s(i.quotedMsg,{duration:i.quotedMsg.duration,encFilehash:i.quotedMsg.uploadhash,filehash:i.quotedMsg.filehash,height:i.quotedMsg.height,mediaKey:i.quotedMsg.mediaKey,mimetype:i.quotedMsg.mimetype,url:i.quotedMsg.clientUrl,width:i.quotedMsg.width},o)}}else i.quotedRemoteJid&&(n={remoteJid:c(i.quotedRemoteJid)});if(i.mentionedJidList&&i.mentionedJidList.length>0){var u=i.mentionedJidList;n=n||{},n.mentionedJid=u.map(c)}return i.conversionTuple&&(n=n||{},Object.assign(n,i.conversionTuple)),i.isForwarded&&(n=n||{},n.isForwarded=i.isForwarded),i.forwardingScore&&(n=n||{},n.forwardingScore=i.forwardingScore),n&&(n=new T(n)),s(i,t,n)}function a(e){var t=e.id,i=e.toJSON();delete i.status,delete i.mimetype,delete i.height,delete i.width,delete i.recipients,delete i.chat,delete i.broadcast,delete i.ack,delete i.invis,delete i.filehash,delete i.recvFresh,delete i.mediaData,g.default.isHttp(e.clientUrl)||delete i.clientUrl;for(var n in i)null==i[n]&&delete i[n];"chat"!==i.type||"url"!==i.subtype||v.default.supportsFeature(v.default.F.URL)||delete i.subtype,i.quotedMsg&&!v.default.supportsFeature(v.default.F.REPLIES_OUT)&&(delete i.quotedMsg,delete i.quotedStanzaID,delete i.quotedRemoteJid,delete i.quotedParticipant),i.mentionedJidList&&!v.default.supportsFeature(v.default.F.MENTIONS_OUT)&&delete i.mentionedJidList;var r=h.default.get(t.remote);return r&&(i.conversionTuple=r.toJSON()),i}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=new P,r=e.mimetype||t.mimetype||void 0,o=t.duration;switch(e.type){case"chat":"url"===e.subtype||e.quotedMsg||e.quotedRemoteJid||Array.isArray(e.mentionedJidList)&&e.mentionedJidList.length>0||e.conversionTuple||e.isForwarded||e.forwardingScore||e._isPaymentNoteMsg?n.extendedTextMessage=new P.ExtendedTextMessage({text:e.body,matchedText:e.matchedText,canonicalUrl:e.canonicalUrl,description:e.description,title:e.title,jpegThumbnail:l(e.thumbnail),previewType:e.richPreviewType,contextInfo:i}):n.conversation=e.body;break;case"groups_v4_invite":n.groupInviteMessage=new P.GroupInviteMessage({inviteCode:e.inviteCode,inviteExpiration:parseInt(e.inviteCodeExp,10),groupJid:e.inviteGrp,groupName:e.inviteGrpName,caption:e.comment,jpegThumbnail:l(e.inviteGrpJpegThum)});break;case"sticker":n.stickerMessage=new P.StickerMessage({url:t.url,mimetype:t.mimetype,fileSha256:l(t.filehash),fileEncSha256:l(t.encFilehash),mediaKey:l(t.mediaKey),fileLength:(0,m.isNumber)(e.size)?e.size:void 0,height:e.height,width:e.width,pngThumbnail:l(e.pngThumbnail),contextInfo:i});break;case"location":var a=new P.LocationMessage({degreesLatitude:parseFloat(e.lat)||void 0,degreesLongitude:parseFloat(e.lng)||void 0,jpegThumbnail:l(e.body),contextInfo:i});if(e.loc&&(0,m.isString)(e.loc)&&e.clientUrl){var u=e.loc.split("\n");a.name=u[0],a.address=u[1],a.url=e.clientUrl}n.locationMessage=a;break;case"vcard":n.contactMessage=new P.ContactMessage({displayName:e.subtype,vcard:e.body,contextInfo:i});break;case"multi_vcard":n.contactsArrayMessage=new P.ContactsArrayMessage({displayName:e.subtype,contacts:e.vcardList.map(function(e){return new P.ContactMessage(e)}),contextInfo:i});break;case"image":n.imageMessage=new P.ImageMessage({url:t.url,mimetype:r,caption:e.caption,fileSha256:l(t.filehash),fileEncSha256:l(t.encFilehash),height:t.height,width:t.width,fileLength:(0,m.isNumber)(e.size)?e.size:void 0,mediaKey:l(t.mediaKey),jpegThumbnail:l(e.body),contextInfo:i});break;case"product":n.productMessage=new P.ProductMessage({product:new P.ProductMessage.ProductSnapshot({productImage:new P.ImageMessage({url:t.url,mimetype:r,caption:e.caption,fileSha256:l(t.filehash),fileEncSha256:l(t.encFilehash),height:t.height,width:t.width,fileLength:(0,m.isNumber)(e.size)?e.size:void 0,mediaKey:l(t.mediaKey),jpegThumbnail:l(e.body)}),productId:e.productId,title:e.title,description:e.description,currencyCode:e.currencyCode,priceAmount1000:e.priceAmount1000,retailerId:e.retailerId,url:e.url,productImageCount:e.productImageCount,pseudoReply:e.pseudoReply}),businessOwnerJid:e.businessOwnerJid,contextInfo:i});break;case"document":var f=new P.DocumentMessage({url:t.url,mimetype:r,title:e.caption,fileSha256:l(t.filehash),fileEncSha256:l(t.encFilehash),fileName:t.filename,fileLength:(0,m.isNumber)(e.size)?e.size:void 0,mediaKey:l(t.mediaKey),jpegThumbnail:l(e.body),contextInfo:i});(0,m.isNumber)(e.pageCount)&&!isNaN(e.pageCount)&&(f.pageCount=e.pageCount),n.documentMessage=f;break;case"ptt":case"audio":o=(0,m.isString)(o)?parseInt(o,10):o,n.audioMessage=new P.AudioMessage({url:t.url,mimetype:r,fileSha256:l(t.filehash),fileEncSha256:l(t.encFilehash),seconds:o,ptt:"ptt"===e.type,fileLength:(0,m.isNumber)(e.size)?e.size:void 0,mediaKey:l(t.mediaKey),contextInfo:i,streamingSidecar:e.streamingSidecar});break;case"video":o=(0,m.isString)(o)?parseInt(o,10):o,n.videoMessage=new P.VideoMessage({url:t.url,mimetype:r,fileSha256:l(t.filehash),fileEncSha256:l(t.encFilehash),height:t.height,width:t.width,seconds:o,caption:e.caption,fileLength:(0,m.isNumber)(e.size)?e.size:void 0,mediaKey:l(t.mediaKey),jpegThumbnail:l(e.body),gifPlayback:e.isGif,gifAttribution:e.gifAttribution,contextInfo:i,streamingSidecar:e.streamingSidecar});break;case"protocol":if("revoke"===e.subtype){var d=e.protocolMessageKey;n.protocolMessage=new P.ProtocolMessage({type:P.ProtocolMessage.TYPE.REVOKE,key:new C({remoteJid:c(d.remote),fromMe:d.fromMe,id:d.id,participant:c(d.participant)})})}break;case"payment":var h={};h.stanzaId=e.quotedStanzaID,h.mentionedJid=e.mentionedJidList&&e.mentionedJidList.map(c),h.isForwarded=e.isForwarded,h.forwardingScore=e.forwardingScore,h.participant=c(e.quotedParticipant),e.quotedMsg&&(h.quotedMessage=s(e.quotedMsg));var p=e.paymentNoteMsg?s(Object.assign(e.paymentNoteMsg,{_isPaymentNoteMsg:!0}),h):void 0;switch(e.subtype){case"send":var g=e.paymentRequestMessageKey?new C({fromMe:e.paymentRequestMessageKey.fromMe,remoteJid:c(e.paymentRequestMessageKey.remote),id:e.paymentRequestMessageKey.id,participant:c(e.paymentRequestMessageKey.participant)}):void 0;n.sendPaymentMessage=new P.SendPaymentMessage({requestMessageKey:g,noteMessage:p});break;case"request":n.requestPaymentMessage=new P.RequestPaymentMessage({amount1000:e.amount1000,expiryTimestamp:e._paymentExpiryTimestamp,requestFrom:e._paymentRequestFrom,currencyCodeIso4217:e._currencyCodeIso4217,noteMessage:p})}}return n}function u(e){return new C({remoteJid:c(e.to),fromMe:!0,id:e.id.id})}function c(e){return e instanceof _.default?e.toString({legacy:!0}):(0,m.isString)(e)?e.replace(/@c.us$/,"@s.whatsapp.net"):void 0}function l(e){return e?O.decode(e):void 0}function f(e){if(e.deviceSentMessage){var t=e.deviceSentMessage.message;return t?f(t):null}return e.imageMessage?"image":e.stickerMessage?"sticker":e.locationMessage?"livelocation":e.contactMessage?"vcard":e.contactsArrayMessage?"contact_array":e.imageMessage?"image":e.documentMessage?"document":e.audioMessage?e.audioMessage.ptt?"ptt":"audio":e.videoMessage?e.videoMessage.gifPlayback?"gif":"video":null}Object.defineProperty(t,"__esModule",{value:!0}),t.createDeviceSentMessage=r,t.createMsgProtobuf=o,t.createMsgKey=u,t.mediaTypeFromProtobuf=f;var d=i("ccbihadedf"),h=n(d),p=i("edbaidcaf"),g=n(p),y=i("ccaaiecfib"),v=n(y),b=i("jccfhaecf"),_=n(b),m=i("hjbbdjjdf"),O=i("hgjcbccfg"),E=i("bgiachiigg"),P=E.Message,T=E.ContextInfo,j=i("bfifcddbbg"),C=j.MessageKey},dbfjecijha:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgLoadState=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("cbcbdjdah"),d=n(f),h=i("bhggeigghg"),p=n(h),g=i("cgcgbfbffj"),y=n(g),v=i("cgeeeeddea"),b=n(v),_=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.noEarlierMsgs=(0,c.prop)(),n.isLoadingEarlierMsgs=(0,c.prop)(),n.isLoadingRecentMsgs=(0,c.prop)(),n.isLoadingAroundMsgs=(0,c.prop)(),n.contextLoaded=(0,c.prop)(),a=i,o(n,a)}return a(t,e),t}(l.default);_.Proxy="msgLoad";var m=t.MsgLoadState=(0,c.defineModel)(_),O=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.msgLoadState=new m({noEarlierMsgs:!1,isLoadingEarlierMsgs:!1,isLoadingRecentMsgs:!1,isLoadingAroundMsgs:!1,contextLoaded:!1}),e.listenTo(e,"add remove reset sort",e.triggerChangeLast),e}return a(t,e),s(t,[{key:"delete",value:function(){this.stopListening(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.msgLoadState.delete()}},{key:"triggerChangeLast",value:function(e,t,i){var n=this.last();if(this._last!==n){this._last=n;var r=!1;t&&t.indexOf(e)>-1&&i&&i.add&&!i.remove&&(r=!0),this.trigger("change:last",n,r)}}},{key:"add",value:function(e,i){var n=this,r=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e,i);return p.default.Msg.add(r,i).forEach(function(e){e&&n.isModel(e)&&(e.msgChunk=n)}),r&&this.trigger("bulk_add",r,i),r}},{key:"remove",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this,e,i),o=!!i&&i.silent,a=r.filter(function(e){return!!e});return a.length&&!o&&(this.trigger("remove_msgs",a,i),n||this.trigger("update_sort_time")),r}},{key:"replace",value:function(e){var t=this;this.msgLoadState=e.msgLoadState,this.loadRecentPromise=e.loadRecentPromise,this.loadEarlierPromise=e.loadEarlierPromise,this.loadAroundPromise=e.loadAroundPromise;var i=e.getModelsArray();this.set(i,{silent:!0,merge:!1}),i.forEach(function(e){t.isModel(e)&&(e.msgChunk=t)}),this.trigger("bulk_add",i)}},{key:"onMsgLoadStateChange",value:function(e){var t=this,i=void 0,n=function(){e()},r=function(){(0,b.default)(null!=i,"prevMsgLoadState cannot be null after bulk_add"),i.off("change",n);var r=t.msgLoadState;r.on("change",n),i=r,e()};i=this.msgLoadState,i.on("change",n),this.on("bulk_add",r);var o=function(){(0,b.default)(null!=i,"prevMsgLoadState cannot be null when unsubscribing"),t.off("bulk_add",r),i.off("change",n)};return function(){var e=o;e&&(o=null,e())}}}]),t}(y.default);O.model=d.default,t.default=O},dbjacfjdhg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("hbhijdici"),l=n(c),f=i("biheibdage"),d=n(f),h=i("cgcgbfbffj"),p=n(h),g=i("eadfaddcj"),y=n(g),v=i("cajijabhgb"),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(v),_=i("cieaaiahhf"),m=n(_),O=i("bbcjhfahhb"),E=n(O),P=i("bfgbdiffgd"),T=n(P),j=i("dcaibchbg"),C=n(j),S=i("cgffhfegce"),M=S.FILETYPE.IMAGE,w=S.FILETYPE.VIDEO,k=S.FILETYPE.DOCUMENT,A=S.FILETYPE.AUDIO,I=f.ATTACH_MEDIA_STATE.READY,L=f.ATTACH_MEDIA_STATE.ERROR,R=f.ATTACH_MEDIA_STATE.PROCESSING,N=1,D=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.errorMsgs=null,e.ignored=0,e.mediaPickerStatsLogger=new E.default,e.selection=new C.default([],function(e){return e.id},"prev"),e.listenTo(e.selection,"all",e._handleSelectionEvents.bind(e)),e}return a(t,e),s(t,[{key:"_handleSelectionEvents",value:function(e,t){"focus"!==t&&!1!==t||this.trigger("active-change")}},{key:"removeSingleton",value:function(e,t){e&&(t||this.mediaPickerStatsLogger.logDelete(e.id),e.url&&window.URL.revokeObjectURL(e.url),e.original&&e.original.url&&window.URL.revokeObjectURL(e.original.url))}},{key:"remove",value:function(e,i){var n=this,r=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this,e,i);return r.forEach(function(e){return n.removeSingleton(e,i)}),this.selection.init(this.getPreviewableMedias(),!0),r}},{key:"delete",value:function(){var e=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.forEach(function(t){return e.removeSingleton(t)}),this.selection.init(this.getPreviewableMedias(),!0)}},{key:"replace",value:function(e,t){var i=this.get(e);if(i){var n=this.indexOf(i),r=i.caption;this.remove(i,{silent:!0}),i.delete();var o=new d.default({id:e,caption:r,file:this._normalizeFile(t),chat:i.chat,uiProcessed:!1});return this.add(o,n?{at:n}:{}),o.processPromise}}},{key:"getValidMedias",value:function(){return this.filter(function(e){return e.state===I})}},{key:"getPreviewableMedias",value:function(){return this.filter(function(e){return e.previewable})}},{key:"getActive",value:function(){return this.selection.getVal()}},{key:"setActive",value:function(e){this.selection.setVal(e)}},{key:"unsetActive",value:function(){this.selection.unset()}},{key:"setNextAsActive",value:function(){var e=this.selection.list.length-1;return-1===this.selection.index||this.selection.index===e?this.selection.getVal():(this.selection.setNext(),this.selection.getVal())}},{key:"setPrevAsActive",value:function(){return-1===this.selection.index||0===this.selection.index?this.selection.getVal():(this.selection.setPrev(),this.selection.getVal())}},{key:"processFiles",value:function(e,t,i){var n=this,r=this.getPreviewableMedias().length,o=e.length+r>y.default.MAX_FILES?Math.max(y.default.MAX_FILES-r,0):e.length,a=e.length-o;0===o?a&&this.trigger("max_upload_limit",a):this.ignore(a);var s=e.slice(0,o).map(function(e){return new d.default({id:N++,file:n._normalizeFile(e),chat:t,uiProcessed:!1})});this.add(s);var u=this.getActive();return this.unsetActive(),Promise.all(e).then(function(){return n._attemptToSetNextActiveFromAdded(s,u)}),Promise.map(s,function(e){return e.processPromise}).then(function(){return n._attemptToSetNextActiveFromAdded(s,u)})}},{key:"_attemptToSetNextActiveFromAdded",value:function(e,t){if(!this.getActive()&&!l.default.some(this.getModelsArray(),{state:R,previewable:!1})){var i=l.default.find(e,function(e){return e.previewable});i||(i=t),this.selection.init(this.getPreviewableMedias()),i&&this.setActive(i)}}},{key:"_logMediaAdd",value:function(e){this.mediaPickerStatsLogger.chatRecipients||(this.mediaPickerStatsLogger.chatRecipients=e.chat.groupMetadata&&e.chat.groupMetadata.participants.length||1);var t=e.isGif?"gif":e.type;this.mediaPickerStatsLogger.logAdd(e.id,t,e.fileOrigin)}},{key:"_normalizeFile",value:function(e){return Promise.resolve(e).then(function(e){var t=void 0;return t=e instanceof File?{file:e,filename:e.name,mimetype:e.type,type:(0,S.typeFromMimetype)(e.type)}:e instanceof Blob?{file:e,mimetype:e.type,type:(0,S.typeFromMimetype)(e.type)}:e,!t.type&&t.mimetype&&(t.type=(0,S.typeFromMimetype)(t.mimetype)),t})}},{key:"ignore",value:function(e){e>0&&(this.ignored+=e)}},{key:"uiProcessMsgs",value:function(){var e=this,t=[],i=void 0,n=0,r=0,o=0,a=0,s=0,u=0,c=0,l=0,f=0,d=!1,h=l10n.filesize(T.default.media),p=l10n.filesize(T.default.maxFileSize);if(this.forEach(function(t){if(!t.uiProcessed&&(!i&&t.previewable&&(i=t,e._logMediaAdd(t)),t.state!==R&&(t.uiProcessed=!0,t.state===L)))if(t.exception instanceof m.default)switch(t.getFileType()){case M:n+=1;break;case w:r+=1;break;case A:o+=1;break;case k:a+=1}else if(t.exception instanceof b.MediaFileEmpty)switch(t.getFileType()){case M:s+=1;break;case w:u+=1;break;case A:c+=1;break;case k:l+=1}else t.exception instanceof b.MediaFileFailedLoad?d=!0:f+=1}),n>0&&t.push(l10n.t("image_too_big",{number:n,_plural:n,maxSize:h})),r>0&&t.push(l10n.t("video_too_big",{number:r,_plural:r,maxSize:h})),o>0&&t.push(l10n.t("audio_too_big",{number:o,_plural:o,maxSize:h})),a>0&&t.push(l10n.t("document_too_big",{number:a,_plural:a,maxSize:p})),s>0&&t.push(l10n.t("image_empty",{number:s,_plural:s})),u>0&&t.push(l10n.t("video_empty",{number:u,_plural:u})),c>0&&t.push(l10n.t("audio_empty",{number:c,_plural:c})),l>0&&t.push(l10n.t("document_empty",{number:l,_plural:l})),f>0&&t.push(l10n.t("files_not_supported",{number:f,_plural:f})),d&&(t=[],t.push(l10n.t("media_failed_load"))),t.length>1){t=[];var g=n+r+o+a,v=s+u+c+l,_=g+v+f;0===f?(0!==g&&t.push(l10n.t("files_too_big",{number:g,_plural:g,maxSize:p})),0!==v&&t.push(l10n.t("files_empty",{number:v,_plural:v}))):t.push(l10n.t("files_not_added",{number:_,_plural:_}))}this.errorMsgs=t.join(" "),this.ignore(this.getPreviewableMedias().length-y.default.MAX_FILES);var O=this.ignored;return this.ignored=0,O&&this.trigger("max_upload_limit",O),{errorMsgs:this.errorMsgs}}},{key:"canSend",value:function(){return!l.default.some(this.getModelsArray(),{state:R,previewable:!1})}}]),t}(p.default);D.model=d.default,t.default=D},dbjfahieed:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){switch(t.policy){case"LOAD":return new a.default(e,t);case"IMMEDIATE":return new l.default(e,t);case"NONE":return new u.default(e,t)}return new u.default(e,{id:"none",policy:"NONE"})}Object.defineProperty(t,"__esModule",{value:!0}),t.CACHE_POLICY_TYPE=void 0,t.createCachePolicy=r;var o=i("cgfdiahhcd"),a=n(o),s=i("cdbfiiicdg"),u=n(s),c=i("ijiafihgg"),l=n(c),f=i("bdfbccfifg");t.CACHE_POLICY_TYPE=f.CACHE_POLICY_TYPE},dcaifjegcg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=(0,l.convert)(e),i=(0,l.stateExtend)(w,t);if(e.Proxy){var n=(0,g.genMirrorMask)(t);i.prototype.mirrorMask=n,(0,S.default)(e.Proxy,t,n)}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.collection=t.derived=t.session=t.prop=void 0;var c=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i("bjcgjfiffb");Object.defineProperty(t,"prop",{enumerable:!0,get:function(){return l.prop}}),Object.defineProperty(t,"session",{enumerable:!0,get:function(){return l.session}}),Object.defineProperty(t,"derived",{enumerable:!0,get:function(){return l.derived}}),Object.defineProperty(t,"collection",{enumerable:!0,get:function(){return l.collection}}),t.defineModel=u;var f=i("hbhijdici"),d=n(f),h=i("cajijabhgb"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(h),g=i("jjbajibff"),y=n(g),v=i("gbfffciea"),b=n(v),_=i("cccehdaiaf"),m=n(_),O=i("bdiiahhjbe"),E=n(O),P=i("bhggeigghg"),T=n(P),j=i("hjbbdjjdf"),C=i("ceidcegjgi"),S=n(C),M=/^change:/,w=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(n.stale=(0,l.session)(),n.__fired=null,n.__changes=null,i._internalInitializationDoNotUse)return a(n);n.stale=e&&e.stale||n.getDefault("stale"),n.parent=i.parent,n.collection=i.collection,n._initDeriveds(),n._initCollections();var r=n.__defaults,s=r?d.default.assign({},r,e):e;return s&&!d.default.isEmpty(s)&&n.set(s,d.default.assign({silent:!0},i)),n.initialize(),n}return s(t,e),c(t,[{key:"initialize",value:function(){if(this.collection&&this.id&&!this.collection._model.prototype.isIdType(this.id))throw new Error("Model id:"+String(this.id)+" is wrong type");this._uiObservers=0,this.mirrorMask&&(this.mirror=new y.default(this))}},{key:"update",value:function(){return this.getCollection().update(this.id)}},{key:"find",value:function(){return this.getCollection().find(this.id)}},{key:"getCollection",value:function(){return this.Collection||E.default.assert(!1,"no-collection","baseState:getCollection Attempting to get a non existing collection")(),T.default[this.Collection]}},{key:"_refreshStaleModel",value:function(){!this._uiObservers&&this.stale||this.getCollection().find(this.id).catch(p.WapDrop,function(){})}},{key:"incObservers",value:function(e){if(this._uiObservers++,!e){i("deiciccchg").default.online&&this.stale&&(b.default.uiBusy?this.listenToOnce(b.default,"ui_idle",this._refreshStaleModel):this._refreshStaleModel())}}},{key:"decObservers",value:function(){this._uiObservers>0&&this._uiObservers--,0===this._uiObservers&&this.stopListening(b.default,"ui_idle",this._refreshStaleModel)}},{key:"hasObservers",value:function(){return this._uiObservers>0}},{key:"addChild",value:function(e,t){var i={};i[e]=t,this.set(i,{silent:!0}),this.listenTo(t,"all",this._getCachedEventBubblingHandler(e))}},{key:"get",value:function(e){return this[e]}},{key:"set",value:function(e,t,i){var n=i;return"string"==typeof e?this._set(e,t,n):(n=t,n&&n.merge?this._set(d.default.omitBy(e,d.default.isUndefined),n):this._set(e,n))}},{key:"_set",value:function(e,t,i){var n=this,o=i,a=!!this.__changes,s=void 0;(0,j.isString)(e)?s=this._setKV(e,t,o):(o=t,s=d.default.reduce(e,function(e,t,i){var r=n._setKV(i,t,o);return r&&e.push(r),e},[]));for(var u=0;s&&s.length>0;)!function(){if(u++>5)throw new Error("Circular derived properties / event listeners");var e=d.default.flatten(s),t=n._topo;if(!t)throw new Error("_topo unexpectedly undefined");var i=d.default.intersection(t,e);s=i.reduce(function(e,t,o){var a=n._setD(t,i.slice(o+1));return a&&e.push.apply(e,r(a)),e},[])}();if((!o||!o.silent)&&this.hasUnfiredChanges()){for(var c=this.__fired={},l=this._getChanges(),f=l.length;l.length;){var h=l.shift();if(!c[h]){c[h]=!0;var p=this._definition[h].evt;(this.isListening(p)||this.isListening("all"))&&this.trigger(p,this,this[h])}}(f&&this.isListening("change")||this.isListening("all"))&&this.trigger("change",this)}return a||(this.__changes&&(this.__changes=null),this.__fired&&(this.__fired=null)),this}},{key:"_setKV",value:function(e,t,i){if(this._collections[e])return void this[e].set(t,i);var n=this._definition[e];if(!n)return void(this[e]=t);if(n.attr===l.Attr.DERIVED)throw new Error("Attempting to directly set derived property: "+e);var r=n.sk;if(this[r]!==t){this[r]=t,this._getChanges().push(e),this.__fired&&(this.__fired[e]=!1);var o=this._deps;return o&&o[e]?o[e]:void 0}}},{key:"_setD",value:function(e,t){var i=this._definition[e],n=i.sk,r=i.fn.call(this);if(this[n]!==r&&(this[n]=r,this._getChanges().push(e),this.__fired&&(this.__fired[e]=!1),this._deps&&this._deps[e])){var o=d.default.difference(this._deps[e],t);if(o.length)return o}}},{key:"hasUnfiredChanges",value:function(){var e=this.__fired,t=this.__changes;if(!t)return!1;if(!e)return!0;for(var i=0;i<t.length;i++)if(!e[t[i]])return!0;return!1}},{key:"_getChanges",value:function(){return this.__changes||(this.__changes=[])}},{key:"_initDeriveds",value:function(){var e=this;d.default.forEach(this.__derived,function(t){e[e._definition[t].sk]=l.INIT})}},{key:"_initCollections",value:function(){var e=this;d.default.forOwn(this._collections,function(t,i){e[i]=new t(null,{parent:e})})}},{key:"unset",value:function(e,t){var i=Array.isArray(e)?e:[e];this.set(d.default.zipObject(i),t)}},{key:"clear",value:function(){this.unset([].concat(r(this.__props),r(this.__session)))}},{key:"delete",value:function(){this.stopListening()}},{key:"reset",value:function(){this.set(this.__defaults)}},{key:"toJSON",value:function(){return this.serialize()}},{key:"serialize",value:function(){for(var e=this,t={},i=0;i<this.__props.length;i++)t[this.__props[i]]=this[this.__props[i]];return d.default.forOwn(this._collections,function(i,n){t[n]=e[n].serialize()}),t}},{key:"getDefault",value:function(e){var t=this._definition[e];if(t){var i=t.default;return(0,j.isFunction)(i)?i():i}}},{key:"_getCachedEventBubblingHandler",value:function(e){return function(t,i,n){M.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],i,n):"change"===t&&this.trigger("change",this)}.bind(this)}}],[{key:"isIdType",value:function(e){return!!(this.idWhitelist&&this.idWhitelist.indexOf(e)>-1)||(this.idClass?e instanceof this.idClass:"string"==typeof e)}}]),t}(m.default);t.default=w},dcdiaahjj:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){switch(S.default.state){case C.STATE.TIMEOUT:return Y.TIMEOUT;case C.STATE.OPENING:return j.default.online?Y.OPENING:Y.OFFLINE;case C.STATE.PAIRING:return S.default.hasSynced?Y.RESUMING:Y.PAIRING;case C.STATE.CONNECTED:return S.default.stream!==C.STREAM.CONNECTED?S.default.hasSynced?Y.NORMAL:Y.SYNCING:Y.NORMAL;case C.STATE.UNLAUNCHED:case C.STATE.PROXYBLOCK:default:return Y.NORMAL}}function u(){if(!L.default.isLoggedIn()&&S.default.state!==C.STATE.PROXYBLOCK)return B.QR;var e=S.default.hasSynced;switch(S.default.state){case C.STATE.PROXYBLOCK:return B.PROXYBLOCK;case C.STATE.CONFLICT:return B.CONFLICT;case C.STATE.TOS_BLOCK:return B.TOS_BLOCK;case C.STATE.SMB_TOS_BLOCK:return B.SMB_TOS_BLOCK;case C.STATE.DEPRECATED_VERSION:return B.DEPRECATED_VERSION;case C.STATE.UNLAUNCHED:return B.SYNCING;case C.STATE.UNPAIRED_IDLE:case C.STATE.UNPAIRED:return B.QR;case C.STATE.OPENING:if(!j.default.online&&!S.default.hasSynced)return B.OFFLINE;default:return e||S.default.stream===C.STREAM.CONNECTED?B.MAIN:B.SYNCING}}function c(e,t){switch(t){case V.SHOW:return e;case V.HIDE:return S.default.hasSynced?Y.NORMAL:Y.CONNECTING;case V.OBSCURE:switch(e){case Y.OPENING:case Y.PAIRING:case Y.SYNCING:case Y.RESUMING:return Y.CONNECTING;default:return e}default:return g.default.error("Stream:unknown obscure level:",t)(),e}}Object.defineProperty(t,"__esModule",{value:!0}),t.StreamMode=t.StreamInfo=void 0;var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),f=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},d=i("eadfaddcj"),h=n(d),p=i("bdiiahhjbe"),g=n(p),y=i("dcaifjegcg"),v=n(y),b=i("bfbggcdbfb"),_=n(b),m=i("djbfbcedhj"),O=n(m),E=i("bhggeigghg"),P=n(E),T=i("deiciccchg"),j=n(T),C=i("eacidghfgh"),S=n(C),M=i("cbbhbjebii"),w=n(M),k=i("ceddibdhdb"),A=n(k),I=i("bebehddcbc"),L=n(I),R=i("cfgcdfcfee"),N=n(R),D=i("gbfffciea"),F=n(D),G=i("hbhijdici"),U=n(G),x=i("icbibjcg"),Y={OFFLINE:"OFFLINE",OPENING:"OPENING",PAIRING:"PAIRING",SYNCING:"SYNCING",RESUMING:"RESUMING",CONNECTING:"CONNECTING",NORMAL:"NORMAL",TIMEOUT:"TIMEOUT"},B={QR:"QR",MAIN:"MAIN",SYNCING:"SYNCING",OFFLINE:"OFFLINE",CONFLICT:"CONFLICT",PROXYBLOCK:"PROXYBLOCK",TOS_BLOCK:"TOS_BLOCK",SMB_TOS_BLOCK:"SMB_TOS_BLOCK",DEPRECATED_VERSION:"DEPRECATED_VERSION"};t.StreamInfo=Y,t.StreamMode=B;var V={SHOW:"SHOW",OBSCURE:"OBSCURE",HIDE:"HIDE"},q=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.info=(0,y.session)(Y.NORMAL),n.mode=(0,y.session)(B.SYNCING),n.obscurity=(0,y.session)(V.HIDE),n.needsUpdate=(0,y.session)(),n.clientExpired=(0,y.session)(!1),n.hardExpired=(0,y.session)(!1),n.couldForce=(0,y.session)(),n.uiActive=(0,y.session)(),n.available=(0,y.session)(!0),n.unavailableShiftTimer=(0,y.session)(),n.unavailableLogoutTimer=(0,y.session)(),n.unobscureShiftTimer=(0,y.session)(),n.timeoutEvent=(0,y.session)(),n.resumeCount=(0,y.session)(0),n.phoneAuthed=(0,y.session)(!1),n.displayInfo=(0,y.derived)(n._displayInfo,["info","obscurity"]),a=i,o(n,a)}return a(t,e),l(t,[{key:"_displayInfo",value:function(){return c(this.info,this.obscurity)}},{key:"initialize",value:function(){var e=this;f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),g.default.log("Stream:rememberMe: "+String(L.default.getRememberMe()))(),this.unavailableShiftTimer=new A.default(function(){return e.markUnavailable()}),this.unobscureShiftTimer=new A.default(function(){return e.unobscure()}),this.unavailableLogoutTimer=new A.default(function(){L.default.getRememberMe()||(g.default.log("Stream:unavailableLogoutTimer logout due to inactivity")(),S.default.logout())}),this.listenTo(S.default,"change:state change:stream change:hasSynced",this.onSocketUpdate),this.listenTo(j.default,"change:online",this.onSocketUpdate),this.listenTo(this,"change:available",this.onAvailableUpdate),this.listenTo(this,"change:phoneAuthed",this.onPhoneAuthedUpdate),this.listenTo(this,"change:info change:displayInfo change:mode",U.default.debounce(this.onSelfUpdate)),this.listenTo(this,"change:info",this.logPageResume),this.listenTo(this,"change:info",this.updateWamLog),this.listenTo(this,"change:mode",this.logModeChange),this.listenTo(this,"change:available change:uiActive",this.updateCouldForce),this.listenTo(F.default,"midnight",this.updateHardExpire.bind(this)),window.document&&document.addEventListener("visibilitychange",this.updateCouldForce),this.updateCouldForce(),this.updateHardExpire()}},{key:"delete",value:function(){}},{key:"markAvailable",value:function(){this.unavailableShiftTimer.cancel(),this.available=!0,O.default.monitor(!0,this.displayInfo===Y.TIMEOUT)}},{key:"markUnavailable",value:function(e){e?this.unavailableShiftTimer.onOrBefore(e):(this.unavailableShiftTimer.cancel(),this.available=!1,O.default.monitor(!1,this.displayInfo===Y.TIMEOUT))}},{key:"onSelfUpdate",value:function(){g.default.log("Stream:onSelfUpdate mode:"+this.mode+" info:"+this.info+" view:"+this.displayInfo)();var e=this.timeoutEvent;if(this.info===Y.TIMEOUT)e||(this.timeoutEvent=e=new _.default.WebcPhoneDisconnected),this.displayInfo!==Y.TIMEOUT||this._bbarTime||(this._bbarTime=Date.now());else if(e){e.markWebcPhoneDisconnectedT();var t=this._bbarTime;t&&(e.webcPhoneBbarShownT=Date.now()-t),e.commit(),this.timeoutEvent=null}}},{key:"onSocketUpdate",value:function(){var e={},t=s();if(e.info=t,e.mode=u(),e.phoneAuthed=S.default.stream!==C.STREAM.DISCONNECTED,t===Y.NORMAL)this.unobscureShiftTimer.cancel(),e.obscurity=V.HIDE;else if(t===Y.OFFLINE)this.unobscureShiftTimer.cancel(),e.obscurity=V.OBSCURE;else switch(this.obscurity){case V.HIDE:this.unobscureShiftTimer.onOrBefore(h.default.DIAGNOSTIC_DELAY);break;case V.OBSCURE:this.unobscureShiftTimer.onOrBefore(3e3);break;case V.SHOW:}this.set(e)}},{key:"unobscure",value:function(){this.obscurity=V.SHOW}},{key:"onPhoneAuthedUpdate",value:function(){this.phoneAuthed&&(this.sendAvailability(!0),P.default.RecentEmoji.sync())}},{key:"onAvailableUpdate",value:function(){var e=this.available;g.default.log("Stream:onAvailableUpdate user "+(e?"available":"unavailable"))(),e||L.default.getRememberMe()?this.unavailableLogoutTimer.cancel():this.unavailableLogoutTimer.onOrBefore(h.default.IDLE_TIMEOUT_WAIT),this.sendAvailability(!1)}},{key:"sendAvailability",value:function(e){(e||this.uiActive)&&(this.available?(0,x.sendPresenceAvailable)():(0,x.sendPresenceUnavailable)())}},{key:"updateCouldForce",value:function(){this.couldForce=!this.uiActive||!this.available&&document.hidden}},{key:"updateHardExpire",value:function(){w.default.isExpired()&&(this.hardExpired=!0,w.default.restart(!0))}},{key:"logPageResume",value:function(){this.info===Y.RESUMING&&(this.resumeCount++,new _.default.WebcPageResume({webcResumeCount:this.resumeCount}).commit())}},{key:"updateWamLog",value:function(){var e=this.info===Y.NORMAL;O.default.streamInfoChange(this.info,N.default.numSocketsAttempted,e),e&&this.stopListening(this,"change:info",this.updateWamLog)}},{key:"logModeChange",value:function(){var e=void 0;e=this.mode===B.TOS_BLOCK||this.mode===B.SMB_TOS_BLOCK?_.default.WEBC_STREAM_MODE_CODE.TOS_BLOCK:_.default.WEBC_STREAM_MODE_CODE[this.mode],new _.default.WebcStreamModeChange({webcStreamMode:e}).commit()}}]),t}(v.default);q.Proxy="stream";var W=(0,y.defineModel)(q);t.default=new W},ddcfhecgai:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i("eaejieeafc"),u=n(s),c=i("cgcgbfbffj"),l=n(c),f=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(l.default);f.model=u.default,t.default=f},ddeghajfaj:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i("dcaifjegcg"),u=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(){var e,i,o,a;n(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.id=(0,s.prop)(),o.shortcut=(0,s.prop)(),o.message=(0,s.prop)(),o.count=(0,s.prop)(),o.keywords=(0,s.prop)(),o.pendingCount=(0,s.session)(0),o.totalCount=(0,s.derived)(o._totalCount,["count","pendingCount"]),a=i,r(o,a)}return o(t,e),a(t,[{key:"_totalCount",value:function(){return this.count+this.pendingCount}},{key:"useOnce",value:function(){this.pendingCount+=1,this.getCollection().periodicFlush()}}]),t}(u.default);c.Collection="QuickReply",c.Proxy="quickReply",t.default=(0,s.defineModel)(c)},debjjaigad:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PREFERENCE=void 0;var s=i("dcaifjegcg"),u=n(s),c=i("jccfhaecf"),l=n(c),f=function(e){function t(){var e,i,n,a;r(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.id=(0,s.prop)(),n.wallpaperColor=(0,s.prop)(),n.saveToCameraRoll=(0,s.prop)(),a=i,o(n,a)}return a(t,e),t}(u.default);f.Collection="ChatPreference",f.Proxy="chatPreference",f.idClass=l.default,f.idWhitelist=["defaultPreference"],t.DEFAULT_PREFERENCE="defaultPreference",t.default=(0,s.defineModel)(f)},defecifdhg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTS=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("dcaifjegcg"),c=n(u),l=i("jccfhaecf"),f=n(l),d=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.id=(0,u.prop)(),n.tag=(0,u.prop)(),n.address=(0,u.prop)(),n.description=(0,u.prop)(),n.vertical=(0,u.prop)(),n.email=(0,u.prop)(),n.website=(0,u.prop)(),n.latitude=(0,u.prop)(),n.longitude=(0,u.prop)(),n.businessHours=(0,u.prop)(),n.catalogStatus=(0,u.prop)(),n.stale=(0,u.session)(!0),a=i,o(n,a)}return a(t,e),s(t,[{key:"markStale",value:function(){this.stale=!0,this.hasObservers()&&this.find()}}]),t}(c.default);d.Collection="BusinessProfile",d.Proxy="businessProfile",d.idClass=f.default,t.default=(0,u.defineModel)(d);t.DEFAULTS={address:null,description:null,vertical:null,email:null,website:null}},dfbhcehadj:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("cgcgbfbffj"),c=n(u),l=i("eaejdgfgif"),f=n(l),d=i("djegeegcbf"),h=n(d),p=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"setVariant",value:function(e,t){var i=h.default.skinToneEmojis[e];if(!i)throw new Error("attempt to store variantless emoji");this.gadd({id:i,variant:t})}},{key:"getVariant",value:function(e){if(h.default.skinToneEmojis[e]){var t=this.get(e);return t?t.variant:null}throw new Error("attempt to get variantless emoji")}},{key:"getVariantIfExists",value:function(e){if(h.default.skinToneEmojis[e]){var t=this.get(e);return t?t.variant:null}return null}}]),t}(c.default);p.model=f.default,p.cachePolicy={id:"emoji_variant_collection",policy:u.CACHE_POLICY.LOAD,delay:1e3},t.default=new p},dfgeejdaib:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("hbhijdici"),l=n(c),f=i("cgcgbfbffj"),d=n(f),h=i("cbcbdjdah"),p=n(h),g=i("biecbbiiee"),y=n(g),v=i("eacidghfgh"),b=n(v),_=i("ccaaiecfib"),m=n(_),O=i("bdiiahhjbe"),E=n(O),P=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.syncPromise=null,e.isSynced=!1,e.listenTo(b.default,"change:stream",function(){b.default.stream===v.STREAM.DISCONNECTED&&(e.isSynced=!1)}),e}return a(t,e),s(t,[{key:"onResume",value:function(){this.isSynced=!1,this.sync()}},{key:"maySync",value:function(){return m.default.supportsFeature(m.default.F.STARRED_GIFS)}},{key:"sync",value:function(){var e=this;return this.isSynced?Promise.resolve():this.syncPromise?this.syncPromise:this.maySync()?(this.syncPromise=y.default.getStarred(void 0,void 0,void 0,!0).then(function(t){var i=[];t&&t.length&&(i=l.default.filter(t,function(e){return e&&e.isGif&&!e.isUnsentMedia})),e.set(i)}).catch(function(e){499!==e&&E.default.error("starred gif msgs sync error: ",e)()}).finally(function(){e.syncPromise=null,e.isSynced=!0}),this.syncPromise):Promise.resolve()}},{key:"add",value:function(e,i){var n=this;if(!e||!this.maySync()||!this.isSynced)return[];var r=this.isModel(e)?[e]:e;return r=l.default.filter(r,function(e){return e.isGif&&!n.get(e)}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,r,i)}},{key:"remove",value:function(e,i){var n=this;if(!e||!this.maySync()||!this.isSynced)return[];var r=this.isModel(e)?[e]:e;return r=l.default.filter(r,function(e){return e.isGif&&n.get(e)}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(r,i)}}]),t}(d.default);P.model=p.default,P.comparator=function(e,t){return t.t-e.t},e.exports=new P},dfhgffbdig:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dbdfbgehgj"),l=n(c),f=i("gbfffciea"),d=n(f),h=i("bjigbaghc"),p=n(h),g=i("fcedgihic"),y=n(g),v=i("ccaaiecfib"),b=n(v),_=i("iajeehcac"),m=n(_),O=i("beahjdfigf"),E=n(O),P=i("bfgbdiffgd"),T=n(P),j=i("dffedeegcb"),C=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.sendForNeededAddRequest=function(e){var t=n.parent.id,i=l.default.assertGet(t),r=i.groupMetadata.desc;(0,j.sendForNeededAddRequest)(e,i.formattedTitle||i.name,r,n.parent.id)},a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){this.listenTo(this,"change:contact.name",this.sort),this.listenTo(d.default,"locale_change",this.sort)}},{key:"delete",value:function(){this.forEach(function(e){e.delete()}),this.stopListening(),this.reset()}},{key:"set",value:function(e,i){var n=i||{};return n.isParticipantCollectionAdd||(n.remove=!0),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,e,n)}},{key:"add",value:function(e,i){var n=i||{};return n.isParticipantCollectionAdd=!0,u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e,n)}},{key:"canAdd",value:function(){return!!this.iAmAdmin()}},{key:"canPromote",value:function(e){return!!e&&(!p.default.me.equals(e.id)&&(!!this.iAmAdmin()&&!e.isAdmin))}},{key:"canDemote",value:function(e){return!!e&&(!!this.iAmAdmin()&&(!p.default.me.equals(e.id)&&!(b.default.supportsFeature(b.default.F.GROUPS_V_3)&&T.default.groupsV3&&e.isSuperAdmin||!e.isAdmin)))}},{key:"canRemove",value:function(e){return!!e&&(!p.default.me.equals(e.id)&&!!this.iAmAdmin())}},{key:"canVerifyIdentity",value:function(e){return!!b.default.supportsFeature(b.default.F.QUERY_IDENTITY)&&(!!e&&!p.default.me.equals(e.id))}},{key:"iAmMember",value:function(){return 1===this.filter(function(e){return e.id.equals(p.default.me)}).length}},{key:"iAmRestrictedMember",value:function(){var e=this.parent.id;return l.default.assertGet(e).groupMetadata.restrict&&!this.iAmAdmin()}},{key:"iAmAdmin",value:function(){return 1===this.filter(function(e){return e.id.equals(p.default.me)&&e.isAdmin}).length}},{key:"iAmSuperAdmin",value:function(){return 1===this.filter(function(e){return e.id.equals(p.default.me)&&e.isSuperAdmin}).length}},{key:"getAdmins",value:function(){return this.where({isAdmin:!0})}}]),t}(y.default);C.model=m.default,C.comparator=E.default,t.default=C},dfjfgdhbjj:function(e,t,i){"use strict";function n(e,t){var i=e.pin||0,n=t.pin||0;if(i||n)return i!==n?i>n?-1:1:e.id.toString()<t.id.toString()?-1:1;var r=e.t||0,o=t.t||0;return r!==o?r>o?-1:1:e.id.toString()<t.id.toString()?-1:1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},dghggcieid:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=i("dcaifjegcg"),s=function(e){return e&&e.__esModule?e:{default:e}}(a),u=function(e){function t(){var e,i,o,s;n(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.id=(0,a.prop)(),o.weight=(0,a.prop)(),s=i,r(o,s)}return o(t,e),t}(s.default);u.Proxy="recentEmoji",t.default=(0,a.defineModel)(u)},dghjhchjic:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i("hbhijdici"),u=n(s),c=i("ccdbdjihjh"),l=n(c),f=i("cgcgbfbffj"),d=n(f),h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(d.default);h.model=l.default,h.comparator=function(e,t){return e.id===t.id?0:u.default.lt(e.id,t.id)?-1:1},t.default=h},dhadcigcaf:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GLOBAL_MUTE=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("ddhijeejag"),l=n(c),f=i("bdiiahhjbe"),d=n(f),h=i("jccfhaecf"),p=n(h),g=i("dcaifjegcg"),y=n(g),v=i("chajfbfiga"),b=n(v),_=i("gbfffciea"),m=n(_),O=i("cajijabhgb"),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(O),P=i("djheacfeif"),T=n(P),j=i("ccihhdchab"),C=i("dgdjiicfdg"),S=n(C),M=i("hjbbdjjdf"),w=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,g.prop)(),n.expiration=(0,g.prop)(0),n._unmuteTimer=(0,g.session)(),n.promises=(0,g.session)(function(){return{}}),n.isMuted=(0,g.derived)(n._isMuted,["expiration"]),a=i,o(n,a)}return a(t,e),s(t,[{key:"_isMuted",value:function(){return!!this.expiration}},{key:"initialize",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.expiration&&this.mute(this.expiration)}},{key:"setMute",value:function(e,t){(e||this.expiration)&&e!==this.expiration&&(e?this.mute(e,t):this.unmute(t))}},{key:"mute",value:function(e,t,i){var n=this,r=e;if(!(0,M.isNumber)(r))return d.default.log("models:Mute:mute called with invalid expiration "+r)(),Promise.reject(new E.ActionError);(r=Math.round(r))>2e9&&d.default.log("models:Mute:mute called with wrong units?"+this.id.toString()+" exp:"+r)();var o=function(){if(this.isMuted&&this._clearUnmuteTimer(),-1===r)d.default.log("models:Mute:mute "+this.id.toString()+" muted, no expiration")();else{var e=r-(0,S.default)().unix();d.default.log("models:Mute:mute "+this.id.toString()+" duration:"+e)(),this._unmuteTimer=T.default.setGlobalTimeout(this.unmute.bind(this),1e3*r)}this.set({expiration:r})}.bind(this),a=p.default.isGroup(this.id);if(t){if(this.promises.mute)return this.promises.mute;var s=this.promises.mute=b.default.sendConversationMute(this.id,r,this.expiration),u=a?new j.ActionType(l10n.t("action_group_muting")):new j.ActionType(l10n.t("action_chat_muting")),c=i||(0,j.genId)(),f=this.promises.mute.catch(function(e){d.default.error("models:Mute:mute dropped")(e);var i=a?l10n.t("action_group_mute_failed"):l10n.t("action_chat_mute_failed");throw new j.ActionType(i,l10n.t("action_try_again"),n.mute.bind(n,r,t,c))}).then(function(e){if(200===e.status){var i=a?l10n.t("action_group_muted"):l10n.t("action_chat_muted");return new j.ActionType(i,l10n.t("action_undo"),n.unmute.bind(n,t,c))}if(e.status>=400)throw a?new j.ActionType(l10n.t("action_group_mute_failed")):new j.ActionType(l10n.t("action_chat_mute_failed"))});return m.default.openToast(l.default.createElement(j.ActionToast,{id:c,initialAction:u,pendingAction:f})),s.then(function(e){200!==e.status||e._duplicate||o()}).finally(function(){n.promises.mute=null})}return o(),Promise.resolve()}},{key:"canMute",value:function(){return p.default.isGroup(this.id)||p.default.isUser(this.id)}},{key:"_clearUnmuteTimer",value:function(){T.default.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer"),this.expiration=0}},{key:"unmute",value:function(e,t){var i=this,n=function(){d.default.log("models:Mute:unmute "+this.id.toString())(),this._clearUnmuteTimer()}.bind(this),r=p.default.isGroup(this.id);if(e){if(this.promises.unmute)return this.promises.unmute;var o=this.promises.unmute=b.default.sendConversationMute(this.id,!1,this.expiration),a=r?new j.ActionType(l10n.t("action_group_unmuting")):new j.ActionType(l10n.t("action_chat_unmuting")),s=t||(0,j.genId)(),u=this.promises.unmute.catch(function(t){d.default.error("models:Mute:unmute dropped")(t);var n=r?l10n.t("action_group_unmute_failed"):l10n.t("action_chat_unmute_failed");return Promise.reject(new j.ActionType(n,l10n.t("action_try_again"),i.unmute.bind(i,e,s)))}).then(function(e){if(200===e.status)return r?new j.ActionType(l10n.t("action_group_unmuted")):new j.ActionType(l10n.t("action_chat_unmuted"));if(e.status>=400)throw r?new j.ActionType(l10n.t("action_group_unmute_failed")):new j.ActionType(l10n.t("action_chat_unmute_failed"))});return m.default.openToast(l.default.createElement(j.ActionToast,{id:s,initialAction:a,pendingAction:u})),o.then(function(e){200!==e.status||e._duplicate||n()}).finally(function(){i.promises.unmute=null})}return n(),Promise.resolve()}},{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this._clearUnmuteTimer()}}]),t}(y.default);w.Collection="Mute",w.Proxy="mute",w.idClass=p.default,w.idWhitelist=["global_mute"],t.GLOBAL_MUTE="global_mute",t.default=(0,g.defineModel)(w)},dhefcajhhb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("hbhijdici"),l=n(c),f=i("bhggeigghg"),d=n(f),h=i("bjigbaghc"),p=n(h),g=i("bdiiahhjbe"),y=n(g),v=i("igdjeffe"),b=n(v),_=i("bebehddcbc"),m=n(_),O=i("chajfbfiga"),E=n(O),P=i("cajijabhgb"),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(P),j=i("jccfhaecf"),C=n(j),S=i("dcbdjheea"),M=i("edjgaiicj"),w=n(M),k=i("ccaaiecfib"),A=n(k),I=i("cgcgbfbffj"),L=n(I),R=i("biahggehgf"),N=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"get",value:function(e){var i=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"get",this).call(this,e);if(!this._model.prototype.isIdType(e))return i;var n=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"get",this).call(this,(0,w.default)(e.toString()));if(n){if(this.remove(n,{silent:!0}),i&&i.tag)return i;var r=n.toJSON();return r.id=e,this.add(r,{silent:!0,merge:!0})[0]}return i||void 0}},{key:"saveToCache",value:function(){if(p.default.me){var e=t.cachePolicy.id,i=this.filter(function(e){return C.default.isWid(e.id)&&!!e.eurl});i=i.map(function(e){var t=e.toJSON();return t.id=(0,w.default)(t.id.toString()),t}),y.default.log("models:profilePic:cache-save: "+String(e))(),m.default.setCollection(e,i)}}},{key:"initializeFromCache",value:function(e){if(this.length&&e){var t=this.reduce(function(e,t){return e[(0,w.default)(t.id.toString())]=t.id.toString(),e},new Object);if(!l.default.isEmpty(t)){var i=e.reduce(function(e,i){return t[i.id]&&(i.id=(0,S.createWid)(t[i.id]),i.stale=!0,e.push(i)),e},[]);this.add(i,{merge:!0})}}}},{key:"onResume",value:function(){var e=this.filter(function(e){var t=d.default.Chat.get(e.id);return e.hasObservers()&&e.stale&&(C.default.isUser(e.id)||C.default.isGroup(e.id))&&!(t&&t.isReadOnly)}).map(function(e){return e.tag||e.unset("tag",{silent:!0}),e});this.resyncPictures(e)}},{key:"_find",value:function(e){var t=d.default.Chat.get(e);return t&&t.isReadOnly?(0,R.profilePicFindThumbFromPhone)(e,this.get(e)).then(function(e){return e.tag||e.raw||(e.eurl=null,e.tag=null,e.raw=null,e.eurlStale=!1),e}).catch(T.ProtoVersionUndefined,function(){return{id:e,stale:!0}}):C.default.isUser(e)||C.default.isGroup(e)?(0,R.profilePicFind)(e).then(function(t){var i={id:e};if(null!==t.status&&void 0!==t.status)switch(t.status){case 401:i.tag="",i.raw=void 0;break;case 423:case 429:i.stale=!0;break;default:i.tag=null,i.eurl=null,i.eurlStale=!1}else i.tag=t.tag,i.raw=null,i.eurl=t.eurl,i.eurlStale=!1,A.default.supportsFeature(A.default.F.MD_BACKEND);return i}).catch(T.WapDrop,function(){return{id:e,stale:!0}}):Promise.resolve({id:e,tag:null})}},{key:"imageChanged",value:function(e,t){var i=this.get(e);i&&("remove"===t?i.set({tag:void 0,eurl:void 0}):i.tag!==t&&i.update().catch(T.WapDrop,function(){}))}},{key:"resyncPictures",value:function(e){var t=this;return 0===e.length?Promise.resolve():E.default.resyncPictures(e.map(function(e){return{id:e.id,tag:e.tag}})).then(function(i){if(423===i.status||429===i.status)y.default.warn("ProfilePicThumbStore:resyncPictures blocked "+i.status)();else{if("number"==typeof i.status&&i.status>=400)throw y.default.error("ProfilePicThumbStore:resyncPictures error "+i.status)(i),new Error("ProfilePicThumbStore:resyncPictures error");if(!Array.isArray(i))throw y.default.error("ProfilePicThumbStore:resyncPictures unknown reply",i)(),new Error("ProfilePicThumbStore:resyncPictures unknown reply");y.default.log("ProfilePicThumbStore:resyncPictures success")(),i.forEach(function(e){var i=t.get(e.id);i&&i.set({tag:e.tag,raw:void 0,stale:!1,eurl:e.eurl,eurlStale:!1})}),e.forEach(function(e){e.eurlStale&&e.update()}),e.forEach(function(e){e.stale=!1})}}).catch(T.WapDrop,function(){}).catch(function(e){y.default.error("ProfilePicThumbStore:resyncPictures dropped: "+String(e))()})}}]),t}(L.default);N.model=b.default,N.staleCollection=!0,N.resumeOnAvailable=!0,N.cachePolicy={id:"profile_pic_thumb",trigger:"change:tag change:raw",policy:I.CACHE_POLICY.LOAD,delay:5e3},t.default=new N},dhggbbghfb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var o=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=i("dfhjacfbjg"),s=r(a),u=i("cajijabhgb"),c=r(u),l=i("dbdfbgehgj"),f=n(l),d=i("eadfaddcj"),h=n(d),p=i("dhigahgdjb"),g=n(p),y=i("bdiiahhjbe"),v=n(y),b=i("ebbjbbjjg"),_=n(b),m=i("dhefcajhhb"),O=n(m),E=i("gbbacfeci"),P=n(E),T=i("bgcdajbhif"),j=n(T),C=i("dfhgeaeig"),S=i("dgdhcdgffe"),M={handle:function(e){var t=o(e,1),i=t[0];switch(i.type){case"const":h.default[i.key]=i.value;break;case"read":if(i.isStatus){j.default.handle([i]);break}case"unread":var n=f.default.get(i.jid);n&&("read"===i.type?(0,S.markSeen)(n):"unread"===i.type&&(0,S.markUnseen)(n));break;case"picture":O.default.imageChanged(i.jid,i.tag);break;case"log":s.upload("server-requested",!0,!0);break;case"privacy":if(i.jid){var r=_.default.get(i.jid);r&&r.reset(),O.default.update(i.jid).catch(c.WapDrop,function(){}),P.default.update(i.jid).catch(c.WapDrop,function(){})}else v.default.error("Store:Cmd:handle:privacy no jid",i)();break;case"identity":if(i.jid){var a=g.default.get(i.jid);a?(0,C.updateIdentity)(a,i):v.default.error("Store:Cmd:handle:identity no contact",i)()}else v.default.error("Store:Cmd:handle:identity no jid",i)();break;default:v.default.warn("Store:Cmd:handle:unknown "+i.type,i)()}}};e.exports=M},dhhbbaegif:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("gbfffciea"),l=n(c),f=i("fcedgihic"),d=n(f),h=i("iajeehcac"),p=n(h),g=i("beahjdfigf"),y=n(g),v=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"initialize",value:function(){this.listenTo(this,"change:contact.name",this.sort),this.listenTo(l.default,"locale_change",this.sort)}},{key:"delete",value:function(){this.forEach(function(e){e.delete()}),this.stopListening(),this.reset()}},{key:"set",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.isParticipantCollectionAdd||(i.remove=!0),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,e,i)}},{key:"add",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.isParticipantCollectionAdd=!0,u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e,i)}}]),t}(d.default);v.model=p.default,v.comparator=y.default,t.default=v},dhigahgdjb:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("hbhijdici"),f=r(l),d=i("cajijabhgb"),h=n(d),p=i("gbfffciea"),g=r(p),y=i("eadfaddcj"),v=r(y),b=i("ccfcjccjbg"),_=r(b),m=i("ccicaaeiaa"),O=r(m),E=i("bdiiahhjbe"),P=r(E),T=i("cbeabehaca"),j=r(T),C=i("ebggjhghhi"),S=n(C),M=i("eacidghfgh"),w=r(M),k=i("cgcgbfbffj"),A=r(k),I=i("bebehddcbc"),L=r(I),R=i("cajejegicg"),N=i("cbecjajacd"),D=i("dhiccjfja"),F=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._contactHashes=new j.default,e.checksum=void 0,e._frequentContacts={},e._sort=f.default.debounce(function(){return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"sort",e).call(e)},1e3),e._silentSort=f.default.debounce(function(){return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"sort",e).call(e,{silent:!0})},1e3),e.listenTo(g.default,"locale_change",e.sort),e.listenTo(e,"change:name",e.sort),e.listenTo(w.default,"change:stream",function(){w.default.stream===M.STREAM.RESUMING&&e.forEach(function(e){e.unset("verificationString"),e.unset("verificationBinary")})}),e.listenTo(e,"add",e.contactAdded),e.listenTo(e,"remove",e.contactRemoved),e}return s(t,e),u(t,[{key:"sort",value:function(e){return e&&e.silent?this._silentSort():this._sort()}},{key:"initializeFromCache",value:function(e){e&&(P.default.log("Store:Contact init from cache")(),this.add(e,{silent:!0,merge:!0}))}},{key:"contactAdded",value:function(e){this._contactHashes.put(e)}},{key:"contactRemoved",value:function(e){this._contactHashes.remove(e)}},{key:"delete",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.setChecksum(),delete this.checksum,this._frequentContacts={},(0,N.setFrequent)({}).catch(function(){}),this._contactHashes.clear()}},{key:"isFilteredContact",value:function(e){return!!e.name&&!e.isMe&&!e.isPSA&&e.isWAContact}},{key:"getFilteredContacts",value:function(){return this.filter(function(e){return e.name&&!e.isMe&&!e.isPSA&&e.isWAContact})}},{key:"_find",value:function(e){var t=this.get(e);return t?Promise.resolve(t):Promise.resolve({id:e})}},{key:"_findQuery",value:function(e){return(0,D.contactFindQuery)(e)}},{key:"sync",value:function(){return this.findQuery({}).catch(h.WapDrop,function(){}),S.waitForBBEvent(this,v.default.COLLECTION_HAS_SYNCED)}},{key:"frequentContacts",value:function(e,t){var i=this,n=e&&this._frequentContacts[e];if(n||(n=this._frequentContacts.message),!n)return[];var r=t&&t.id;return n.map(function(e){return i.get(e)}).filter(function(e){return!!e&&!e.id.equals(r)})}},{key:"_getUserCount",value:function(){return this.map(function(e){return e.isUser?1:0}).reduce(function(e,t){return e+t},0)}},{key:"setChecksum",value:function(e){this.checksum=e,L.default.setContactChecksum(this.checksum),(0,R.setChecksum)(e).catch(function(){})}}]),t}(A.default);F.model=_.default,F.comparator=O.default,F.cachePolicy={id:"contact",policy:k.CACHE_POLICY.IMMEDIATE,trigger:"add\n        sort\n        remove\n        reset\n        change:id\n        change:name\n        change:shortName\n        change:pushname\n        change:type\n        change:verifiedName\n        change:isBusiness\n        change:isEnterprise\n        change:verifiedLevel\n        change:statusMute\n        change:sectionHeader\n        change:isContactBlocked\n        change:labels"},t.default=new F},dhjffabgfb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StickerCollection=t.FETCH_STATE=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("cgcgbfbffj"),c=n(u),l=i("cgfidiajgj"),f=n(l),d=(t.FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"},t.StickerCollection=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"fetch",value:function(e){throw new Error(this.constructor.name+".fetch is not implemented")}}]),t}(c.default));d.model=f.default,t.default=new d},diafggiefe:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},c=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},f=i("dcaifjegcg"),d=n(f),h=i("bdiihbaeaj"),p=n(h),g=i("bdiiahhjbe"),y=n(g),v=i("bffjfbgbg"),b=n(v),_=i("beeieigghj"),m=n(_),O=i("dgeebjciej"),E=i("fabajdgab"),P=i("ddgbhifaji"),T=i("cajijabhgb"),j=i("daichdjff"),C=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,f.prop)(),n.type=(0,f.prop)(),n.mediaUrl=(0,f.prop)(),n.blobUrl=(0,f.session)(),n.mediaData=(0,f.session)(),n.fetchedFromServer=(0,f.prop)(),n.old=(0,f.session)(!1),a=i,o(n,a)}return a(t,e),c(t,[{key:"initialize",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.listenTo(this,"change:mediaUrl change:fetchedFromServer",this.triggerImageUpdate),this.triggerImageUpdate()}},{key:"triggerImageUpdate",value:function(){var e=this;if(this.fetchedFromServer&&this.mediaUrl){this.mediaData||this.addChild("mediaData",new b.default({mediaStage:j.STAGE.PREPARING}));var t={},i={retries:10,factor:1e3,maxTimeout:9e5,jitter:.25};(0,p.default)(i,function(t){return(0,E.fetchMedia)(e.mediaUrl).then(function(e){return e&&e.status>=200&&e.status<300?e:t(new T.CatalogImageDownloadError)})}).then(function(i){var n=i.result,r=m.default.createFromData(n,"image/jpeg");(0,P.prepRawMedia)(r,{}).waitForPrep().then(function(e){return t=u({},t,{mediaBlob:e.mediaBlob,type:e.type,mimetype:e.mimetype,fullWidth:e.fullWidth,fullHeight:e.fullHeight}),Promise.all([m.default.createFromBase64Jpeg(e.preview),m.default.createFromData(e.mediaBlob),(0,O.getHash)(e.mediaBlob)])}).then(function(i){var n=s(i,3),r=n[0],o=n[1],a=n[2];if(t=u({},t,{preview:r,mediaBlob:o,renderableUrl:o.url(),mediaStage:j.STAGE.RESOLVED,filehash:a}),a===e.mediaData.filehash)return Promise.resolve();e.mediaData.set(t)})}).catch(function(t){y.default.error("Failed to fetch "+e.mediaUrl,t)(),e.mediaData.set({mediaStage:j.STAGE.ERROR_MISSING})})}}},{key:"markOld",value:function(){this.old=!0}}]),t}(d.default);C.Proxy="productImage",t.default=(0,f.defineModel)(C)},diajeiidei:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("hbhijdici"),l=n(c),f=i("cajijabhgb"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(f),h=i("eadfaddcj"),p=n(h),g=i("cbcbdjdah"),y=n(g),v=i("biecbbiiee"),b=n(v),_=i("cgcgbfbffj"),m=n(_),O={before:"before",after:"after"},E=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.hasMediaBefore=!0,n.hasMediaAfter=!0,a=i,o(n,a)}return a(t,e),s(t,[{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.stopListening()}},{key:"contains",value:function(e){return this.indexOf(e)>-1}},{key:"getAfter",value:function(e){var t=this.indexOf(e);return t<0||t===this.length-1?null:this.at(t+1)}},{key:"getBefore",value:function(e){var t=this.indexOf(e);return t<=0?null:this.at(t-1)}},{key:"loadEarlierMedias",value:function(){var e=this.head();e&&this.queryMedia(null,e)}},{key:"loadRecentMedias",value:function(){var e=this.last();e&&this.queryMedia(null,e,O.after)}},{key:"loadMoreAroundIfNeeded",value:function(e){if(e){var t=this.indexOf(e);t<20&&this.hasMediaBefore&&this.loadEarlierMedias(),this.length-t<20&&this.hasMediaAfter&&this.loadRecentMedias()}}},{key:"queryMedia",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.before;if(!t&&e){var r=e.msgs;if(!r||0===r.length)return this.hasMediaBefore=!1,new Promise(function(e){e({eof:!0})});this.add(r.filter(function(e){return e.isMedia&&!e.isProduct}),{at:0});var o=this.toArray();if(this.downloadMedias(o),e.msgs.msgLoadState.noEarlierMsgs)return this.hasMediaBefore=!1,new Promise(function(e){e({eof:!0})});if(o.length<=2*p.default.MEDIA_QUERY_LIMIT){var a=0===o.length?r.head():l.default.head(o);return this.queryMedia(e,a)}return new Promise(function(e){e({eof:!1})})}if(t&&n===O.before){if(this.queryMediaBefore)return this.queryMediaBefore;var s=0;return this.queryMediaBefore=b.default.queryMedia(t.id.remote,p.default.MEDIA_QUERY_LIMIT,n,t.isMedia?t.id:void 0).then(function(t){var n=t.messages;(!n||n.length<p.default.MEDIA_QUERY_LIMIT)&&(i.hasMediaBefore=!1);var r=[];n&&n.length>0&&(r=n.filter(function(e){return e.isMedia}),i.downloadMedias(r)),i.add(r,{at:0});var o={mediaCount:t.mediaCount,linkCount:t.linkCount,docCount:t.docCount};return e&&e.resetMediasCount(o),s=r.length,{length:s}}).catch(d.WapDrop,d.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryMediaBefore=null,i.trigger("query_media_before",s)}),this.trigger("query_media_before",0),this.queryMediaBefore}if(t&&n===O.after)return this.queryMediaAfter?this.queryMediaAfter:this.queryMediaAfter=b.default.queryMedia(t.id.remote,p.default.MEDIA_QUERY_LIMIT,n,t.id).then(function(t){var n=t.messages;(!n||n.length<p.default.MEDIA_QUERY_LIMIT)&&(i.hasMediaAfter=!1);var r=[];n&&n.length>0&&(r=n.filter(function(e){return e.isMedia}),i.downloadMedias(r)),i.add(r);var o={mediaCount:t.mediaCount,linkCount:t.linkCount,docCount:t.docCount};return e&&e.resetMediasCount(o),{length:r.length}}).catch(d.WapDrop,d.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryMediaAfter=null,i.trigger("query_media_after")})}},{key:"downloadMedias",value:function(e){l.default.forEach(e,function(e){e.downloadMedia()})}}]),t}(m.default);E.model=y.default,t.default=E},dieafdcbjb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i("dcaifjegcg"),u=n(s),c=i("jccfhaecf"),l=n(c),f=function(e){function t(){var e,i,n,a;r(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.id=(0,s.prop)(),n.status=(0,s.prop)(),n.stale=(0,s.session)(!0),a=i,o(n,a)}return a(t,e),t}(u.default);f.Collection="Status",f.Proxy="status",f.idClass=l.default,t.default=(0,s.defineModel)(f)},djaadchjch:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("hbhijdici"),c=n(u),l=i("bdiiahhjbe"),f=n(l),d=i("cgcgbfbffj"),h=n(d),p=i("fcfchiagj"),g=n(p),y=i("bhggeigghg"),v=n(y),b=i("chajfbfiga"),_=n(b),m=i("cajijabhgb"),O=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(m),E=i("jccfhaecf"),P=n(E),T=i("dcbdjheea"),j=i("bjcegba"),C=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"onResume",value:function(){var e=this;c.default.union(v.default.Chat.where({active:!0}).filter(function(e){return e.isGroup||e.isBroadcast}),v.default.Chat.where({isBroadcast:!0})).forEach(function(t){e.find(t.id).catch(O.WapDrop,O.ProtoVersionUndefined,function(){})})}},{key:"_find",value:function(e){var t=this;if(P.default.isGroup(e)){var i=v.default.Chat.get(e);return i&&i.isReadOnly?(0,j.queryGroupFromPhone)(e):(0,j.queryGroup)(e)}if(P.default.isBroadcast(e))return _.default.contactFindBroadcast(e).then(function(i){if(200===i.status){var n=t.get(e);return n&&!n.stale?Promise.resolve(n):{id:e,participants:i.recipients}}return 404===i.status?(f.default.error("models:GroupMetadataCollection:_find:False broadcast list query")(),{id:e}):(f.default.error("models:GroupMetadataCollection:_find:bclist error: "+i.status)(),Promise.reject(new Error("models:GroupMetadataCollection:_find:bclist error: "+i.status)))});var n="groupMetadata:find trying to fetch non-group/bclist wid "+e.toString();return f.default.log(n)(),Promise.reject(new Error(n))}},{key:"_handle",value:function(e){return e}},{key:"handlePendingInvite",value:function(e){var t=e.gid,i=e.participants;this.add({id:(0,T.createWid)(t),pendingParticipants:i},{merge:!0})}}]),t}(h.default);C.model=g.default,C.staleCollection=!0,e.exports=new C},djfhiceeje:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){S.add(e),d.default.forEach(e,function(e){e.chat.starredMsgs&&e.chat.starredMsgs.add(e)}),T.default.add(e)}function u(e){S.remove(e),e.forEach(function(e){e.chat.starredMsgs&&e.chat.starredMsgs.remove(e)}),T.default.remove(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarredMsgCollection=void 0;var c=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)};t.addStarredMsgs=s,t.removeStarredMsgs=u;var f=i("hbhijdici"),d=n(f),h=i("cbcbdjdah"),p=n(h),g=i("biecbbiiee"),y=n(g),v=i("eacidghfgh"),b=n(v),_=i("bdiiahhjbe"),m=n(_),O=i("eadfaddcj"),E=n(O),P=i("dfgeejdaib"),T=n(P),j=i("cgcgbfbffj"),C=n(j),S=void 0,M=t.StarredMsgCollection=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.syncPromise=null,e.isSynced=!1,e.listenTo(b.default,"change:stream",function(){b.default.stream===v.STREAM.DISCONNECTED?e.isSynced=!1:b.default.stream===v.STREAM.CONNECTED&&e.delete()}),e}return a(t,e),c(t,[{key:"process",value:function(e,t,i,n){n?this.delete():this.updateMsgs(e,t,i)}},{key:"sync",value:function(e){if(this.isSynced)return Promise.resolve();if(this.syncPromise)return this.syncPromise;var t=this,i=void 0,n=this.last();return n&&(i=n.id),this.syncPromise=y.default.getStarred(e,E.default.PAGE_SIZE,i).then(function(e){e.length&&t.add(e,{silent:!0}),e.length<E.default.PAGE_SIZE&&(t.isSynced=!0)}).catch(function(e){m.default.error("starred msg sync error: ",e)()}).finally(function(){t.syncPromise=null,t.trigger("sync")}),this.trigger("sync"),this.syncPromise}},{key:"updateMsgs",value:function(e,t,i){var n=this,r=this.syncPromise||Promise.resolve();this.syncPromise=r.then(function(){if(e){return(t.length>0?y.default.incrementalStarredUpdate(t):Promise.resolve([])).then(function(e){var t=e.concat(i);n.isSynced&&(n.add(t,{silent:!0}),T.default.add(e)),d.default.forEach(t,function(e){e.chat.starredMsgs&&e.chat.starredMsgs.add(e)}),n.trigger("sync")}).catch(function(e){m.default.error("models:starred:update:error: ",e)()})}return u(t.concat(i).filter(function(e){return!e.star})),Promise.resolve()}).finally(function(){n.syncPromise=null})}},{key:"delete",value:function(){this.isSynced=!1,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this)}}]),t}(C.default);M.model=p.default,M.comparator=function(e,t){return t.t-e.t},S=new M,t.default=S},eaejdgfgif:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=i("dcaifjegcg"),s=function(e){return e&&e.__esModule?e:{default:e}}(a),u=function(e){function t(){var e,i,o,s;n(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.id=(0,a.prop)(),o.variant=(0,a.prop)(),s=i,r(o,s)}return o(t,e),t}(s.default);u.Proxy="emojiVariant",t.default=(0,a.defineModel)(u)},eaejieeafc:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=i("dcaifjegcg"),s=function(e){return e&&e.__esModule?e:{default:e}}(a),u=function(e){function t(){var e,i,o,s;n(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.id=(0,a.prop)(),o.parentType=(0,a.prop)(),o.parentId=(0,a.prop)(),o.labelId=(0,a.prop)(),s=i,r(o,s)}return o(t,e),t}(s.default);u.Collection="LanelItemCollection",u.Proxy="labelItem",t.default=(0,a.defineModel)(u)},ebbjbbjjg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("bjigbaghc"),l=n(c),f=i("igjghefdb"),d=n(f),h=i("cgcgbfbffj"),p=n(h),g=i("jccfhaecf"),y=n(g),v=i("chajfbfiga"),b=n(v),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"_find",value:function(e){return!this.gadd(e).isUser||y.default.isServer(e)||y.default.isPSA(e)?Promise.resolve({id:e}):b.default.subscribePresence(e).then(function(){return{id:e}})}},{key:"handle",value:function(e){var t=s(e,1),i=t[0];if(!l.default.me.equals(i.id)){var n=this.get(i.id);n&&("unsubscribe"===i.type?n.set({isSubscribed:!1,stale:!0}):(n.handle(i),n.stale=!1))}}},{key:"clearAllPresence",value:function(){this.forEach(function(e){e.reset(),e.set({stale:!0,isSubscribed:!1})})}}]),t}(p.default);_.model=d.default,_.staleCollection=!0,t.default=new _},ebcagbhefg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("cgcgbfbffj"),f=n(l),d=i("debjjaigad"),h=n(d),p=i("eadfaddcj"),g=n(p),y=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"initializeFromCache",value:function(e){var t=e||[];this.add([{id:d.DEFAULT_PREFERENCE,wallpaperColor:g.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0}].concat(r(t)),{merge:!0})}},{key:"get",value:function(e){return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"get",this).call(this,e)||c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"get",this).call(this,d.DEFAULT_PREFERENCE)}},{key:"delete",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.add({id:d.DEFAULT_PREFERENCE,wallpaperColor:g.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0})}}]),t}(f.default);y.model=h.default,y.cachePolicy={id:"chat_preference",policy:l.CACHE_POLICY.LOAD,delay:1e3},e.exports=new y},ebjaejiaba:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CHAT_KIND=t.KIND=void 0;var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("cajijabhgb"),f=r(l),d=i("ebggjhghhi"),h=r(d),p=i("hbhijdici"),g=n(p),y=i("djfhiceeje"),v=n(y),b=i("eadfaddcj"),_=n(b),m=i("bdiiibjcij"),O=n(m),E=i("caedaejadb"),P=n(E),T=i("diajeiidei"),j=n(T),C=i("dbfjecijha"),S=n(C),M=i("chbjajaddg"),w=n(M),k=i("bjebjijbfc"),A=n(k),I=i("gbfffciea"),L=n(I),R=i("bjigbaghc"),N=n(R),D=i("beecadabde"),F=n(D),G=i("ccbihadedf"),U=n(G),x=i("cijheiibhg"),Y=n(x),B=i("ccaaiecfib"),V=n(B),q=i("ecjehifjdd"),W=n(q),H=i("bdiiahhjbe"),K=n(H),z=i("bfbggcdbfb"),Q=n(z),J=i("cbcbdjdah"),X=n(J),Z=i("biecbbiiee"),$=n(Z),ee=i("ccbagdhfbb"),te=i("ccgjijjbbj"),ie=n(te),ne=i("dagdiahdfi"),re=n(ne),oe=i("dhefcajhhb"),ae=n(oe),se=i("ddhijeejag"),ue=n(se),ce=i("eacidghfgh"),le=n(ce),fe=i("bhggeigghg"),de=n(fe),he=i("ccehadbeci"),pe=n(he),ge=i("bgabgddgch"),ye=n(ge),ve=i("bebehddcbc"),be=n(ve),_e=i("jccfhaecf"),me=n(_e),Oe=i("chajfbfiga"),Ee=n(Oe),Pe=i("edjgaiicj"),Te=n(Pe),je=i("cfejjfjhca"),Ce=n(je),Se=i("cahfddcdga"),Me=n(Se),we=i("cgfjebhhej"),ke=n(we),Ae=i("ccihhdchab"),Ie=i("dcaifjegcg"),Le=i("ddgbhifaji"),Re=i("bcjidabgad"),Ne=i("dcbafbaejf"),De=i("icbibjcg"),Fe=i("eahbfdfee"),Ge=i("cgddafdgie"),Ue=i("bhjegffigh"),xe=i("eabhibhged"),Ye=i("dcjbdhhjge"),Be=t.KIND={GROUP:"group",BROADCAST:"broadcast",CHAT:"chat"};t.CHAT_KIND=Be;var Ve=function(e){function t(){var e,i,n,r;o(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,Ie.prop)(),n.t=(0,Ie.prop)(),n.unreadCount=(0,Ie.prop)(0),n.archive=(0,Ie.prop)(),n.isReadOnly=(0,Ie.prop)(),n.isAnnounceGrpRestrict=(0,Ie.prop)(),n.modifyTag=(0,Ie.prop)(),n.muteExpiration=(0,Ie.prop)(0),n.name=(0,Ie.prop)(),n.notSpam=(0,Ie.prop)(),n.pin=(0,Ie.prop)(),n.changeNumberOldJid=(0,Ie.prop)(),n.changeNumberNewJid=(0,Ie.prop)(),n.lastReceivedKey=(0,Ie.prop)(),n.createdLocally=(0,Ie.session)(),n.pendingAction=(0,Ie.session)(),n.formattedTitle=(0,Ie.session)(),n.active=(0,Ie.session)(),n.pausedTimerId=(0,Ie.session)(),n.presenceResendTimerId=(0,Ie.session)(),n.recording=(0,Ie.session)(),n.typing=(0,Ie.session)(),n.colors=(0,Ie.session)(),n.composeContents=(0,Ie.session)(function(){return{}}),n.composeAttachMediaContents=(0,Ie.session)(),n.squelch=(0,Ie.session)(),n.pendingSeenCount=(0,Ie.session)(0),n.unreadMsgAnchor=(0,Ie.session)(),n.markedUnread=(0,Ie.session)(),n.trusted=(0,Ie.session)(),n.canSend=(0,Ie.session)(),n.promises=(0,Ie.session)(function(){return{}}),n.ftsCache=(0,Ie.session)(function(){return{}}),n.composeQuotedMsg=(0,Ie.session)(),n.composeQuotedMsgRemoteJid=(0,Ie.session)(),n.quotedMsgAdminGroupJid=(0,Ie.session)(),n.groupMetadata=(0,Ie.session)(),n.presence=(0,Ie.session)(),n.mute=(0,Ie.session)(),n.contact=(0,Ie.session)(),n.liveLocation=(0,Ie.session)(),n.liveLocationQueried=(0,Ie.session)(!1),n.ackedProps=(0,Ie.session)(function(){return{}}),n.mediaCount=(0,Ie.session)(0),n.linkCount=(0,Ie.session)(0),n.docCount=(0,Ie.session)(0),n.vcardDismissed=(0,Ie.session)(!1),n.kind=(0,Ie.derived)(n._kind),n.isUser=(0,Ie.derived)(n._isUser),n.isPSA=(0,Ie.derived)(n._isPSA),n.isGroup=(0,Ie.derived)(n._isGroup),n.isBroadcast=(0,Ie.derived)(n._isBroadcast),n.hasUnread=(0,Ie.derived)(n._hasUnread,["unreadCount"]),n.shouldShowUnreadDivider=(0,Ie.derived)(n._shouldShowUnreadDivider,["unreadCount","unreadMsgAnchor"]),n.isVisible=(0,Ie.derived)(n._isVisible,["createdLocally","msgs","msgsLength"]),n.previewMessage=(0,Ie.derived)(n._previewMessage,["msgs","msgsChanged"]),n.showChangeNumberNotification=(0,Ie.derived)(n._showChangeNumberNotification,["changeNumberOldJid","changeNumberNewJid","id","isUser"]),r=i,a(n,r)}return s(t,e),u(t,[{key:"initialize",value:function(){var e=this;c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this._addQueue=new W.default,this._sendQueue=new W.default,this._promises=null,this.msgs.msgLoadState.contextLoaded=!0,this.isVisible||(this.msgs.msgLoadState.noEarlierMsgs=!0),this.addChild("presence",de.default.Presence.gadd(this.id));var i=re.default.get(this.id);if(i?this.addChild("mute",i):this.addChild("mute",re.default.gadd({id:this.id,expiration:this.muteExpiration})),this.listenTo(this.mute,"change:expiration",this.updateMuteExpiration),this.addChild("contact",de.default.Contact.gadd(this.id)),this.name&&!this.contact.name){var n={name:this.name};(0,Ye.updateLocal)(this.contact.id,n).then(function(){e.contact.set(n)})}if(this.listenTo(this.contact,"change:name",this.updateTitle),this.listenTo(this.contact,"change:isContactBlocked",this.updateCanSend),this.isGroup&&(this.trusted=!0),this.isGroup||this.isBroadcast){var r=void 0;this.isBroadcast&&!de.default.GroupMetadata.get(this.id)&&(r=!0),this.addChild("groupMetadata",de.default.GroupMetadata.gadd(this.id)),this.listenTo(this.groupMetadata,"change:stale change:announce",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata.participants,"change:isAdmin add remove",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata,"change:trusted change:stale",this.isTrusted),this.listenTo(this.groupMetadata,"change:participants change:stale",this.updateReadOnly),this.listenTo(this.groupMetadata.participants,"change:contact.formattedShortName",this.updateTitle),this.updateReadOnly(),this.updateIsAnnounceGrpRestrict();var o=this.id;this.listenTo(this,"change:isReadOnly",function(){this.isTrusted(),this.updateCanSend(),ae.default.update(o).catch(f.WapDrop,function(){}),de.default.GroupMetadata.update(o).catch(f.WapDrop,function(){})}),this.listenTo(this,"change:isAnnounceGrpRestrict",this.updateCanSend),r&&de.default.GroupMetadata.update(o).catch(f.WapDrop,function(){})}else this.listenTo(this.presence,"change:isOnline",function(){return(0,De.presenceOnlineChanged)(e)}),this.listenTo(this.contact,"change:isMyContact",this.isTrusted);var a=this.getCollection();a.notSpam[this.id]&&!this.notSpam&&(0,Ne.sendNotSpam)(this).catch(function(){}),a.notSpam[this.id]=!!this.notSpam,this.notSpam||this.listenTo(this,"change:notSpam",this.onNotSpamChange),this.updateTitle(),this.isTrusted(),this.updateCanSend(),this.listenTo(this.msgs,"add",this.onNewMsg),this.listenTo(this.msgs,"update_sort_time",this.updateSortTime),this.listenTo(this.msgs,"bulk_add",this.addMediaMsgs),this.listenTo(this,"change:msgs",this.resetMediaMsgs),this._saveAssignedColors=g.default.debounce(this.saveAssignedColors,1e3),this.listenTo(this,"change:active",this.onActiveUpdate),this.pendingAction=0,this.listenTo(this,"change:t change:modifyTag",this._clearFtsCache)}},{key:"_kind",value:function(){return me.default.isGroup(this.id)?Be.GROUP:me.default.isBroadcast(this.id)?Be.BROADCAST:me.default.isUser(this.id)?Be.CHAT:void K.default.log("chat:unknown kind id:"+this.id.toString())()}},{key:"_isUser",value:function(){return me.default.isUser(this.id)}},{key:"_isPSA",value:function(){return me.default.isPSA(this.id)}},{key:"_isGroup",value:function(){return me.default.isGroup(this.id)}},{key:"_isBroadcast",value:function(){return me.default.isBroadcast(this.id)}},{key:"_hasUnread",value:function(){return 0!==this.unreadCount}},{key:"_shouldShowUnreadDivider",value:function(){if(0===this.unreadCount)return!1;if(this.unreadMsgAnchor){var e=this.unreadMsgAnchor.msgChunk.getModelsArray();return this.unreadMsgAnchor!==g.default.find(e,{isUnreadType:!0})}if(this.msgs.msgLoadState.noEarlierMsgs){return this.msgs.filter(function(e){return e.isUnreadType}).length!==this.unreadCount}return!0}},{key:"_isVisible",value:function(){if(this._isVisibleLatched)return!0;if(me.default.isStatusV3(this.id))return!1;var e=this.msgs.length>0&&this.msgs.some(function(e){var t=e.from===N.default.me&&e.type===_.default.MSG_TYPE.GROUPS_V4_INVITE,i=e.type===_.default.MSG_TYPE.E2E_NOTIFICATION;return!t&&!i});return this._isVisibleLatched=!this.createdLocally||e,this._isVisibleLatched}},{key:"_previewMessage",value:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&t.type!==_.default.MSG_TYPE.E2E_NOTIFICATION)return t}return this.msgs.last()}},{key:"_showChangeNumberNotification",value:function(){if(!V.default.supportsFeature(V.default.F.CHANGE_NUMBER_V_2))return!1;var e=this.changeNumberOldJid,t=this.changeNumberNewJid,i=this.id;if(!this.isUser)return!1;if(!e&&!t)return!1;var n=t||i,r=de.default.Contact.get(n);return!r||!r.isMyContact}},{key:"set",value:function(e,i,n){return"string"==typeof e?"muteExpiration"===e&&this.mute&&this.mute.setMute(i):e.hasOwnProperty("muteExpiration")&&this.mute&&this.mute.setMute(e.muteExpiration),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,e,i,n)}},{key:"addPendingAction",value:function(e){var t=this;if(e.isPending()){var i=function(){t.decPending()};e.then(i,i),this.pendingAction++}}},{key:"decPending",value:function(){this.pendingAction>0?this.pendingAction--:(K.default.log("chat:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)}},{key:"onActiveUpdate",value:function(){this.isGroup&&this.active&&(this.squelch=-1),this.presence.chatActive=this.active}},{key:"onPendingActionUpdate",value:function(){this.pendingAction<0&&(K.default.log("chat:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)}},{key:"onNotSpamChange",value:function(){this.getCollection().notSpam[this.id]=this.notSpam,this.isTrusted(),this.notSpam&&this.stopListening(this,"change:notSpam")}},{key:"hasMaybeSentMsgToChat",value:function(){return g.default.some(this.getAllMsgs(),function(e){return e.isSentByMe})}},{key:"isTrusted",value:function(){var e=!1;return this.isGroup?e=this.isReadOnly||this.notSpam||this.groupMetadata.isTrusted():this.isBroadcast?e=!0:this.isUser&&(e=this.notSpam||this.contact.isMyContact),!e&&this.hasMaybeSentMsgToChat()&&(e=!0),this.trusted=e}},{key:"updateMuteExpiration",value:function(){var e=this,t=Number(this.mute.expiration);(0,Ue.updateLocal)(this.id,{muteExpiration:t}).then(function(){return e.muteExpiration=t})}},{key:"updateTitle",value:function(){this.isBroadcast?this.formattedTitle=this.contact.name||this.groupMetadata.participants.map(function(e){return e.contact.formattedShortName}).join(", "):this.isUser?this.formattedTitle=this.contact.getFormattedUser()||"":this.isGroup&&(this.formattedTitle=this.contact.name)}},{key:"title",value:function(){return this.isGroup?this.formattedTitle||l10n.t("unknown_subject"):this.formattedTitle}},{key:"updateCanSend",value:function(){return this.isReadOnly||this.isAnnounceGrpRestrict?this.canSend=!1:this.isUser?this.canSend=!(this.contact.isContactBlocked||this.isPSA):this.canSend=!0}},{key:"delete",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this.cancelPendingPromises(),this.presence.delete(),this.liveLocation&&this.liveLocation.delete(),L.default.clearChat(this),this.groupMetadata&&this.groupMetadata.delete(),this.mediaMsgs&&this.mediaMsgs.delete(),this.linkMsgs&&this.linkMsgs.delete(),this.docMsgs&&this.docMsgs.delete();var e=this.starredMsgs;e&&(e.delete(),e.stopListening(),e.reset()),this.receivedVCardMsgs&&this.receivedVCardMsgs.delete(),be.default.deleteComposeContents(this.id)}},{key:"isDirty",value:function(){return 0!==this.unreadCount}},{key:"resetMediaMsgs",value:function(){var e=this.mediaMsgs,t=this.linkMsgs,i=this.docMsgs;e&&(e.delete(),e.queryMedia(this)),t&&(t.delete(),t.queryLinks(this)),i&&(i.delete(),i.queryDocs(this))}},{key:"addMediaMsgs",value:function(e,t){if(e){var i=Array.isArray(e)?e:[e],n=[],r=[],o=[];i.forEach(function(e){e.isMedia&&n.push(e),e.isDoc&&o.push(e),e.linkPreview&&r.push(e)}),this.mediaMsgs&&n.length&&this.mediaMsgs.add(n,t),this.linkMsgs&&r.length&&this.linkMsgs.add(r,t),this.docMsgs&&o.length&&this.docMsgs.add(o,t)}}},{key:"onNewMsg",value:function(e){var t=this;if(e){var i=Promise.resolve();e.isSentByMe&&!this.notSpam&&(i=(0,Ue.updateLocal)(this.id,{notSpam:!0}).then(function(){return t.notSpam=!0})),"i"!==e.eventType&&i.then(function(){var i={};return i.t=e.t,t.promises.updateSortTime&&t.promises.updateSortTime.cancel(),t.updateMediasCountOnMsg(e),t.archive&&(i.archive=!1),t.promises.setArchive&&t.promises.setArchive.cancel(),e.isSentByMe?t.markedUnread=!1:(t.presence.handle({id:t.id,participant:e.author,type:"paused"}),"a"!==e.eventType&&"d"!==e.eventType||(i.unreadCount=t.unreadCount+1||1)),(0,Ue.updateLocal)(t.id,i).return(i)}).then(function(i){e.isSentByMeFromWeb&&e.promises.sendPromise?t.setAndKeepPrevious(i,e.promises.sendPromise):t.set(i);var n=U.default.get(t.id);if(n&&(n.timestamp=A.default.globalUnixTime()),"gp2"!==e.type||"add"!==e.subtype&&"create"!==e.subtype||de.default.GroupMetadata.trigger("group_participant_change_"+N.default.me.toString(),t.id),!e.isSentByMe){switch(e.eventType){case"d":case"a":"d"===e.eventType&&L.default.alertNewMsg(e),t.msgs.length<_.default.MSG_PRELOAD_THRESHOLD&&t.loadEarlierMsgs(void 0,Q.default.WEBC_QUERY_TRIGGER_TYPE.NEW_MESSAGE_PREFETCH).catch(f.E404,function(){}).catch(function(e){K.default.log("chat:onNewMsg failed")(),K.default.log(e)()});break;case"s":if("gp2"===e.type&&"add"===e.subtype&&N.default.me.equals(g.default.head(e.recipients))&&!t.contact.name)return;L.default.alertNewMsg(e),de.default.GroupMetadata.trigger("group_participant_change_"+N.default.me.toString(),t.id)}var r=e.mediaData;!r||"image"!==r.type&&"video"!==r.type||L.default.newMediaMsg(e)}})}}},{key:"canPin",value:function(){if(this.archive)return!1;var e=this.promises&&this.promises.setArchive;return(!e||!e.archive)&&V.default.supportsFeature(V.default.F.PIN)}},{key:"canArchive",value:function(){return!this.isBroadcast||V.default.supportsFeature(V.default.F.ARCHIVE_BROADCAST)}},{key:"sendDismissChangeNumber",value:function(){var e=this;if(this.promises.sendDismissChangeNumber)return this.promises.sendDismissChangeNumber;var t=Ee.default.sendConversationDismissChangeNumber(this.id);this.promises.sendDismissChangeNumber=t;var i=new Ae.ActionType(l10n.t("action_chat_dismissing_change_number_notification")),n=t.then(function(e){return 200===e.status?new Ae.ActionType(l10n.t("action_chat_dismissed_change_number_notification")):e.status>=400?new Ae.ActionType(l10n.t("action_chat_dismiss_change_number_notification_failed")):void 0}).catch(function(t){return K.default.error("models:chat:sendDismissChangeNumber dropped")(t),new Ae.ActionType(l10n.t("action_chat_dismiss_change_number_notification_failed"),l10n.t("action_try_again"),e.sendDismissChangeNumber.bind(e))});return L.default.openToast(ue.default.createElement(Ae.ActionToast,{id:(0,Ae.genId)(),initialAction:i,pendingAction:n})),t.then(function(t){if(200===t.status&&!t._duplicate)return(0,Ue.updateLocal)(e.id,{changeNumberNewJid:void 0,changeNumberOldJid:void 0}).then(function(){e.changeNumberOldJid=e.changeNumberNewJid=void 0})}).finally(function(){e.promises.sendDismissChangeNumber=null})}},{key:"handleGroupAction",value:function(e,t,i){var n=this;switch(e){case"subject":var r={name:i.subject};return void(0,Ye.updateLocal)(this.contact.id,r).then(function(){n.contact.set(r)});case"add":case"promote":case"demote":var o="promote"===e,a=g.default.map(i.participants,function(e){return{id:e,isAdmin:o}});return this.groupMetadata.participants.add(a,{merge:!0}),void("add"===e&&g.default.forEach(i.participants,function(e){de.default.GroupMetadata.trigger("group_participant_change_"+e,n.id)}));case"remove":var s=this.groupMetadata;return g.default.each(i.participants,function(e){s.participants.remove(e)}),void g.default.forEach(i.participants,function(e){de.default.GroupMetadata.trigger("group_participant_change_"+e,n.id)});case"modify":return;case"invite":return void(i.code?this.groupMetadata.inviteCode=i.code:K.default.error("model:chat:handleGroupAction:invalid invite code: "+i.code+" for "+this.id.toString())());case"desc_add":return void this.groupMetadata.set({desc:i.desc,descId:i.descId,descTime:i.descTime,descOwner:t});case"desc_remove":return void(this.groupMetadata.descId===i.descId&&this.groupMetadata.set({desc:void 0,descId:void 0,descTime:void 0,descOwner:void 0}));case"restrict":return void(this.groupMetadata.restrict=!!i);case"announce":return void(this.groupMetadata.announce=!!i);case"no_frequently_forwarded":return void(this.groupMetadata.noFrequentlyForwarded=!!i);default:return}}},{key:"setComposeContents",value:function(e){this.composeContents=e}},{key:"getSessionPersistedComposeContents",value:function(){return be.default.getComposeContents(this.id)}},{key:"getComposeContents",value:function(){return g.default.isEmpty(this.composeContents)?this.getSessionPersistedComposeContents()||{}:this.composeContents}},{key:"setComposeAttachMediaContents",value:function(e){this.composeAttachMediaContents=e}},{key:"preload",value:function(){1===this.msgs.length&&this.loadEarlierMsgs().catch(f.E404,function(){}).catch(function(e){K.default.log("chat:preload failed")(),K.default.log(e)()})}},{key:"onEmptyMRM",value:function(){K.default.log("models:Chat:removeMsg 0 messages left, querying...")(),this.loadEarlierMsgs().catch(f.E404,function(){}).catch(function(e){K.default.log("chat:onEmptyMRM failed")(),K.default.log(e)()})}},{key:"loadEarlierMsgs",value:function(e,t){var i=this,n=e,r=t||Q.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL;return n||(n=this.msgs),n.msgLoadState.noEarlierMsgs?Promise.resolve():n.msgLoadState.isLoadingEarlierMsgs?n.loadEarlierPromise:this._loadMsgs("before",n,r).then(function(e){return n&&Array.isArray(e)&&e.length<_.default.PAGE_SIZE&&(n.msgLoadState.noEarlierMsgs=!0),n&&i.isMostRecentCMC(n)&&i.trigger("msgs:loadEarlier"),e})}},{key:"isMostRecentCMC",value:function(e){return this.msgs===e}},{key:"loadRecentMsgs",value:function(e){var t=e;return t||(t=this.msgs),this.isMostRecentCMC(t)?Promise.resolve():t.msgLoadState.isLoadingRecentMsgs?t.loadRecentPromise:this._loadMsgs("after",t,Q.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL)}},{key:"_loadMsgs",value:function(e,t,i){var n=void 0;n="after"===e?t.last():t.head();var r={};n?r=n.id.clone():r.remote=this.id,r.count=_.default.PAGE_SIZE,r.direction=e;var o=(0,Fe.newMessageQueryEvent)(i),a=function(e){o.webcResponseBytes+=e.binarySize};return this._loadMsgsPromiseLoop(n,t,$.default.findQuery.bind($.default,r,{logOnSend:a}),e,o)}},{key:"_updateMsgLoadState",value:function(e,t,i){var n=e&&e.msgChunk&&e.msgChunk!==t;t.msgLoadState.contextLoaded=!0,e&&n&&(e.msgChunk.msgLoadState.contextLoaded=!0),"after"===i?t.msgLoadState.isLoadingRecentMsgs=!1:"before"===i?t.msgLoadState.isLoadingEarlierMsgs=!1:"around"===i&&(t.msgLoadState.isLoadingAroundMsgs=!1)}},{key:"_loadMsgsPromiseLoop",value:function(e,t,i,n,r){var o=this,a=performance.now();"after"===n?(t.msgLoadState.isLoadingRecentMsgs=!0,r.webcMessageQueryType=Q.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_NEXT):"before"===n?(t.msgLoadState.isLoadingEarlierMsgs=!0,r.webcMessageQueryType=Q.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_PREV):"around"===n&&(t.msgLoadState.isLoadingAroundMsgs=!0,r.webcMessageQueryType=Q.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_AROUND),r.webcBrowserNetworkType=(0,Re.getEffectiveNetworkType)(),r.webcChatType=this.getWebcChatType(),"number"==typeof this.initialIndex&&(r.webcChatPosition=this.initialIndex);var s=Promise.loop(function(s,u,c){var l=Promise.delay(ye.default.expBackoff(c,12e4,1e3,.1));return("CONNECTED"===le.default.stream?Promise.resolve():h.waitForBBEvent(le.default,"change:stream",function(){return"CONNECTED"===le.default.stream})).then(function(){return o.regCancellablePromise(i()).then(function(i){r.webcQueryT=Math.ceil(performance.now()-a);var u=void 0;Array.isArray(i[0])?(u=i[0][0],i.forEach(function(e){return(0,Fe.logMessageCounts)(r,e)})):(u=i[0],(0,Fe.logMessageCounts)(r,i)),u&&(r.webcEarliestMessageT=u.t,u.msgChunk===o.msgs&&(r.webcEarliestMessageIndex=o.msgs.length-1)),(0,Y.default)().then(function(e){e&&(r.webcBrowserStorageQuotaBytes=e.quota,r.webcBrowserStorageQuotaUsedBytes=e.usage)}).finally(function(){return r.commit()}),o._updateMsgLoadState(e,t,n),s(i)})}).catch(function(e){return!(e instanceof Promise.CancellationError)},function(i){return c>3||404===i?(o._updateMsgLoadState(e,t,n),K.default.error("chat:loadMsgs:error "+String(i))(),404===i?Promise.reject(new f.E404):Promise.reject(new f.GaveUpRetry("Gave up msg fetch after "+c+" tries"))):l})},0);return"after"===n?t.loadRecentPromise=s:"before"===n?t.loadEarlierPromise=s:"around"===n&&(t.loadAroundPromise=s),s}},{key:"getSearchContext",value:function(e,t){var i=this,n=void 0,r=void 0;e instanceof X.default?n=e:e instanceof ie.default&&(r=e);var o=n?n.msgChunk:void 0,a=Math.trunc(_.default.PAGE_SIZE/3*2);if(!o||!o.msgLoadState.contextLoaded){o||(o=new S.default,this.msgChunks.push(o),n&&o.add(n));var s=n?n.id.clone():r.clone();s.count=a;var u=function(){if(n)return n.msgChunk;var e=$.default.get(r);return e&&e.msgChunk?e.msgChunk:o},c=(0,Fe.newMessageQueryEvent)(Q.default.WEBC_QUERY_TRIGGER_TYPE.SEARCH_RESULT_CLICK),l=function(e){c.webcResponseBytes+=e.binarySize};this._loadMsgsPromiseLoop(n,o,$.default.getContext.bind($.default,s,u,l),"around",c).then(function(e){var t=u();t&&o&&t!==o&&i.notifyMsgCollectionMerge(t,o,t);var s=e[0],c=r?$.default.get(r):n;c&&Array.isArray(s)&&s.length<a&&(c.msgChunk.msgLoadState.noEarlierMsgs=!0,o&&c.msgChunk!==o&&(o.msgLoadState.noEarlierMsgs=!0))}).catch(function(){t&&(t.isQuotedMsgAvailable=!1)})}return{collection:o,msg:n,key:r,highlightMsg:!0}}},{key:"sendStarMsgs",value:function(e,t){var i=this;return this.promises.sendStarMsgs?this.promises.sendStarMsgs:this.promises.sendStarMsgs=(0,xe.sendStarMsgs)(this.id,e,t).then(function(){g.default.forEach(e,function(e){e.set("star",t)}),t?(0,y.addStarredMsgs)(e):(0,y.removeStarredMsgs)(e)}).finally(function(){i.promises.sendStarMsgs=null})}},{key:"sendRevokeMsgs",value:function(e,t){var i=this;return this.promises.sendRevokeMsgs?this.promises.sendRevokeMsgs:this.promises.sendRevokeMsgs=Promise.all(e.map(function(e){return e.sendRevoke(t)})).finally(function(){i.promises.sendRevokeMsgs=null})}},{key:"sendDeleteMsgs",value:function(e,t){var i=this;return this.promises.sendDeleteMsgs?this.promises.sendDeleteMsgs:this.promises.sendDeleteMsgs=Ee.default.sendMessageDelete(this.id,g.default.map(e,function(e){return e.id}),t).then(function(t){var i=[];return 200===t.status?(g.default.forEach(e,function(e){e.delete()}),e.length):(t.status>=400&&(i=g.default.filter(e,function(e){return-1===e.ack&&(e.delete(),!0)})),i.length)}).finally(function(){i.promises.sendDeleteMsgs=null})}},{key:"deleteMsgs",value:function(e,t){this.deleteMsgsBeforeMsgInclusive(void 0,!e,t)}},{key:"deleteMsgsOlderThan",value:function(e,t,i){var n=this.msgs,r=n.head();if(r&&!(r.t>=e)){if((r=n.last())&&r.t<e)return void this.deleteMsgs(t,i);var o=function(n,r,o){return n&&(i&&!(0,ee.msgMatchesType)(n,i)||n.star&&!t||n.t>=e||n.isPersistent)};this.deleteMsgsPartial(o)}}},{key:"deleteMsgsBeforeMsgInclusive",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments[2],n=void 0;if(e){if(!this.msgs.get(e.id))return;n=this.msgs.indexOf(e)}else n=this.msgs.length;var r=function(e,r,o){return i&&!(0,ee.msgMatchesType)(e,i)||e.msgChunk===this.msgs&&r>n||t&&e.star||e.isPersistent&&t};this.deleteMsgsPartial(r,!0)}},{key:"deleteMsgsPartial",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.unreadCount;if(this.getAllCMCs().forEach(function(n){var r=n.filter(function(i,n,r){return!e.apply(t,[i,n,r])});n.remove(r,void 0,i),r.forEach(function(e){e.delete()})}),g.default.clone(this.msgChunks).forEach(function(e){0===e.length&&t.removeMsgsCollection(e)}),this.msgs.length>0){var r=n>this.msgs.length?this.msgs.length:n;(0,Ue.updateLocal)(this.id,{unreadCount:r}).then(function(){t.unreadCount=r,t.msgs.msgLoadState.noEarlierMsgs=!0})}}},{key:"getFirstMsgWithStatus",value:function(){return g.default.find(this.msgs.getModelsArray(),function(e){return!e.isNotification&&(e.isSentByMe||e.type===_.default.MSG_TYPE.PTT)})}},{key:"getLastReceivedMsg",value:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&(!t.local||t.ack>0))return t}}},{key:"getLastMsgKeyForAction",value:function(){var e=this.msgs.last();if(e)return!this.lastReceivedKey||e.id.fromMe&&e.local&&0===e.ack?e.id:this.lastReceivedKey}},{key:"getLastTimestampMsg",value:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&"i"!==t.eventTypeFromMsgType())return t}}},{key:"getWebcChatType",value:function(){switch(this.kind){case Be.CHAT:return Q.default.WEBC_CHAT_TYPE.INDIVIDUAL;case Be.GROUP:return Q.default.WEBC_CHAT_TYPE.GROUP;case Be.BROADCAST:return Q.default.WEBC_CHAT_TYPE.BROADCAST_LIST;default:throw new TypeError("Invalid Chat.kind "+String(this.kind))}}},{key:"sendContact",value:function(e,t){var i=t&&t.msgContextInfo(this.id),n=g.default.defaults({ack:0,body:ke.default.fromContactModel(e).vcard,from:N.default.me,id:new ie.default({from:N.default.me,to:this.id,id:(0,Ce.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",subtype:e.formattedName,t:A.default.globalUnixTime(),to:this.id,type:"vcard",isNewMsg:!0},i||{});(0,Ge.addAndSendMsgToChat)(this,n)}},{key:"sendGroupInviteMessage",value:function(e,t,i,n,r,o){var a=g.default.defaults({ack:0,from:N.default.me,id:new ie.default({from:N.default.me,to:this.id,id:(0,Ce.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",t:A.default.globalUnixTime(),to:this.id,type:"groups_v4_invite",isNewMsg:!0,inviteGrpJpegThum:o,inviteCode:i,inviteCodeExp:n,inviteGrp:e,inviteGrpName:t,comment:r},{});return(0,Ge.addAndSendMsgToChat)(this,a)[1]}},{key:"sendContactList",value:function(e,t){var i=e.map(ke.default.fromContactModel,ke.default),n=t&&t.msgContextInfo(this.id),r=g.default.defaults({ack:0,from:N.default.me,id:new ie.default({from:N.default.me,to:this.id,id:(0,Ce.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",t:A.default.globalUnixTime(),to:this.id,type:"multi_vcard",vcardList:i,isNewMsg:!0},n||{});(0,Ge.addAndSendMsgToChat)(this,r)}},{key:"forwardMessages",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.id,r=this.contact;if(r.isUser&&r.isBlocked())return Promise.reject(new F.default("Forwarded to contact is blocked",r));var o=[];return Promise.each(e,function(e){if(e.isMMS)return(0,Le.forwardMediaMsg)(e,t,i);var r=e.quotedMsg&&e.quotedMsg.type===_.default.MSG_TYPE.PRODUCT?e.toJSON():g.default.omit(e.toJSON(),["quotedMsg","quotedParticipant","quotedRemoteJid","quotedStanzaID"]),o=new ie.default({from:N.default.me,to:n,id:(0,Ce.default)(),participant:void 0,selfDir:"out"});g.default.assign(r,{id:o,from:N.default.me,t:A.default.globalUnixTime(),to:n,ack:0,participant:void 0,local:!0,self:"out",isNewMsg:!0,star:!1,isForwarded:e.isForwarded||!e.isSentByMe,forwardingScore:e.getForwardingScoreWhenForwarded(),multicast:i}),(0,Ge.addAndSendMsgToChat)(t,r)}).return(o)}},{key:"updateReadOnly",value:function(){var e=this,t=Promise.resolve();if(this.isGroup&&!this.groupMetadata.stale){var i=!this.groupMetadata.participants.get(N.default.me);t=(0,Ue.updateLocal)(this.id,{isReadOnly:i}).then(function(){return e.isReadOnly=i})}t.then(function(){e.isBroadcast&&e.updateTitle()})}},{key:"updateIsAnnounceGrpRestrict",value:function(){var e=this;if(this.isGroup&&!this.groupMetadata.stale){var t=this.groupMetadata.participants.get(N.default.me),i=t&&!t.isAdmin&&this.groupMetadata.announce;(0,Ue.updateLocal)(this.id,{isAnnounceGrpRestrict:i}).then(function(){return e.isAnnounceGrpRestrict=i})}}},{key:"sortMsgs",value:function(e){var t=e.map(function(e){var t=e.msgChunk;return{msg:e,chunkT:(0,Me.default)(t.at(0)).t,index:t.indexOf(e)}});return g.default.orderBy(t,["chunkT","index"]).map(function(e){return e.msg})}},{key:"_updateAssignedColor",value:function(){if(this.colors){var e=this.groupMetadata.participants,t=this.colors,i=g.default.difference(g.default.keys(t),e.map(function(e){return e.id.toString()}).map(Te.default));i.forEach(function(e){delete t[e]}),i.length&&this._saveAssignedColors()}}},{key:"loadAssignedColors",value:function(){return this.groupMetadata&&this.listenTo(this.groupMetadata.participants,"remove reset",this._updateAssignedColor),be.default.getGroupParticipantAssignedColor(this.id)||{}}},{key:"saveAssignedColors",value:function(){var e=this.colors;e&&be.default.setGroupParticipantAssignedColor(this.id,e)}},{key:"assignedColor",value:function(e){var t=this.colors||(this.colors=this.loadAssignedColors()),i=void 0,n=(0,Te.default)(e.toString());if(i=t[n])return i;var r={};g.default.forEach(t,function(e,t){r[e]?r[e].push(t):r[e]=[t]});for(var o=Number.POSITIVE_INFINITY,a=1;a<_.default.NUM_COLORS;a++){if(!r[a]){i=a;break}r[a].length<o&&(o=r[a].length,i=a)}return t[n]=i,this._saveAssignedColors(),i}},{key:"unstarAll",value:function(){var e=this.getAllMsgs();e.forEach(function(e){e&&(e.star=!1)}),(0,y.removeStarredMsgs)(e)}},{key:"constructMediaMsgs",value:function(e){if(!e)return this.getMediaMsgs();var t=void 0;return this.getMediaMsgs().contains(e)||e.msgChunk===this.msgs?(t=this.getMediaMsgs(),t.hasMediaAfter=!1):t=new j.default,t.contains(e)||(e.msgChunk?t.add(e.msgChunk.filter(function(e){return e.isMedia})):t.add(e)),t}},{key:"fts",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments[2];if(1===i){var r=this.ftsCache[e];if(r)return r;var o=$.default.search(e,i,n,this.id);this.ftsCache[e]=o;var a=function(){t.ftsCache[e]=null};return g.default.delay(a,3e5),o.catch(a),o}return $.default.search(e,i,n,this.id)}},{key:"_clearFtsCache",value:function(){this.ftsCache={}}},{key:"updateSortTime",value:function(){var e=this;this.promises.updateSortTime||(this.promises.updateSortTime=this.regCancellablePromise(Promise.delay(0)).then(function(){var t=e.getLastTimestampMsg();return t?(e.t=t.t,Promise.resolve()):e.msgs.msgLoadState.noEarlierMsgs?Promise.resolve():e.pendingMsgs?Promise.resolve():e.loadEarlierMsgs()}).then(function(t){if(t){var i=e.getLastTimestampMsg();e.t=i?i.t:void 0}}).catch(function(){}).finally(function(){e.promises.updateSortTime=void 0}))}},{key:"removeFromCollection",value:function(e){e.star&&(0,y.removeStarredMsgs)([e]),e.isMedia&&this.mediaMsgs?this.mediaMsgs.remove(e):e.getLinks().length&&this.linkMsgs?this.linkMsgs.remove(e):e.isDoc&&this.docMsgs&&this.docMsgs.remove(e),this.updateMediasCountOnMsg(e,!0)}},{key:"getMediaMsgs",value:function(){return this.mediaMsgs||(this.mediaMsgs=new j.default),this.mediaMsgs}},{key:"getLinkMsgs",value:function(){return this.linkMsgs||(this.linkMsgs=new P.default),this.linkMsgs}},{key:"getDocMsgs",value:function(){return this.docMsgs||(this.docMsgs=new O.default),this.docMsgs}},{key:"getReceivedVCardMsgs",value:function(){return this.contact.isMyContact||!this.contact.isUser?null:(this.receivedVCardMsgs||(this.receivedVCardMsgs=new w.default,this.receivedVCardMsgs.parent=this),this.receivedVCardMsgs)}},{key:"dismissVCard",value:function(){this.vcardDismissed=!0}},{key:"updateMediasCountOnMsg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(V.default.supportsFeature(V.default.F.MEDIAS_COUNT)){var i=t?-1:1;e.isMedia&&(this.mediaCount+=i);var n=e.getLinks().length;if(n){var r=i*n;this.linkCount+=r}e.isDoc&&(this.docCount+=i)}}},{key:"resetMediasCount",value:function(e){V.default.supportsFeature(V.default.F.MEDIAS_COUNT)&&(e.mediaCount&&(this.mediaCount=e.mediaCount),e.linkCount&&(this.linkCount=e.linkCount),e.docCount&&(this.docCount=e.docCount))}},{key:"getStarredMsgs",value:function(){var e=this,t=this.starredMsgs;return t||(this.starredMsgs=t=new y.StarredMsgCollection,this.starredMsgs.add(v.default.filter(function(t){return t.chat===e}))),t}},{key:"setAndKeepPrevious",value:function(e,t){var i=this,n=Object.keys(e);n.forEach(function(e){e in i.ackedProps||(i.ackedProps[e]=i[e])}),t.finally(function(){n.forEach(function(e){delete i.ackedProps[e]})}),this.set(e)}},{key:"getAckedPhoneProps",value:function(){return{wid:this.id,mute:this.mute.expiration,active:this.active,isReadOnly:this.isReadOnly,modifyTag:this.modifyTag,unreadCount:this.unreadCount,changeNumberOldJid:this.changeNumberOldJid,changeNumberNewJid:this.changeNumberNewJid,archive:"archive"in this.ackedProps?this.ackedProps.archive:this.archive,notSpam:"notSpam"in this.ackedProps?this.ackedProps.notSpam:this.notSpam,pin:"pin"in this.ackedProps?this.ackedProps.pin:this.pin}}},{key:"regCancellablePromise",value:function(e){var t=this;return this._promises||(this._promises=[]),this._promises.push(e),e.cancellable().finally(function(){t._promises=g.default.without(t._promises,e),t._promises&&0===t._promises.length&&(t._promises=null)})}},{key:"cancelPendingPromises",value:function(){this._promises&&this._promises.length>0&&(this._promises.forEach(function(e){e.cancel()}),this._promises=null)}},{key:"matchFilter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!g.default.isEmpty(e)||(e.label?g.default.includes(this.labels,e.label):e.kind===_.default.SMB_SEARCH_FILTERS.UNREAD?!!this.hasUnread:e.kind===this.kind)}}]),t}(pe.default);Ve.Collection="Chat",Ve.Proxy="chat",Ve.idClass=me.default,t.default=(0,Ie.defineModel)(Ve)},ecadbdfdef:function(e,t,i){"use strict";var n={cache:{},delete:function(){this.cache={}}};e.exports=n},eciicfcjdi:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("cjcghajbag"),d=n(f),h=i("jccfhaecf"),p=n(h),g=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,c.prop)(),n.afterCursor=(0,c.prop)(),n.index=(0,c.prop)(),n.fetchedFromServer=(0,c.session)(),n._products=(0,c.session)(),n._msgs=(0,c.session)(),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.productCollection=new d.default,this.msgProductCollection=new d.default,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.listenTo(this,"change:_msgs",this.triggerMsgUpdate),this.triggerProductUpdate(),this.triggerMsgUpdate()}},{key:"triggerProductUpdate",value:function(){this._products&&this.productCollection.add(this._products,{merge:!0}),this._products=void 0}},{key:"triggerMsgUpdate",value:function(){this._msgs&&this.msgProductCollection.add(this._msgs,{merge:!0}),this._msgs=void 0}},{key:"markProductCollectionOld",value:function(){this.productCollection.forEach(function(e){return e.markOld()})}}]),t}(l.default);g.Collection="Catalog",g.Proxy="catalog",g.idClass=p.default,t.default=(0,c.defineModel)(g)},eigdejjai:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("eadfaddcj"),c=n(u),l=i("bdiiahhjbe"),f=n(l),d=i("bdhgicebce"),h=n(d),p=i("ccgjijjbbj"),g=n(p),y=i("eacidghfgh"),v=n(y),b=i("bhggeigghg"),_=n(b),m=i("cgcgbfbffj"),O=n(m),E=i("chajfbfiga"),P=n(E),T=i("jccfhaecf"),j=n(T),C=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_initializeStaleCollection",value:function(){var e=this;this.listenTo(v.default,"change:stream",function(){v.default.stream===y.STREAM.DISCONNECTED&&e.forEach(function(e){e.settled||e.set("stale",!0)})})}},{key:"_find",value:function(e){var t=_.default.Msg.get(e);return t?t.isSentByMe?P.default.queryMsgInfo(t.id).then(function(e){return e.status>=400?(f.default.log("model:MsgInfo:findQuery error "+e.status)(),Promise.reject(e.status)):(e.id=t.id,e.isPTT=t.type===c.default.MSG_TYPE.PTT,Promise.resolve(e))}):Promise.reject("message not sent by me"):Promise.reject("No message found for id: "+e)}},{key:"updateInfo",value:function(e,t,i,n,r,o){var a=new g.default({from:t,to:i,id:e,participant:r}),s=new g.default({from:t,to:i,id:e}),u=this.get(a)||this.get(s);if(u){if(!j.default.isUser(s.remote)){if(2!==n){var c=u.delivery.get(r);c&&u.delivery.remove(c)}if(3!==n){var l=u.read.get(r);l&&u.read.remove(l)}if(4!==n){var f=u.played.get(r);f&&u.played.remove(f)}}4===n?(u.played.get(r)||(u.playedRemaining-=1),u.played.add({id:r,t:o})):3===n?(u.delivery.get(r)||(u.readRemaining-=1),u.read.add({id:r,t:o})):2===n&&(u.delivery.get(r)||(u.deliveryRemaining-=1),u.delivery.add({id:r,t:o}))}}},{key:"handle",value:function(e){var t=this,i=e.shift();switch(i.cmd){case"ack":this.updateInfo(i.id,i.from,i.to,i.ack,i.participant,i.t);break;case"acks":i.id.forEach(function(e){t.updateInfo(e,i.from,i.to,i.ack,i.participant,i.t)})}}}]),t}(O.default);C.model=h.default,C.staleCollection=!0,t.default=new C},ejegihaeh:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("eciicfcjdi"),l=n(c),f=i("cgcgbfbffj"),d=n(f),h=i("ccaaiecfib"),p=n(h),g=i("chajfbfiga"),y=n(g),v=i("dcbdjheea"),b=i("hjbbdjjdf"),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"addMsgAsproduct",value:function(e){p.default.supportsFeature(p.default.F.CATALOG)||Promise.reject("Not supported");var i=e.businessOwnerJid&&(0,v.createWid)(e.businessOwnerJid);if(i){var n=this.get(i),r=n&&e.productId&&n.msgProductCollection.get(e.productId),o=n&&e.productId&&n.productCollection.get(e.productId);if(!(o&&o.t&&o.t>=e.t||r&&r.fetchedFromServer)){var a={id:e.productId,url:e.url,name:e.title,description:e.description,imageCdnUrl:{rawUrl:e.mediaData.renderableUrl},catalogWid:i,reviewStatus:"",currency:e.currencyCode,priceAmount1000:e.priceAmount1000,retailerId:e.retailerId,productMsgMediaData:e.mediaData,imageCount:e.productImageCount?e.productImageCount:1,fetchedFromServer:!1,t:e.t};return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,{id:i,afterCursor:void 0,_msgs:[a],stale:!0,fetchedFromServer:!!o},{merge:!0})}}}},{key:"_queryProduct",value:function(e,i){var n=this,r=e.toString({legacy:!0});return y.default.queryProduct(r,i).then(function(i){if(!i.data)return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",n).call(n,{id:e,afterCursor:void 0});var r=i.data;if(!r.image_cdn_urls||r.image_cdn_urls[0].value.includes("https://static.whatsapp.net"))return Promise.reject(new Error("CatalogCollection:findProduct:_queryProduct "+(r.image_cdn_urls?"Product image contains static image":"Could not find image_cdn_urls for product")));var o={id:r.id,url:r.url,name:r.name,description:r.description,additionalImageCdnUrl:r.additional_image_cdn_urls.map(function(e){return{rawUrl:e[1].value}}),imageCdnUrl:{rawUrl:r.image_cdn_urls[1].value},catalogWid:e,reviewStatus:r.capability_to_review_status.length&&r.capability_to_review_status[0].value,currency:r.currency,priceAmount1000:r.price?10*r.price:null,retailerId:r.retailer_id,productMsgMediaData:null,imageCount:r.additional_image_cdn_urls.length+1,fetchedFromServer:!0,t:Date.now()/1e3},a=[o];return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",n).call(n,{id:e,afterCursor:void 0,_products:a,_msgs:a,fetchedFromServer:!0},{merge:!0})})}},{key:"findProduct",value:function(e,t){return p.default.supportsFeature(p.default.F.CATALOG)||Promise.reject(new Error("Catalog not supported")),t?this._queryProduct(e,t):Promise.reject(new Error("CatalogCollection:findProduct Received productId type "+(void 0===t?"undefined":"null")))}},{key:"_queryCatalog",value:function(e,t,i,n){var r=e?e.index:0;return y.default.queryProductCatalog(i,n,10).then(function(e){if(!e.data.length)return{id:t,afterCursor:void 0};var i=[];return e.data.forEach(function(e,n){e.image_cdn_urls&&!e.image_cdn_urls[0].value.includes("https://static.whatsapp.net")&&i.push({id:e.id,url:e.url,name:e.name,description:e.description,additionalImageCdnUrl:e.additional_image_cdn_urls.map(function(e){return{rawUrl:e[1].value}}),imageCdnUrl:{rawUrl:e.image_cdn_urls[1].value},catalogWid:t,reviewStatus:e.capability_to_review_status.length?e.capability_to_review_status[0].value:null,currency:e.currency,priceAmount1000:e.price?10*e.price:null,retailerId:e.retailer_id,productMsgMediaData:null,imageCount:e.additional_image_cdn_urls.length+1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1,index:r+n})}),{id:t,afterCursor:e.paging.cursors.after,_products:i,fetchedFromServer:!0,index:r+i.length}})}},{key:"_findQuery",value:function(e){p.default.supportsFeature(p.default.F.CATALOG)||Promise.reject(new Error("Catalog not supported"));var t=this.get(e),i=t&&!t.stale?t.afterCursor:void 0,n=e.user+"@s.whatsapp.net";return this._queryCatalog(t,e,n,i)}},{key:"_find",value:function(e){return p.default.supportsFeature(p.default.F.CATALOG)||Promise.reject(new Error("Catalog not supported")),this._findQuery(e)}},{key:"findCarouselCatalog",value:function(e){var i=this,n=this.get(e),r=(0,b.isString)(e)?(0,v.createWid)(e):e,o=(0,b.isString)(e)?e:e.toString({legacy:!0});return n&&n.set({index:0}),this._queryCatalog(n,r,o,void 0).then(function(e){return n&&n.markProductCollectionOld(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",i).call(i,e,{merge:!0})})}}]),t}(d.default);_.model=l.default,_.staleCollection=!0,t.default=new _},ejiicdbii:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BusinessProfileCollection=void 0;var s=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("bdiiahhjbe"),l=n(c),f=i("defecifdhg"),d=n(f),h=i("cgcgbfbffj"),p=n(h),g=i("ejegihaeh"),y=n(g),v=i("dhigahgdjb"),b=n(v),_=i("ccaaiecfib"),m=n(_),O=i("chajfbfiga"),E=n(O),P=i("hbhijdici"),T=n(P),j=i("bechdajic"),C=t.BusinessProfileCollection=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"parseBusinessHours",value:function(e){var t=e.config,i={};return t.forEach(function(e){var t=e.day_of_week,n=e.mode;if(n===j.BUSINESS_HOUR_MODES.SPECIFIC_HOURS){var r=e.open_time,o=e.close_time;i[t]||(i[t]={mode:n,hours:[]}),r&&o&&i[t].hours&&i[t].hours.push([r,o])}else i[t]={mode:n}}),{config:i}}},{key:"_find",value:function(e){var t=this,i=this.gadd(e);return E.default.queryBusinessProfile([{wid:i.id,tag:i.tag}]).then(function(i){if(!Array.isArray(i))return l.default.error("Received invalid business profile response")(i),null;if(0===i.length)return l.default.info("Store:BusinessProfile:find No businessProfile found for "+String(e))(),{id:e};var n=i[0],r={id:n.wid,tag:n.tag},o=n.profile;if(o){var a=o.business_hours,s=o.catalog_status;a&&(o.business_hours=void 0,o.businessHours=t.parseBusinessHours(a)),m.default.supportsFeature(m.default.F.CATALOG)&&s&&"catalog_exists"===s&&(o.catalog_status=void 0,o.catalogStatus=s,y.default.findCarouselCatalog(e).then(function(t){var i=Array.isArray(t)?t[0]:t;b.default.assertGet(e).businessCatalog=i}).catch(function(e){return l.default.warn("Store:BusinessProfile:missing catalog")(e)})),T.default.assign(r,f.DEFAULTS,o)}return r})}},{key:"onResume",value:function(){var e=this;this.filter(function(e){return e.stale&&e.hasObservers()}).map(function(t){return e.find(t.id)})}},{key:"handle",value:function(e){var t=s(e,1),i=t[0];i&&i.tag||l.default.error("Store:BusinessProfile:handle Received invalid update from server")(i);var n=this.gadd(i.wid);i.tag!==n.tag&&n.markStale()}}]),t}(p.default);C.model=d.default,C.staleCollection=!0,t.default=new C},fagbfehid:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PAGE_FETCH_STATE=t.PAGE_SIZE=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("hbhijdici"),f=n(l),d=i("cgcgbfbffj"),h=n(d),p=i("bdiiahhjbe"),g=n(p),y=i("cdaedfafjc"),v=n(y),b=i("chajfbfiga"),_=n(b),m=t.PAGE_SIZE=9,O=t.PAGE_FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"},E=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.checksum=null,e._pageFetchPromises={},e.pageFetchStates={},e._handleChecksumChange=function(t){Object.keys(e.pageFetchStates).forEach(function(t){return e._resetFetchPageStateAndPromise(parseInt(t,10))}),e._resetRangeWithPlaceholders(0,e.length),e.fetchAt(0,!1,!0)},e.listenTo(e,"change:checksum",e._handleChecksumChange),e}return a(t,e),u(t,[{key:"createPlaceholder",value:function(e){return t.createPlaceholder(e)}},{key:"fetchAt",value:function(e,t,i){this._fetchPageWithIndex(e,Boolean(t),Boolean(i))}},{key:"hasFetchedData",value:function(){var e=this;return Object.keys(this.pageFetchStates).some(function(t){return e.pageFetchStates[parseInt(t,10)]===O.SUCCESS})}},{key:"isFetchingData",value:function(){var e=this;return Object.keys(this.pageFetchStates).some(function(t){return e.pageFetchStates[parseInt(t,10)]===O.PENDING})}},{key:"pageWithIndex",value:function(e){return t.pageWithIndex(e)}},{key:"reset",value:function(){var e=this;return this.setChecksum(null,{silent:!0}),Object.keys(this.pageFetchStates).forEach(function(t){return e._resetFetchPageStateAndPromise(parseInt(t,10))}),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reset",this).call(this)}},{key:"sync",value:function(e){this.setChecksum(e)}},{key:"setChecksum",value:function(e,t){if(this.checksum!==e){this.checksum=e;return t&&t.silent||this.trigger("change:checksum",e),!0}return!1}},{key:"_fetchPageWithIndex",value:function(e,t,i){var n=this.pageWithIndex(e);return this._fetchPage(n,t,i)}},{key:"_fetchPage",value:function(e,t,i){var n=this,r=this.pageFetchStates[e],o=void 0;if(t&&r!==O.PENDING&&(o=this._pageFetchPromises[e])&&(o.cancel(),delete this._pageFetchPromises[e]),o=this._pageFetchPromises[e])return o;var a=this.length;return this._insertPagePlaceholders(e),this._setFetchPageState(e,O.PENDING),this._pageFetchPromises[e]=_.default.queryStickerPacks(e,m).cancellable().then(function(t){var r=n._parseStickerPacksRes(e,t),o=i||n.setChecksum(t.checksum,{silent:!0}),s=(e-1)*m,u=(e+0)*m;n._resetRange(s,u,r),o&&(n._resetRangeWithPlaceholders(0,s),n._resetRangeWithPlaceholders(Math.min(s+r.length,u),t.count));var c=n.length;a!==c&&n.trigger("change:length",c),n._setFetchPageState(e,O.SUCCESS)}).catch(function(t){if(t instanceof Promise.CancellationError)return g.default.log("StickerPack page fetch promise cancelled: "+e)(),void n._unsetFetchPageStateAndPromise(e);n._setFetchPageState(e,O.ERROR)}),this._pageFetchPromises[e]}},{key:"_insertPagePlaceholders",value:function(e){var t=e-1;this._resetRangeWithPlaceholders(t*m,(t+1)*m)}},{key:"_parseStickerPacksRes",value:function(e,t){if(200!==t.status||!t.data)throw new Error("sticker packs query error");return t.data.map(function(t,i){return s({},f.default.pick(t,["id","mimetype","name","url","mediaKey","filehash","directPath"]),{uploadhash:t.encFilehash,page:e,index:(e-1)*m+i})})}},{key:"_resetRangeWithPlaceholders",value:function(e,i){this._resetRange(e,i,f.default.times(i-e,function(i){return t.createPlaceholder(e+i)}))}},{key:"_resetRange",value:function(e,t,i){var n=this;this._forEachInRange(e,t,function(t,r){var o=i[r-e];if(t)if(o)t.id===o.id?(n.remove(t,{silent:!0}),n.add(o)):(n.remove(t),n.add(o));else for(var a=t;a;)n.remove(a),a=n.at(r);else o&&n.add(o)})}},{key:"_forEachInRange",value:function(e,t,i){for(var n=e;n<t;n++){i(this.at(n),n)}}},{key:"_resetFetchPageStateAndPromise",value:function(e){if(e in this.pageFetchStates){this.pageFetchStates[e]===O.PENDING?this._pageFetchPromises[e].cancel():this._unsetFetchPageStateAndPromise(e)}}},{key:"_setFetchPageState",value:function(e,t){this.pageFetchStates[e]!==t&&(this.pageFetchStates[e]=t,this.trigger("change:pageFetchStates",e,t))}},{key:"_unsetFetchPageState",value:function(e){e in this.pageFetchStates&&(delete this.pageFetchStates[e],this.trigger("change:pageFetchStates",e))}},{key:"_unsetFetchPageStateAndPromise",value:function(e){delete this._pageFetchPromises[e],this._unsetFetchPageState(e)}}]),t}(h.default);E.model=v.default,E.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0},E.createPlaceholder=function(e){return v.default.createPlaceholder({index:e,page:this.pageWithIndex(e)})},E.pageWithIndex=function(e){return Math.floor(e/m)+1},t.default=new E},fcedgihic:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("cccehdaiaf"),l=n(c),f=i("bdiiahhjbe"),d=n(f),h=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i.parent&&(n.parent=i.parent);var a=n.constructor,s=a.model,u=a.comparator;if(!s)throw new Error("Collection initialized without model!");return n._model=s,u&&(n._comparator=u),n._reset(),n}return a(t,e),u(t,[{key:"add",value:function(e,t){var i=void 0;return i=Array.isArray(e)?e.slice():e?[e]:[],this.set(i,s({merge:!1,add:!0,remove:!1},t))}},{key:"set",value:function(e,t){if(!e)return d.default.error("collection:set called with no models")(),[];for(var i=s({add:!0,remove:!0,merge:!0},t),n=void 0,r=void 0,o=void 0,a=void 0,u=this._comparator&&!1!==i.sort,c=[],l=[],f={},h=i.add,p=i.at,g=i.merge,y=i.remove,v=!(u||!h||!y)&&[],b=0,_=e.length;b<_;b++)if(a=e[b],this.isModel(a)&&(r=a),n=a.id){if(o=this.get(n))y&&(f[o.id.toString()]=!0),g&&(a=r&&a===r?r.attributes:a,o.set(a,i)),e[b]=o;else if(h){if(!(r=e[b]=this._prepareModel(a,i)))continue;c.push(r),this._addReference(r)}r=o||r,r&&(!v||r.id&&f[r.id.toString()]||v.push(r),f[r.id.toString()]=!0)}else d.default.error("collection:set model has no id")();if(y){for(var m=0,O=this.length;m<O;m++)r=this._models[m],f[r.id.toString()]||l.push(r);l.length&&this.remove(l,i)}var E=void 0;if(c.length||v&&v.length)if(u&&(E=!0),"number"==typeof p){var P;(P=this._models).splice.apply(P,[p,0].concat(c))}else for(var T=v||c,j=0,C=T.length;j<C;j++)this._models.push(T[j]);if(E&&this.sort({silent:!0}),!i.silent){for(var S=0,M=c.length;S<M;S++)r=c[S],r.trigger?r.trigger("add",r,this,i):this.trigger("add",r,this,i);(E||v&&v.length)&&this.trigger("sort",this,i)}return e}},{key:"remove",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=void 0,n=void 0,r=void 0,o=void 0,a=Array.isArray(e)?e.slice():[e],s=[],u=0,c=a.length;u<c;u++)(o=a[u])&&(r=o instanceof this._model?o.id:o,(i=s[u]=this.get(r))&&(this._deIndex(i),n=this._models.indexOf(i),this._models.splice(n,1),t.silent||(t.index=n,i.trigger?i.trigger("remove",i,this,t):this.trigger("remove",i,this,t)),this._removeReference(i)));return s}},{key:"reset",value:function(){for(var e=0,t=this._models.length;e<t;e++)this._removeReference(this._models[e]);this._reset(),this.trigger("reset",this)}},{key:"sort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this._comparator)throw new Error("Cannot sort without comparator");return this._models.sort(this._comparator.bind(this)),e.silent||this.trigger("sort",this,e),this}},{key:"replaceId",value:function(e,t){var i=this.get(e);i&&(this._removeFromIndex(e),i.set({id:t}),this._addIndex(i))}},{key:"get",value:function(e){return this._index[e]}},{key:"assertGet",value:function(e){var t=this._index[e];if(!t){var i=this._model.prototype.Collection||"Unknown";d.default.assert(!1,i+"Collection:assertGet")()}return t}},{key:"at",value:function(e){return this._models[e]}},{key:"serialize",value:function(){return this.map(function(e){return e.toJSON()})}},{key:"toJSON",value:function(){return this.serialize()}},{key:"isModel",value:function(e){return e instanceof this._model}},{key:"indexOf",value:function(e,t){return this._models.indexOf(e,t)}},{key:"lastIndexOf",value:function(e,t){return this._models.lastIndexOf(e,t)}},{key:"every",value:function(e){return this._models.every(e)}},{key:"some",value:function(e){return this._models.some(e)}},{key:"forEach",value:function(e){this._models.forEach(e)}},{key:"map",value:function(e){return this._models.map(e)}},{key:"filter",value:function(e){return this._models.filter(e)}},{key:"reduce",value:function(e,t){return this._models.reduce(e,t)}},{key:"slice",value:function(e,t){return this._models.slice(e,t)}},{key:"where",value:function(e){return this.filter(function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})}},{key:"head",value:function(){return this._models[0]}},{key:"last",value:function(){return this._models[this._models.length-1]}},{key:"toArray",value:function(){return this._models.slice()}},{key:"getModelsArray",value:function(){return this._models}},{key:"_reset",value:function(){this._models=[],this._index={}}},{key:"_prepareModel",value:function(e,t){if(this.isModel(e))return e.collection||(e.collection=this),e;var i=s({},t,{collection:this});try{return new this._model(e,i)}catch(e){return void d.default.error("collection:_prepareModel exception: ",e.stack)()}}},{key:"_addReference",value:function(e){this._addIndex(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)}},{key:"_removeReference",value:function(e){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)}},{key:"_addIndex",value:function(e){this._index[e.id]=e}},{key:"_deIndex",value:function(e){delete this._index[e.id]}},{key:"_removeFromIndex",value:function(e){this.get(e)&&delete this._index[e]}},{key:"_onModelEvent",value:function(e,t,i,n){var r=e.split(":")[0];("add"!==r&&"remove"!==r||i===this)&&("destroy"===r&&this.remove(t,n),this.trigger.apply(this,arguments))}},{key:"length",get:function(){return this._models.length}},{key:"isCollection",get:function(){return!0}},{key:"models",get:function(){return this._models}}]),t}(l.default);t.default=h},fcfchiagj:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("bjigbaghc"),d=n(f),h=i("eadfaddcj"),p=n(h),g=i("dhigahgdjb"),y=n(g),v=i("ccaaiecfib"),b=n(v),_=i("bdiiahhjbe"),m=n(_),O=i("dfhgffbdig"),E=n(O),P=i("dhhbbaegif"),T=n(P),j=i("chajfbfiga"),C=n(j),S=i("jccfhaecf"),M=n(S),w=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.participants=(0,c.collection)(E.default),n.pendingParticipants=(0,c.collection)(T.default),n.id=(0,c.prop)(),n.creation=(0,c.prop)(),n.owner=(0,c.prop)(),n.desc=(0,c.prop)(),n.descId=(0,c.prop)(),n.descTime=(0,c.prop)(),n.descOwner=(0,c.prop)(),n.restrict=(0,c.prop)(),n.announce=(0,c.prop)(),n.noFrequentlyForwarded=(0,c.prop)(),n.size=(0,c.prop)(),n.stale=(0,c.session)(!0),n.trusted=(0,c.session)(!0),n.inviteCode=(0,c.session)(),n.groupInviteCodePromise=(0,c.session)(),n.revokeGroupInvitePromise=(0,c.session)(),n.revokeGroupV4AddInvitePromise=(0,c.session)(),n.groupInviteLink=(0,c.derived)(n._groupInviteLink,["inviteCode"]),a=i,o(n,a)}return a(t,e),s(t,[{key:"_groupInviteLink",value:function(){return this.inviteCode?""+p.default.GROUP_INVITE_LINK_URL+this.inviteCode:null}},{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this.participants.delete()}},{key:"canSetSubject",value:function(){return!!this.participants.iAmMember()&&(!!this.participants.iAmAdmin()||(!b.default.supportsFeature(b.default.F.GROUPS_V_3)||!0!==this.restrict))}},{key:"canSetDescription",value:function(){return!!b.default.supportsFeature(b.default.F.GROUPS_V_3)&&!(!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict)}},{key:"canSetGroupProperty",value:function(){return!!b.default.supportsFeature(b.default.F.GROUPS_V_3)&&!!this.participants.iAmAdmin()}},{key:"initialize",value:function(){l.default.prototype.initialize.call(this),this.listenTo(this.participants,"change:isAdmin change:isSuperAdmin change:contact.isMyContact sort remove reset",this.isTrusted),this.listenTo(this.participants,"add remove reset",this.triggerParticipantsChange),this.listenTo(this,"change:owner",this.isTrusted),this.isTrusted()}},{key:"triggerParticipantsChange",value:function(){this.trigger("change:participants")}},{key:"isTrusted",value:function(){if(this.stale)return this.trusted;if(!this.owner)return this.trusted=!1;if(M.default.equals(this.owner,d.default.me))return this.trusted=!0;var e=y.default.get(this.owner);if(e&&e.isMyContact)return this.trusted=!0;for(var t=this.participants.toArray(),i=0,n=t.length;i<n;++i){var r=t[i];if(r.isAdmin&&(!M.default.equals(r.id,d.default.me)&&r.contact.isMyContact))return this.trusted=!0}return this.trusted=!1}},{key:"groupInviteCode",value:function(){var e=this;return this.groupInviteCodePromise?this.groupInviteCodePromise:this.groupInviteCodePromise=C.default.groupInviteCode(this.id).then(function(t){return 200===t.status&&(e.inviteCode=t.code),t.status}).finally(function(){e.groupInviteCodePromise=null})}},{key:"revokeGroupInvite",value:function(){var e=this;return this.revokeGroupInvitePromise?this.revokeGroupInvitePromise:this.revokeGroupInvitePromise=C.default.revokeGroupInvite(this.id).then(function(t){return 200===t.status&&(e.inviteCode=t.code),t.status}).catch(function(e){m.default.error("models:groupMetadata:participantCollection:revokeGroupInvite dropped")(e)}).finally(function(){e.revokeGroupInvitePromise=null})}},{key:"revokeGroupV4AddInvite",value:function(e){var t=this;if(this.revokeGroupV4AddInvitePromise)return this.revokeGroupV4AddInvitePromise;var i=this.id.toString(),n=d.default.me.toString();return this.revokeGroupV4AddInvitePromise=C.default.revokeGroupV4Invite(e,i,n).then(function(e){return e.status}).catch(function(e){m.default.error("models:groupMetadata:participantCollection:revokeGroupV4AddInvite failed")(e)}).finally(function(){t.revokeGroupV4AddInvitePromise=null})}},{key:"queryGroupV4PendingInvite",value:function(){var e=this,t=d.default.me.toString(),i=this.id.toString();return C.default.findGroupPendingInvitesFromPhone(t,i).then(function(t){e.collection&&e.collection.add({id:e.id,pendingParticipants:t.participants},{merge:!0})})}}]),t}(l.default);w.Collection="GroupMetadata",w.Proxy="groupMetadata",w.idClass=M.default,t.default=(0,c.defineModel)(w)},gabccaieg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("bjigbaghc"),c=n(u),l=i("bjgdagjjci"),f=n(l),d=i("cgcgbfbffj"),h=n(d),p=i("ccicaaeiaa"),g=n(p),y=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.listenTo(e,"change:disabled",function(t){t.disabled&&e.removeParticipant(t)}),e}return a(t,e),s(t,[{key:"delete",value:function(){var e=this;this.forEach(function(t){return e.removeParticipant(t)})}},{key:"validLocations",value:function(){return this.filter(function(e){return e.valid})}},{key:"removeParticipant",value:function(e){this.remove(e),e.delete()}}]),t}(h.default);y.model=f.default,y.comparator=function(e,t){return e.contact.id.equals(c.default.me)?-1:t.contact.id.equals(c.default.me)?1:(0,g.default)(e.contact,t.contact)},t.default=y},gbbacfeci:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("cajijabhgb"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(c),f=i("dieafdcbjb"),d=n(f),h=i("hjbbdjjdf"),p=i("cgcgbfbffj"),g=n(p),y=i("chajfbfiga"),v=n(y),b=i("jccfhaecf"),_=n(b),m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"onResume",value:function(){var e=this;this.filter(function(e){return e.hasObservers()}).forEach(function(t){e.find(t.id).catch(l.WapDrop,function(){})})}},{key:"_find",value:function(e){var t=this;return v.default.statusFind(e).then(function(i){var n={id:e};if((0,h.isNumber)(i.status))switch(i.status){case 429:n.stale=!0;var r=t.get(e);r&&!(0,h.isString)(r.status)&&(n.status="");break;default:n.status=""}else n.status=i.status;return n}).catch(l.WapDrop,function(){return{id:e,stale:!0,status:""}})}},{key:"handle",value:function(e){var t=s(e,1),i=t[0],n=this.get(i.id);n&&(n.status=i.status,n.stale=!1)}}]),t}(g.default);m.model=d.default,m.idClass=_.default,m.staleCollection=!0,m.resumeOnAvailable=!0,t.default=new m},hgeacfdgi:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CALL_UI_STATES=t.CALL_TYPES=t.OUTPUT_DEVICES=void 0;var n=i("dcaifjegcg"),r=i("hfgahggjd"),o=i("bgdcgdigif"),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.OUTPUT_DEVICES=r.OUTPUT_DEVICES,t.CALL_TYPES=o.CALL_TYPES,t.CALL_UI_STATES=o.CALL_UI_STATES;var s=(0,n.defineModel)(a.default);t.default=new s},iajeehcac:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("dhigahgdjb"),d=n(f),h=i("jccfhaecf"),p=n(h),g=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,c.prop)(),n.isAdmin=(0,c.prop)(),n.isSuperAdmin=(0,c.prop)(),n.contact=(0,c.session)(),n.hasSenderKey=(0,c.session)(!1),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.addChild("contact",d.default.gadd(this.id))}}]),t}(l.default);g.Proxy="participant",g.idClass=p.default,t.default=(0,c.defineModel)(g)},idbcfjbae:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("dcaifjegcg"),l=n(c),f=i("bffjfbgbg"),d=n(f),h=i("biedfadfag"),p=n(h),g=i("daichdjff"),y=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.old=(0,c.session)(!1),n.id=(0,c.prop)(),n.catalogWid=(0,c.prop)(),n.additionalImageCdnUrl=(0,c.prop)(),n.imageCdnUrl=(0,c.prop)(),n.url=(0,c.prop)(),n.name=(0,c.prop)(),n.description=(0,c.prop)(),n.reviewStatus=(0,c.prop)(),n.currency=(0,c.prop)(),n.priceAmount1000=(0,c.prop)(),n.retailerId=(0,c.prop)(),n.productImageCollection=(0,c.session)(),n.imageCount=(0,c.prop)(),n.index=(0,c.prop)(),n.productMsgMediaData=(0,c.session)(),n.fetchedFromServer=(0,c.session)(),n.t=(0,c.prop)(),a=i,o(n,a)}return a(t,e),s(t,[{key:"initialize",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.productImageCollection=new p.default,this.listenTo(this,"change:imageCdnUrl",this.triggerImageUpdate),this.triggerImageUpdate()}},{key:"triggerImageUpdate",value:function(){var e=this;if(this.markProductImagesOld(),this.fetchedFromServer||!this.productMsgMediaData)this.imageCdnUrl.productImageModel=this.productImageCollection.gadd({id:"_0",mediaUrl:this.imageCdnUrl.rawUrl,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0}),this.additionalImageCdnUrl&&this.additionalImageCdnUrl.forEach(function(t,i){t.productImageModel=e.productImageCollection.gadd({id:"_"+(i+1),mediaUrl:t.rawUrl,fetchedFromServer:e.fetchedFromServer,old:!1},{merge:!0})});else{this.imageCdnUrl.productImageModel=this.productImageCollection.gadd({id:"_0",type:"product",mediaData:new d.default({mediaStage:g.STAGE.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0});for(var t=1;t<this.imageCount;t++)this.productImageCollection.gadd({id:"_"+t,type:"product",mediaData:new d.default({mediaStage:g.STAGE.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0})}}},{key:"markOld",value:function(){this.old=!0}},{key:"markProductImagesOld",value:function(){this.productImageCollection.forEach(function(e){return e.markOld()})}}]),t}(l.default);y.Collection="Product",y.Proxy="product",t.default=(0,c.defineModel)(y)},igdjeffe:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FALLBACK=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("bjigbaghc"),l=n(c),f=i("dcaifjegcg"),d=n(f),h=i("edbaidcaf"),p=n(h),g=i("jccfhaecf"),y=n(g),v=i("eadfaddcj"),b=n(v),_=i("bhggeigghg"),m=n(_),O=i("ccaaiecfib"),E=n(O),P=i("gcbhjhjhg"),T=n(P),j=t.FALLBACK={SINGLE:"SINGLE",GROUP:"GROUP"},C=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,f.prop)(),n.tag=(0,f.prop)(),n.raw=(0,f.prop)(),n.eurl=(0,f.prop)(),n.stale=(0,f.session)(!0),n.eurlStale=(0,f.session)(!1),n.pendingPic=(0,f.session)(),n.img=(0,f.derived)(n._img,["tag","raw","stale","eurl","eurlStale"]),n.imgFull=(0,f.derived)(n._imgFull,["tag","raw","stale","eurl","eurlStale"]),n.fallbackType=(0,f.derived)(n._fallbackType,["id"]),a=i,o(n,a)}return a(t,e),u(t,[{key:"_img",value:function(){if(this.raw)return"data:image/jpeg;base64,"+this.raw;if(!this.tag&&this.stale)return null;if(this.tag)return E.default.supportsFeature(E.default.F.MD_BACKEND),this.generateUrl("s")}},{key:"_imgFull",value:function(){if((this.raw||!this.tag)&&this.stale)return null;if(!this.raw&&this.tag)return E.default.supportsFeature(E.default.F.MD_BACKEND),this.generateUrl("l")}},{key:"_fallbackType",value:function(){return y.default.isUser(this.id)?j.SINGLE:(y.default.isGroup(this.id),j.GROUP)}},{key:"markStale",value:function(e){this.stale=!0,e&&e.eurl&&(this.eurlStale=!0)}},{key:"validate",value:function(){(this.stale||this.eurlStale)&&this.update()}},{key:"generateUrl",value:function(e){var t={t:e,u:this.id.toString(),i:this.tag||""};return T.default.alive&&this.eurl&&!this.eurlStale&&(t=s({e:this.eurl},t)),p.default.build(b.default.PP_URL,t)}},{key:"canSet",value:function(){if(y.default.isGroup(this.id)){var e=m.default.Chat.assertGet(this.id);return!(e&&e.groupMetadata&&e.groupMetadata.participants.iAmRestrictedMember())}return!!this.id.equals(l.default.me)}},{key:"canDelete",value:function(){if(y.default.isGroup(this.id)&&this.tag){var e=m.default.Chat.assertGet(this.id);return!(e&&e.groupMetadata&&e.groupMetadata.participants.iAmRestrictedMember())}return!(!this.id.equals(l.default.me)||!this.tag)}}]),t}(d.default);C.Collection="ProfilePicThumb",C.Proxy="profilePicThumb",C.idClass=y.default,t.default=(0,f.defineModel)(C)},igjghefdb:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Chatstate=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},c=i("bjebjijbfc"),l=n(c),f=i("hbhijdici"),d=n(f),h=i("dcaifjegcg"),p=n(h),g=i("dhigahgdjb"),y=n(g),v=i("cgcgbfbffj"),b=n(v),_=i("eadfaddcj"),m=n(_),O=i("jccfhaecf"),E=n(O),P=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,h.prop)(),n.type=(0,h.prop)(),n.t=(0,h.prop)(),n.deny=(0,h.prop)(),n.updateTime=(0,h.session)(),n._expireTimerId=(0,h.session)(),a=i,o(n,a)}return a(t,e),t}(p.default);P.Proxy="chatstate",P.idClass=E.default;var T=(0,h.defineModel)(P),j=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(b.default);j.model=T;var C=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,h.prop)(),n.isOnline=(0,h.session)(!1),n.stale=(0,h.session)(!0),n.hasData=(0,h.session)(!1),n.isSubscribed=(0,h.session)(!1),n.withholdDisplay=(0,h.session)(!0),n.forceDisplay=(0,h.session)(!1),n.chatActive=(0,h.session)(!1),n.withholdDisplayTimer=(0,h.session)(),n.forceDisplayTimer=(0,h.session)(),n.chatstate=(0,h.session)(),n.chatstates=(0,h.collection)(j),n.isGroup=(0,h.derived)(n._isGroup),n.isUser=(0,h.derived)(n._isUser),a=i,o(n,a)}return a(t,e),s(t,[{key:"_isGroup",value:function(){return E.default.isGroup(this.id)}},{key:"_isUser",value:function(){return E.default.isUser(this.id)}},{key:"initialize",value:function(){var e=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this);var i=this.isGroup?{id:"",type:"unavailable"}:{id:this.id};this.addChild("chatstate",new T(i)),this.isGroup?this.listenTo(this.chatstates,"add change",d.default.debounce(function(){var t=void 0,i=!1;e.chatstates.forEach(function(e){"composing"!==e.type&&"recording"!==e.type||t&&!(t.updateTime<e.updateTime)||(t=e),i=i||"unavailable"!==e.type}),e.set({isOnline:i}),e.chatstate.set({id:t?t.id:"",type:t?t.type:"unavailable"})})):this.listenTo(this.chatstate,"change:type",function(){e.isOnline="unavailable"!==e.chatstate.type}),this.listenTo(this,"change:chatActive",this.onChatActiveChange)}},{key:"delete",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this.chatstate.delete(),this.chatstates.forEach(function(e){return e.delete()})}},{key:"handle",value:function(e){var t=!1;void 0===e.type?e.type=this.chatstate.type||"unavailable":"paused"===e.type&&(t=!0,e.type="available"),this.isGroup&&"available"!==e.type&&(e.updateTime=Date.now());var i=void 0;if(this.isGroup){if(!e.participant)return;e.id=e.participant,e.participant=void 0,i=this.chatstates.gadd(e.id)}else i=this.chatstate;t&&"composing"!==i.type&&"recording"!==i.type||i.set(e),i._expireTimerId&&clearTimeout(i._expireTimerId),"composing"===i.type||"recording"===i.type?i._expireTimerId=d.default.delay(this._expireComposing,m.default.PRESENCE_COMPOSING_TIMEOUT,i):i._expireTimerId=void 0;var n=this.forceDisplay||this.isOnline||this.isUser&&!this.chatstate.deny;this.set({hasData:!0,forceDisplay:n})}},{key:"_expireComposing",value:function(e){var t=e.type;"composing"!==t&&"recording"!==t||(e.type="available")}},{key:"reset",value:function(){this.hasData=!1,this.isGroup?this.chatstates.forEach(function(e){e.type="unavailable"}):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})}},{key:"isActive",value:function(){var e=this.chatstate.type;return this.hasData&&("composing"===e||"recording"===e)}},{key:"getFormattedString",value:function(){if(!this.hasData)return null;if(this.isGroup){var e=this.chatstate.id;if(!e)return null;var t=y.default.get(e);if(!t)return null;var i=t.formattedShortName;return"composing"===this.chatstate.type?l10n.t("web_conversation_name_is_composing",{participant:i}):l10n.t("web_conversation_name_is_recording",{participant:i})}if(!this.isUser)return null;var n=this.chatstate;switch(n.type){case"available":return l10n.t("web_conversation_contact_online");case"composing":return l10n.t("web_conversation_is_composing");case"recording":return l10n.t("web_conversation_is_recording");case"unavailable":return n.deny||!n.t?null:l.default.lastSeenStr(n.t)}}},{key:"onChatActiveChange",value:function(){var e=this;this.chatActive?(this.hasData?this.withholdDisplay=!1:this.withholdDisplayTimer=d.default.delay(function(){e.set({withholdDisplay:!1,withholdDisplayTimer:void 0})},1500),this.forceDisplayTimer=d.default.delay(function(){e.set({forceDisplay:!0,forceDisplayTimer:void 0})},2e3)):(this.withholdDisplayTimer&&(clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=void 0),this.forceDisplayTimer&&(clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=void 0))}},{key:"subscribe",value:function(){return this.find()}}]),t}(p.default);C.Collection="Presence",C.Proxy="presence",C.idClass=E.default,t.default=(0,h.defineModel)(C),t.Chatstate=T},ijiafihgg:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i("hbhijdici"),c=n(u),l=i("bdfbccfifg"),f=n(l),d=i("bfgbdiffgd"),h=n(d),p=i("eacidghfgh"),g=n(p),y=function(e){function t(e,i){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i.id));return n._trigger=i.trigger||"all",n._saveToCache=c.default.debounce(n.saveToCache,0),n}return a(t,e),s(t,[{key:"saveToCache",value:function(){g.default.hasSynced&&h.default.getWebRestoreFromCache()&&this.collection.saveToCache()}},{key:"enableCaching",value:function(){this.listenTo(this.collection,this._trigger,this._saveToCache)}},{key:"disableCaching",value:function(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}]),t}(f.default);y.policy=l.CACHE_POLICY_TYPE.IMMEDIATE,t.default=y},jcfjeeiii:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=E.default.findLast(e,function(e){return e.body&&e.mediaData&&(e.type===y.default.MSG_TYPE.IMAGE||e.type===y.default.MSG_TYPE.VIDEO)});return t&&t.mediaData.preview}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=i("dcaifjegcg"),f=i("dhigahgdjb"),d=n(f),h=i("ccehadbeci"),p=n(h),g=i("eadfaddcj"),y=n(g),v=i("bdiiahhjbe"),b=n(v),_=i("chajfbfiga"),m=n(_),O=i("hbhijdici"),E=n(O),P=i("bjebjijbfc"),T=n(P),j=i("djheacfeif"),C=n(j),S=i("jccfhaecf"),M=n(S),w=i("dcjbdhhjge"),k=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.id=(0,l.prop)(),n.t=(0,l.prop)(),n.unreadCount=(0,l.prop)(0),n.totalCount=(0,l.prop)(0),n.score=(0,l.prop)(),n.pic=(0,l.prop)(),n._msgs=(0,l.prop)(function(){return[]}),n.readKeys=(0,l.session)(function(){return{}}),n.contact=(0,l.session)(),n.expireTimer=(0,l.session)(),n.expireTs=(0,l.session)(),n.hasUnread=(0,l.derived)(n._hasUnread,["unreadCount"]),n.readCount=(0,l.derived)(n._readCount,["unreadCount","totalCount"]),n.renderedThumbnail=(0,l.derived)(n._renderedThumbnail,["msgsChanged","pic","totalCount"]),n.lastStatus=(0,l.derived)(n._lastStatus,["msgsChanged","totalCount"]),a=i,o(n,a)}return a(t,e),u(t,[{key:"_hasUnread",value:function(){return this.unreadCount>0}},{key:"_readCount",value:function(){var e=this.totalCount-this.unreadCount;return E.default.isFinite(e)?e:(b.default.error("Bad status v3 read count, "+this.totalCount+", "+this.unreadCount)(),0)}},{key:"_renderedThumbnail",value:function(){return this.msgs.length===this.totalCount?s(this.msgs.getModelsArray()):this.pic?this.pic:s(this.msgs.getModelsArray())}},{key:"_lastStatus",value:function(){return this.msgs.last()}},{key:"initialize",value:function(){var e=this;c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.addChild("contact",d.default.gadd(this.id)),this.listenTo(this.msgs,"add bulk_add",function(){window.setTimeout(function(){e.setupStatusExpiration()})}),this.listenTo(this,"change:lastStatus",function(){e.lastStatus&&(e.t=e.lastStatus.t)})}},{key:"setupStatusExpiration",value:function(){var e=this,t=this.msgs.at(0);if(t&&!("number"==typeof this.expireTs&&this.expireTs<=t.t)){var i=t.t+86400+1;i<T.default.globalUnixTime()?window.setTimeout(function(){e.expireMsg()}):(this.expireTimer=C.default.setGlobalTimeout(this.expireMsg.bind(this),1e3*i,this.expireTimer),this.expireTs=t.t)}}},{key:"expireMsg",value:function(){for(var e=this.msgs;e.length>0;){var t=e.at(0);if(!t)break;if(t.t+86400>T.default.globalUnixTime())break;this.unreadCount>this.totalCount-1&&this.unreadCount--,this.totalCount--,e.remove(t),t.delete()}this.expireTs=void 0,this.expireTimer=void 0,0!==this.totalCount&&this.setupStatusExpiration()}},{key:"delete",value:function(){b.default.log("Status v3 deleted with total count: "+this.totalCount)(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this),this.expireTimer&&C.default.clearTimeout(this.expireTimer),this.expireTs&&(this.expireTs=void 0),this.getCollection().remove(this.id)}},{key:"onEmptyMRM",value:function(){var e=this;if(b.default.log("Status V3 onEmptyMRM with total count: "+this.totalCount+", noEarlierMsgs: "+(this.msgs.msgLoadState.noEarlierMsgs?"true":"false"))(),this.msgs.msgLoadState.noEarlierMsgs&&0===this.totalCount)return void this.delete();this.totalCount>0&&this.loadMore().catch(function(){}).finally(function(){e.msgs.length||e.delete()})}},{key:"loadMore",value:function(e){var t=this;if(this.msgs.msgLoadState.noEarlierMsgs)return Promise.resolve();if(this.msgs.msgLoadState.isLoadingEarlierMsgs)return this.msgs.loadEarlierPromise;var i=e||y.default.PAGE_SIZE;return this.getCollection().loadMore(this.id,i,this.msgs.last()).then(function(e){return Array.isArray(e)&&e.length<i&&(t.msgs.msgLoadState.noEarlierMsgs=!0),e}).catch(function(e){return 404===e&&t.delete(),Promise.reject(e)})}},{key:"handleReadStatus",value:function(e){this.readKeys[e]||(this.readKeys[e]=!0,this.unreadCount>0&&this.unreadCount--)}},{key:"sendReadStatus",value:function(e,t){var i=this;return m.default.sendStatusSeen(e,t).then(function(t){200===t.status&&i.handleReadStatus(e)})}},{key:"sendMute",value:function(e){var t=this;return m.default.sendStatusMute(this.id,e).then(function(i){if(200===i.status){var n={statusMute:e};(0,w.updateLocal)(t.contact.id,n).then(function(){t.contact.set(n)})}})}}]),t}(p.default);k.Collection="StatusV3",k.Proxy="statusV3",k.idClass=M.default,t.default=(0,l.defineModel)(k)},jdigiabic:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RECENT_STICKERS_LIMIT=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i("cgcgbfbffj"),l=n(c),f=i("ccaaiecfib"),d=n(f),h=i("cgfidiajgj"),p=n(h),g=i("chajfbfiga"),y=n(g),v=i("bdiiahhjbe"),b=n(v),_=t.RECENT_STICKERS_LIMIT=32,m=function(e){function t(){var e,i,n,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n._checksum="",n._syncStatus="NONE",a=i,o(n,a)}return a(t,e),u(t,[{key:"_findQuery",value:function(){var e=this;return d.default.supportsFeature(d.default.F.RECENT_STICKERS)?y.default.queryRecentStickers().then(function(t){var i=t.checksum,n=t.stickers;return e.setChecksum(i),n.map(function(e,t){return s({},e,{index:t})})}):Promise.reject(new Error("gk recent sticker sync unsupported"))}},{key:"enqueue",value:function(e){var t=this;if(d.default.supportsFeature(d.default.F.RECENT_STICKERS)){this.forEach(function(e,t){e.index=_+t});var i=new Set(e.map(function(e){return e.id}));e.reduce(function(e,t){return i.has(t.id)?(i.delete(t.id),[t].concat(e)):e},[]).slice(0,_).forEach(function(e,i){var n=t.get(e.id);n?n.index=i:t.add({id:e.id,clientUrl:e.clientUrl,directPath:e.directPath,filehash:e.filehash,uploadhash:e.uploadhash,mediaKey:e.mediaKey,width:e.width,height:e.height,size:e.size,mimetype:e.mimetype,type:e.type,index:i})}),this.sort(),this.remove(this.slice(_))}}},{key:"setChecksum",value:function(e){this._checksum=e}},{key:"sync",value:function(e){e!==this._checksum&&(this.setChecksum(e),this._sync())}},{key:"syncOnce",value:function(){return"SUCCESS"===this._syncStatus||"FAILURE"===this._syncStatus?Promise.resolve():this._sync()}},{key:"_sync",value:function(){var e=this;return"INPROGRESS"===this._syncStatus?Promise.resolve():(this._syncStatus="INPROGRESS",this.findQuery({},{set:!0}).then(function(){e.sort(),e._syncStatus="SUCCESS"}).catch(function(t){b.default.error("collection:recent_sticker:_sync error ")(t),e._syncStatus="FAILURE"}))}},{key:"isSynced",value:function(){return"SUCCESS"===this._syncStatus||"FAILURE"===this._syncStatus}}]),t}(l.default);m.model=p.default,m.comparator=function(e,t){return e.index>t.index?1:-1},t.default=new m},jjbajibff:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){var t={},i=0,n=function(e){t["change:"+e]=i++};return e.props&&Object.keys(e.props).forEach(n),e.session&&Object.keys(e.session).forEach(n),e.derived&&Object.keys(e.derived).forEach(n),t}function o(e,t){for(var i=[0,0,0],n=0;n<t.length;n++){var r=e["change:"+t[n]],o=Math.floor(r/h),a=r%h;i[o]|=1<<a}return i}function a(e,t){var i=p[e];i||(i=p[e]={_TotalEvents_:0}),t!==d&&(i._TotalEvents_+=1),i[t]=1+(0|i[t])}function s(e,t){e[t]=e[e.length-1],e.pop()}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();t.genMirrorMask=r,t.genBitMask=o;var l=i("bdiiahhjbe"),f=function(e){return e&&e.__esModule?e:{default:e}}(l),d="change",h=32,p={};f.default.exportToWindow("GEC",p);var g=function(){function e(t){n(this,e),this.state=t}return c(e,[{key:"destructor",value:function(){this.state.off("all",this.onGatherEvent,this)}},{key:"initListener",value:function(){this.state.on("all",this.onGatherEvent,this),this.masks=[],this.listeners=[],this.changeEvents=[0,0,0]}},{key:"onGatherEvent",value:function(e){if(e===d){var t=this.changeEvents;if(!t[0]&&!t[1]&&!t[2])return;this.onChange(),a(this.state.Collection,e),t[0]=0,t[1]=0,t[2]=0}else{var i=this.state.mirrorMask[e];if(void 0===i)return;var n=i/h|0,r=i%h|0;this.changeEvents[n]|=1<<r,a(this.state.Collection,e)}}},{key:"onChange",value:function(){for(var e=this.state,t=u(this.changeEvents,3),i=t[0],n=t[1],r=t[2],o=this.masks,a=this.listeners,s=0;s<o.length;s++){var c=u(o[s],3);if(i&c[0]|n&c[1]|r&c[2]){var l=u(a[s],2);(0,l[0])(l[1],e)}}}},{key:"addListener",value:function(e,t,i){this.listeners||this.initListener(),this.masks.push(t),this.listeners.push([e,i])}},{key:"removeListener",value:function(e){for(var t=this.listeners,i=0;i<t.length;i++)t[i][0]===e&&(s(this.masks,i),s(t,i))}}]),e}();t.default=g}});